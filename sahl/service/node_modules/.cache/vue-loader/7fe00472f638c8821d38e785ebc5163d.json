{"remainingRequest":"D:\\source\\D-mainedit(noMove)\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\source\\D-mainedit(noMove)\\src\\components\\mainview.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\source\\D-mainedit(noMove)\\src\\components\\mainview.vue","mtime":1625791707696},{"path":"D:\\source\\D-mainedit(noMove)\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\source\\D-mainedit(noMove)\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\source\\D-mainedit(noMove)\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\source\\D-mainedit(noMove)\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgSFdFbGVtZW50IGZyb20gJ0AvY29tcG9uZW50cy9IV0VsZW1lbnQudnVlJw0KaW1wb3J0IE1hY2hpbmUgZnJvbSAnQC9jb21wb25lbnRzL01hY2hpbmUudnVlJw0KaW1wb3J0IE1hY2hpbmVEZXNpZ24gZnJvbSAnQC9jb21wb25lbnRzL01hY2hpbmVEZXNpZ24udnVlJw0KaW1wb3J0IE1vZGVEZWNsYXJhdGlvbkdyb3VwIGZyb20gJ0AvY29tcG9uZW50cy9Nb2RlRGVjbGFyYXRpb25Hcm91cC52dWUnDQppbXBvcnQgeyBFdmVudEJ1cyB9IGZyb20gJy4uL21haW4nDQoNCg0KZXhwb3J0IGRlZmF1bHR7DQogICAgY29tcG9uZW50czp7IEhXRWxlbWVudCwgTWFjaGluZSwgTWFjaGluZURlc2lnbiwgTW9kZURlY2xhcmF0aW9uR3JvdXB9LA0KICAgIGRhdGEgKCkgew0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgZHJhZ2dpbmdJZDogbnVsbCwNCiAgICAgICAgICAgIHByZXZPZmZzZXRYOiAwLA0KICAgICAgICAgICAgcHJldk9mZnNldFk6IDAsDQogICAgICAgICAgICBjZW50ZXJaOiA1MCwNCiAgICAgICAgICAgIGVsZW1lbnRzOiBbDQogICAgICAgICAgICAgICAge2lkOiAxLCB4OiA1MDAsICB5OiAyMCwgIGg6IDc1MCwgejogOCwgIGFjdGl2ZTogZmFsc2UsIGNvbXBvbmVudDogJ01hY2hpbmUnfSwgLy8gbWFjaGluZQ0KICAgICAgICAgICAgICAgIHtpZDogMiwgeDogMTAsICAgeTogMTUwLCBoOiA0NTAsIHo6IDEsICBhY3RpdmU6IGZhbHNlLCBjb21wb25lbnQ6ICdNYWNoaW5lRGVzaWduJ30sIC8vbWFjaGluZSBkZXNpZ24NCiAgICAgICAgICAgICAgICB7aWQ6IDMsIHg6IDEwNTAsIHk6IDI1MCwgaDogMjUwLCB6OiAyLCAgYWN0aXZlOiBmYWxzZSwgY29tcG9uZW50OiAnSFdFbGVtZW50J30sIC8vSFdlbGVtZW50DQogICAgICAgICAgICAgICAge2lkOiA0LCB4OiA5NTAsICB5OiA1MDAsIGg6IDMwMCwgejogMSwgIGFjdGl2ZTogZmFsc2UsIGNvbXBvbmVudDogJ01vZGVEZWNsYXJhdGlvbkdyb3VwJ30sIC8vTW9kZSBkZWNsYXJhdGlvbiBHcm91cA0KICAgICAgICAgICAgXSwNCiAgICAgICAgICAgIGlzTW91c2VEb3duOiBmYWxzZSwNCiAgICAgICAgICAgIGVsOiBudWxsLA0KICAgICAgICAgICAgY3Vyc29yUG9zOiBbMCwgMF0sDQogICAgICAgICAgICBpc01vdXNlRGlhZ3JhbTogZmFsc2UsIC8vIG1vdXNl6rCAIGRpYWdyYW3snITsl5Ag7J6I7Jy866m0IO2ZlOuptOydtCDsm4Dsp4HsnbTrqbQg7JWI65CY64uIIOyEpOyglQ0KICAgICAgICB9DQogICAgfSwNCiAgICBtb3VudGVkICgpIHsNCiAgICAgICAgRXZlbnRCdXMuJG9uKCJjYWxsLWNvbXBvbmVudCIsIChlbGVtZW50KT0+ew0KICAgICAgICAgICAgdGhpcy5wb3NpdGlvbmNoYW5nZShlbGVtZW50KQ0KICAgICAgICB9KQ0KICAgICAgICBFdmVudEJ1cy4kb24oIm9wZW4tbW9kZURlY2xhcmF0aW9uIiwgKGl0ZW0sIGlkKSA9PiB7IC8vbW9kZSBkZWNsYXJhdGlvbiDrtoDrpbzrlYwg7Zmc7ISx7ZmU7LC97ZW07KO866Ck6rOgIOydtOuypO2KuCDrsJvslZjsnYwNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudHNbaWRdLmFjdGl2ZSA9IHRydWUNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudHNbMF0uYWN0aXZlID0gZmFsc2UNCiAgICAgICAgfSkNCiAgICAgICAgRXZlbnRCdXMuJG9uKCJzZWxlY3QtZnVuY3Rpb25Hcm91cHR5cGUiLCAoaXRlbSwgaWQpID0+IHsgLy8gbW9kZSBkZWNsYXJhdGlvbmXsl5DshJwgc2VsZWNldO2WiOydhCDrlYwgbWFjaGluZSDtmZzshLHtmZQg7ZW07KO866Ck6rOgIO2VqA0KICAgICAgICAgICAgdGhpcy5lbGVtZW50c1swXS5hY3RpdmUgPSB0cnVlDQogICAgICAgICAgICB0aGlzLmVsZW1lbnRzW2lkXS5hY3RpdmUgPSBmYWxzZQ0KICAgICAgICAgICAgdGhpcy5vbkRlYWN0aXZhdGVkKGlkKSAvLyB66rCSIOuzgOqyve2VmOugpOqzoCANCiAgICAgICAgfSkNCiAgICB9LA0KICAgIG1ldGhvZHM6IHsNCiAgICAgICAgb25Nb3VzZURvd24gKGV2KSB7DQogICAgICAgICAgICBpZiAodGhpcy5pc01vdXNlRGlhZ3JhbSkgcmV0dXJuDQogICAgICAgICAgICB0aGlzLmN1cnNvclBvcyA9IFtldi5wYWdlWCwgZXYucGFnZVldOw0KICAgICAgICAgICAgdGhpcy5pc01vdXNlRG93biA9IHRydWU7DQogICAgICAgIH0sDQogICAgICAgIG9uTW91c2VVcCAoKSB7DQogICAgICAgICAgICB0aGlzLmlzTW91c2VEb3duID0gZmFsc2U7DQogICAgICAgIH0sDQogICAgICAgIG9uTW91c2VNb3ZlIChldikgew0KICAgICAgICAgICAgaWYoIXRoaXMuaXNNb3VzZURvd24pIHJldHVybg0KDQogICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpOw0KDQogICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IGRlbHRhID0gWw0KICAgICAgICAgICAgICAgIGV2LnBhZ2VYIC0gdGhpcy5jdXJzb3JQb3NbMF0sDQogICAgICAgICAgICAgICAgZXYucGFnZVkgLSB0aGlzLmN1cnNvclBvc1sxXSwNCiAgICAgICAgICAgICAgICBdOw0KDQogICAgICAgICAgICB0aGlzLmN1cnNvclBvcyA9IFtldi5wYWdlWCwgZXYucGFnZVldOw0KDQogICAgICAgICAgICBpZiAoIXRoaXMuJHJlZnMuZWwpIHJldHVybjsNCiAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLmVsLnNjcm9sbEJ5KHsNCiAgICAgICAgICAgICAgICAgICAgbGVmdDogLWRlbHRhWzBdLA0KICAgICAgICAgICAgICAgICAgICB0b3A6IC1kZWx0YVsxXSwNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgIH0sDQogICAgICAgIGRyYWdnaW5nKGlkLCBsZWZ0LCB0b3ApIHsNCiAgICAgICAgICAgIHRoaXMuZHJhZ2dpbmdJZCA9IGlkOw0KDQogICAgICAgICAgICBpZiAoISB0aGlzLnN5bmMpIHJldHVybjsNCg0KICAgICAgICAgICAgY29uc3Qgb2Zmc2V0WCA9IGxlZnQgLSB0aGlzLmRyYWdnaW5nRWxlbWVudC54Ow0KICAgICAgICAgICAgY29uc3Qgb2Zmc2V0WSA9IHRvcCAtIHRoaXMuZHJhZ2dpbmdFbGVtZW50Lnk7DQoNCiAgICAgICAgICAgIGNvbnN0IGRlbHRhWCA9IHRoaXMuZGVsdGFYKG9mZnNldFgpOw0KICAgICAgICAgICAgY29uc3QgZGVsdGFZID0gdGhpcy5kZWx0YVkob2Zmc2V0WSk7DQoNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudHMubWFwKGVsID0+IHsNCiAgICAgICAgICAgICAgICBpZiAoZWwuaWQgIT09IGlkKSB7DQogICAgICAgICAgICAgICAgICAgIGVsLnggKz0gZGVsdGFYOw0KICAgICAgICAgICAgICAgICAgICBlbC55ICs9IGRlbHRhWTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuIGVsOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0sDQogICAgICAgIGRyYWdzdG9wKGlkLCBsZWZ0LCB0b3ApIHsNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudHMubWFwKGVsID0+IHsNCiAgICAgICAgICAgICAgICBpZiAoZWwuaWQgPT09IGlkKSB7DQogICAgICAgICAgICAgICAgICAgIGVsLnggPSBsZWZ0Ow0KICAgICAgICAgICAgICAgICAgICBlbC55ID0gdG9wOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXR1cm4gZWw7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgdGhpcy5kcmFnZ2luZ0lkID0gbnVsbDsNCiAgICAgICAgICAgIHRoaXMucHJldk9mZnNldFggPSAwOw0KICAgICAgICAgICAgdGhpcy5wcmV2T2Zmc2V0WSA9IDA7DQogICAgICAgIH0sDQogICAgICAgIGRlbHRhWChvZmZzZXRYKSB7DQogICAgICAgICAgICBjb25zdCByZXQgPSBvZmZzZXRYIC0gdGhpcy5wcmV2T2Zmc2V0WDsNCg0KICAgICAgICAgICAgdGhpcy5wcmV2T2Zmc2V0WCA9IG9mZnNldFg7DQoNCiAgICAgICAgICAgIHJldHVybiByZXQ7DQogICAgICAgIH0sDQogICAgICAgIGRlbHRhWShvZmZzZXRZKSB7DQogICAgICAgICAgICBjb25zdCByZXQgPSBvZmZzZXRZIC0gdGhpcy5wcmV2T2Zmc2V0WTsNCg0KICAgICAgICAgICAgdGhpcy5wcmV2T2Zmc2V0WSA9IG9mZnNldFk7DQoNCiAgICAgICAgICAgIHJldHVybiByZXQ7DQogICAgICAgIH0sDQogICAgICAgIG9uQWN0aXZhdGVkIChpZCkgew0KICAgICAgICAgICAgaWYgKGlkICE9IDEpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRzW2lkLTFdLnogPSAxMCAvLyBtYWlu7J20IOy0iOq4sOqwkiA4IOyjvOuzgOyalOyGjOuTpOydtCAxIG1haW7rs7Tri6Qg7ISg7YOd65Cc6rKD7J20IOuGkuyVhOyVvCDtlZjrr4DroZwgMTDsnLzroZwg7ISk7KCV7ZWoDQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLmlzTW91c2VEaWFncmFtID0gdHJ1ZQ0KICAgICAgICB9LA0KICAgICAgICBvbkRlYWN0aXZhdGVkIChpZCkgew0KICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudHNbaWQtMV0ueiAhPSAxICYmICBpZCAhPSAxKSB7IC8v7LSI6riw6rCS64Sj7Ja07KSMDQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50c1tpZC0xXS56ID0gMQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5pc01vdXNlRGlhZ3JhbSA9IGZhbHNlDQogICAgICAgIH0sDQogICAgICAgIHBvc2l0aW9uY2hhbmdlIChpdGVtKSB7DQogICAgICAgICAgICB0aGlzLmVsZW1lbnRzW2l0ZW1dLnogPSB0aGlzLmNlbnRlcloNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudHNbaXRlbV0uYWN0aXZlID0gdHJ1ZQ0KICAgICAgICAgICAgdGhpcy5lbGVtZW50c1swXS5hY3RpdmUgPSBmYWxzZQ0KICAgICAgICB9DQogICAgfSwNCiAgICBjb21wdXRlZDogew0KICAgICAgICBkcmFnZ2luZ0VsZW1lbnQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGlmICghIHRoaXMuZHJhZ2dpbmdJZCkgcmV0dXJuOw0KDQogICAgICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50cy5maW5kKGVsID0+IGVsLmlkID09PSB0aGlzLmRyYWdnaW5nSWQpOw0KICAgICAgICB9DQogICAgfSwNCn0NCg=="},{"version":3,"sources":["mainview.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"mainview.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div id=\"main-view\"  ref='el' @mousedown=\"onMouseDown\" @mouseup=\"onMouseUp\" @mousemove=\"onMouseMove\"\r\n        :style=\"{cursor: isMouseDown ? 'grabbing' : 'grab',  }\">\r\n        <v-app>\r\n            <vue-draggable-resizable\r\n                class-name-active=\"my-active-class\"\r\n                class-name=\"basic-form\"\r\n                v-for=\"element in elements\"\r\n                :key=\"element.id\"\r\n                :x=\"element.x\"\r\n                :y=\"element.y\"\r\n                :w=\"400\"\r\n                :h=\"element.h\"\r\n                :resizable=\"false\"\r\n                :z=\"element.z\"\r\n                :active.sync=\"element.active\" \r\n                @activated=\"onActivated(element.id)\" @deactivated=\"onDeactivated(element.id)\"\r\n                @dragging=\"(left, top) => dragging(element.id, left, top)\"\r\n                @dragstop=\"(left, top) => dragstop(element.id, left, top)\" >\r\n                <component  :is=\"element.component\" ></component>\r\n            </vue-draggable-resizable> \r\n        </v-app>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport HWElement from '@/components/HWElement.vue'\r\nimport Machine from '@/components/Machine.vue'\r\nimport MachineDesign from '@/components/MachineDesign.vue'\r\nimport ModeDeclarationGroup from '@/components/ModeDeclarationGroup.vue'\r\nimport { EventBus } from '../main'\r\n\r\n\r\nexport default{\r\n    components:{ HWElement, Machine, MachineDesign, ModeDeclarationGroup},\r\n    data () {\r\n        return {\r\n            draggingId: null,\r\n            prevOffsetX: 0,\r\n            prevOffsetY: 0,\r\n            centerZ: 50,\r\n            elements: [\r\n                {id: 1, x: 500,  y: 20,  h: 750, z: 8,  active: false, component: 'Machine'}, // machine\r\n                {id: 2, x: 10,   y: 150, h: 450, z: 1,  active: false, component: 'MachineDesign'}, //machine design\r\n                {id: 3, x: 1050, y: 250, h: 250, z: 2,  active: false, component: 'HWElement'}, //HWelement\r\n                {id: 4, x: 950,  y: 500, h: 300, z: 1,  active: false, component: 'ModeDeclarationGroup'}, //Mode declaration Group\r\n            ],\r\n            isMouseDown: false,\r\n            el: null,\r\n            cursorPos: [0, 0],\r\n            isMouseDiagram: false, // mouse가 diagram위에 있으면 화면이 움직이면 안되니 설정\r\n        }\r\n    },\r\n    mounted () {\r\n        EventBus.$on(\"call-component\", (element)=>{\r\n            this.positionchange(element)\r\n        })\r\n        EventBus.$on(\"open-modeDeclaration\", (item, id) => { //mode declaration 부를때 활성화창해주려고 이벤트 받았음\r\n            this.elements[id].active = true\r\n            this.elements[0].active = false\r\n        })\r\n        EventBus.$on(\"select-functionGrouptype\", (item, id) => { // mode declaratione에서 selecet했을 때 machine 활성화 해주려고 함\r\n            this.elements[0].active = true\r\n            this.elements[id].active = false\r\n            this.onDeactivated(id) // z값 변경하려고 \r\n        })\r\n    },\r\n    methods: {\r\n        onMouseDown (ev) {\r\n            if (this.isMouseDiagram) return\r\n            this.cursorPos = [ev.pageX, ev.pageY];\r\n            this.isMouseDown = true;\r\n        },\r\n        onMouseUp () {\r\n            this.isMouseDown = false;\r\n        },\r\n        onMouseMove (ev) {\r\n            if(!this.isMouseDown) return\r\n\r\n            ev.preventDefault();\r\n\r\n            requestAnimationFrame(() => {\r\n                const delta = [\r\n                ev.pageX - this.cursorPos[0],\r\n                ev.pageY - this.cursorPos[1],\r\n                ];\r\n\r\n            this.cursorPos = [ev.pageX, ev.pageY];\r\n\r\n            if (!this.$refs.el) return;\r\n                this.$refs.el.scrollBy({\r\n                    left: -delta[0],\r\n                    top: -delta[1],\r\n                });\r\n            });\r\n       },\r\n        dragging(id, left, top) {\r\n            this.draggingId = id;\r\n\r\n            if (! this.sync) return;\r\n\r\n            const offsetX = left - this.draggingElement.x;\r\n            const offsetY = top - this.draggingElement.y;\r\n\r\n            const deltaX = this.deltaX(offsetX);\r\n            const deltaY = this.deltaY(offsetY);\r\n\r\n            this.elements.map(el => {\r\n                if (el.id !== id) {\r\n                    el.x += deltaX;\r\n                    el.y += deltaY;\r\n                }\r\n                return el;\r\n            });\r\n        },\r\n        dragstop(id, left, top) {\r\n            this.elements.map(el => {\r\n                if (el.id === id) {\r\n                    el.x = left;\r\n                    el.y = top;\r\n                }\r\n                return el;\r\n            });\r\n\r\n            this.draggingId = null;\r\n            this.prevOffsetX = 0;\r\n            this.prevOffsetY = 0;\r\n        },\r\n        deltaX(offsetX) {\r\n            const ret = offsetX - this.prevOffsetX;\r\n\r\n            this.prevOffsetX = offsetX;\r\n\r\n            return ret;\r\n        },\r\n        deltaY(offsetY) {\r\n            const ret = offsetY - this.prevOffsetY;\r\n\r\n            this.prevOffsetY = offsetY;\r\n\r\n            return ret;\r\n        },\r\n        onActivated (id) {\r\n            if (id != 1) {\r\n                this.elements[id-1].z = 10 // main이 초기값 8 주변요소들이 1 main보다 선택된것이 높아야 하므로 10으로 설정함\r\n            }\r\n            this.isMouseDiagram = true\r\n        },\r\n        onDeactivated (id) {\r\n            if (this.elements[id-1].z != 1 &&  id != 1) { //초기값넣어줌\r\n                this.elements[id-1].z = 1\r\n            }\r\n            this.isMouseDiagram = false\r\n        },\r\n        positionchange (item) {\r\n            this.elements[item].z = this.centerZ\r\n            this.elements[item].active = true\r\n            this.elements[0].active = false\r\n        }\r\n    },\r\n    computed: {\r\n        draggingElement: function () {\r\n            if (! this.draggingId) return;\r\n\r\n            return this.elements.find(el => el.id === this.draggingId);\r\n        }\r\n    },\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n#main-view {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    height: 830px; /* 이게 커지면 가장 오른쪽 scroll이 생긴다. */\r\n}\r\n\r\n.my-active-class {\r\n    border: 2px solid red;\r\n}\r\n\r\n.basic-form {\r\n    cursor: pointer;\r\n    position: absolute; /* 이게 없으면 component들이  x 좌표에 같이 있질 못함  h만큼 떨어져서 배치됨*/\r\n}\r\n\r\ndiv /* 텍스트를 마우스로 드래그하는 것을 방지하는 CSS */\r\n{\r\n  -ms-user-select: none; \r\n  -moz-user-select: -moz-none;\r\n  -khtml-user-select: none;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n}\r\n\r\n</style>"]}]}