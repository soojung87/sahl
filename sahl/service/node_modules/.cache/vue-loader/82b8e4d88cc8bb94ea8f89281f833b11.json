{"remainingRequest":"D:\\service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\service\\src\\components\\Process.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\service\\src\\components\\Process.vue","mtime":1667970104691},{"path":"D:\\service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\service\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\service\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgY29uc3RhbnQgZnJvbSAiLi4vc3RvcmUvY29uc3RhbnRzLmpzIg0KaW1wb3J0IHsgRXZlbnRCdXMgfSBmcm9tICIuLi9tYWluLmpzIg0KaW1wb3J0IGRpYWxvZ1BhdGhTZXR0aW5nIGZyb20gJy4uL2NvbXBvbmVudHMvZGlhbG9nUGF0aFNldHRpbmcudnVlJw0KDQpleHBvcnQgZGVmYXVsdCB7DQogICAgcHJvcHM6IFsnZWxlbWVudCcsICdpc0RhdGFpbFZpZXcnLCAnbWluaW1hcHRvb2xiYXInLCAnbG9jYXRpb24nXSwNCiAgICBjb21wb25lbnRzOntkaWFsb2dQYXRoU2V0dGluZ30sDQogICAgY29tcHV0ZWQ6IHsNCiAgICAgICAgYWN0aXZlVVVJRCgpIHsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5hY3RpdmVVVUlEDQogICAgICAgIH0sDQogICAgICAgIHNldHRpbmcoKSB7DQogICAgICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuc2V0dGluZw0KICAgICAgICB9LA0KICAgIH0sDQogICAgd2F0Y2g6IHsNCiAgICAgICAgYWN0aXZlVVVJRCh2YWwpIHsNCiAgICAgICAgICAgIHRoaXMuc2V0VG9vbGJhckNvbG9yKHZhbCkNCiAgICAgICAgfSwNCiAgICAgICAgLypkZXRhaWxWaWV3VVVJRCh2YWwpIHsNCiAgICAgICAgICAgIHRoaXMuc2V0VG9vbGJhckNvbG9yRGV0YWlsVmlldyh2YWwpDQogICAgICAgIH0sKi8NCiAgICAgICAgc2V0dGluZyh2YWx1ZSkgew0KICAgICAgICAgICAgdGhpcy56b29tdmFsdWUgPSB2YWx1ZS56b29tTWFpbg0KICAgICAgICAgICAgaWYgKHRoaXMuem9vbXZhbHVlIDwgdGhpcy4kc2V0Wm9vbWluVG9vbHRpcCkgew0KICAgICAgICAgICAgICAgIHRoaXMuaXNUb29sdGlwID0gZmFsc2UNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5pc1Rvb2x0aXAgPSB0aGlzLm1pbmltYXB0b29sYmFyDQogICAgICAgICAgICAgICAgaWYgKHRoaXMuem9vbXZhbHVlICA+IHRoaXMuJHNldFpvb21pbkxpbmVUaXRsZSAmJiB0aGlzLnpvb212YWx1ZSA8IHRoaXMuJHNldFpvb21pbkxpbmVTZXR1cFN0YXJ0KSB7DQogICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdkcmF3TGluZVRpdGxlQmFyJywgdGhpcy5lbGVtZW50LnV1aWQsIGZhbHNlKQ0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy56b29tdmFsdWUgPiB0aGlzLiRzZXRab29taW5MaW5lU2V0dXBTdGFydCAmJiB0aGlzLnpvb212YWx1ZSA8IHRoaXMuJHNldFpvb21pbkxpbmVTZXR1cEVuZCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnZHJhd0xpbmVUaXRsZUJhcicsIHRoaXMuZWxlbWVudC51dWlkLCB0aGlzLmlzZWxlbWVudE9wZW5DbG9zZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuaXNlbGVtZW50T3BlbkNsb3NlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5lbGVtZW50LmRlcGVuZGVudC5sZW5ndGggPiAwICYmIHRoaXMubG9jYXRpb24gPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0RlcGVuZGVudFN0YXJ0dXBPcGVuQ2xvc2UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdjaGFuZ2VMaW5lLXNvbWVpcFNlcnZpY2UnLCAnJywgdGhpcy5lbGVtZW50LnV1aWQsIHRoaXMuZGVwZW5kZW50U3RhcnR1cFRhYiwgdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ2NoYW5nZUxpbmUtc29tZWlwU2VydmljZScsICcnLCB0aGlzLmVsZW1lbnQudXVpZCwgbnVsbCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgfSwNCiAgICBjcmVhdGVkKCkgew0KICAgICAgICB0aGlzLnNldFRvb2xiYXJDb2xvcih0aGlzLiRzdG9yZS5zdGF0ZS5hY3RpdmVVVUlEKQ0KICAgIH0sDQoNCiAgICBkYXRhKCkgew0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgcnVsZXM6IHsNCiAgICAgICAgICAgICAgICBuYW1lOiAgW3ZhbCA9PiAodmFsIHx8ICcnKS5sZW5ndGggPiAwIF0sDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgZGlhbG9nUGF0aCA6IGZhbHNlLA0KICAgICAgICAgICAgY29sb3JUb29sYmFyOiAiIzZBNUFDRCIsDQogICAgICAgICAgICB6b29tdmFsdWU6IHRoaXMuJHN0b3JlLnN0YXRlLnNldHRpbmcuem9vbU1haW4sDQogICAgICAgICAgICBpc1Rvb2x0aXA6IHRoaXMubWluaW1hcHRvb2xiYXIsDQogICAgICAgICAgICBpc2VsZW1lbnRPcGVuQ2xvc2U6IHRydWUsLy90aGlzLm1pbmltYXB0b29sYmFyLCAvL3Rvb2xiYXLrp4wg67O07Jes7KSE6rKD7J2064OQIOyVhOuLiOuDkCDshKTsoJUgdHJ1ZTog7KCE7LK0IOuLpCDrs7Tsl6zspIwgLyBmYWxzZSA6IHRvb2xiYXLrp4wg67O07Jes7KSMDQogICAgICAgICAgICBkaWFsb2dUZXh0OiBmYWxzZSwNCiAgICAgICAgICAgIGVkaXRBUlhNTDoge25hbWU6JycsIGxvZ0xldmVsOiBudWxsLCBsb2dQYXRoOiAnJywgbG9nUHJvRGVzYzogJycsIGxvZ1Byb0lEOiAnJywgcmVzdGFydDogJycsIHByZU1hcHBpbmc6IG51bGwsIGxvZ01vZGU6IFtdLA0KICAgICAgICAgICAgICAgICAgICBwcm9kZXNpZ246IG51bGwsIGRldGVybWluOiBudWxsLCBleGVjdXQ6IG51bGwsIG1hY2hpbm5hbWU6ICcnLCBtYWNoaW5ldHlwZTogbnVsbCwgZGVwZW5kZW50OiBbXX0sDQogICAgICAgICAgICBlZGl0VGV4dERlcGVuZGVudDoge2V4ZWN1dGlvbjogW10sIGZ1bmN0aW9uSXRlbTogW10sIHJlc291cmNlUmVmOiBudWxsLCBzdGFydHVwQ29uZmlnUmVmOiBudWxsLCBpZDogJyd9LA0KICAgICAgICAgICAgZWRpdFRleHRFeGVjdXRpb246IHtjb250ZXh0TW9kZTogbnVsbCwgdGFyZ2V0TW9kZTogbnVsbCwgaWQ6ICcnfSwNCiAgICAgICAgICAgIGVkaXRUZXh0RnVuY3Rpb246IHtjb250ZXh0TW9kZTogbnVsbCwgdGFyZ2V0TW9kZTogbnVsbCwgaWQ6ICcnfSwNCiAgICAgICAgICAgIGlzU3RhdGVNYWNoaW5lT3BlbkNsb3NlOiB0cnVlLA0KICAgICAgICAgICAgaXNEZXBlbmRlbnRTdGFydHVwT3BlbkNsb3NlOiB0cnVlLA0KICAgICAgICAgICAgaXNGdW5jdGlvbkdPcGVuQ2xvc2UgOiB0cnVlLA0KICAgICAgICAgICAgaXNFeGVjdXRpb25ET3BlbkNsb3NlIDogdHJ1ZSwNCiAgICAgICAgICAgIHNlbFByb2Nlc3NEZXNpZ246IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0UHJvY2Vzc0Rlc2lnbiwNCiAgICAgICAgICAgIHNlbERldGVybWluaXN0aWM6IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0RGV0ZXJtaW5pc3RpY0NsaWVudCwNCiAgICAgICAgICAgIHNlbEV4ZWN1dGFibGU6IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0RXhlY3V0YWJsZSwNCiAgICAgICAgICAgIHNlbE1vZGVEZWNsYXJhdGlvbjogdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRNb2RlRGVjbGFyYXRpb25HLA0KICAgICAgICAgICAgc2VsUmVzb3VyY2VHOiB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldFJlc291cmNlR3JvdXAsDQogICAgICAgICAgICBzZWxTdGFydHVwQzogdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRTdGFydHVwQ29uZmlnLA0KICAgICAgICAgICAgZGVwZW5kZW50U3RhcnR1cFRhYjogMCwNCg0KICAgICAgICAgICAgbG9nTGV2ZWw6IFsnRkFUQUwnLCAnRVJST1InLCAnV0FSTicsICdJTkZPJywgJ0RFQlVHJywgJ1ZFUkJPU0UnXSwNCiAgICAgICAgICAgIGxvZ01vZGU6IFsgJ0NPTlNPTEUnLCAnRklMRScsICdORVRXT1JLJ10sDQogICAgICAgICAgICBpc2RlbGV0ZUZ1bmN0aW9uRzogZmFsc2UsDQogICAgICAgICAgICBzZWxlY3REZWxlY3RGdW5jdGlvbkdJdGVtOiBbXSwNCiAgICAgICAgICAgIGhlYWRlckZ1bmN0aW9uRzogWw0KICAgICAgICAgICAgICAgIHsgdGV4dDogJycsIHNvcnRhYmxlOiBmYWxzZSwgdmFsdWU6ICdyZWZWaWV3Jywgd2lkdGg6ICc1cHgnIH0sDQogICAgICAgICAgICAgICAgeyB0ZXh0OiAnQ29udGV4dCBNb2RlIFJlZicsIGFsaWduOiAnc3RhcnQnLCBzb3J0YWJsZTogZmFsc2UsIHZhbHVlOiAnY29udGV4dE1vZGUnIH0sDQogICAgICAgICAgICAgICAgeyB0ZXh0OiAnVGFyZ2V0IE1vZGUgUmVmJywgc29ydGFibGU6IGZhbHNlLCB2YWx1ZTogJ3RhcmdldE1vZGUnIH0sDQogICAgICAgICAgICBdLA0KICAgICAgICAgICAgaXNFZGl0aW5nQ29udGV4dE1vZGU6IHRydWUsDQogICAgICAgICAgICBpc0VkaXRpbmdUYXJnZXRNb2RlOiB0cnVlLA0KICAgICAgICAgICAgZGVmYXVsdEl0ZW06IHsgY29udGV4dE1vZGU6IG51bGwsIHRhcmdldE1vZGU6IG51bGwsIGlkOiAnJyB9LA0KICAgICAgICAgICAgZWRpdEZ1bmN0aW9uR0l0ZW06IHsgY29udGV4dE1vZGU6IG51bGwsIHRhcmdldE1vZGU6IG51bGwsIGlkOiAnJyB9LA0KICAgICAgICAgICAgc2VsQ29udGV4dE1vZGU6IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0TWFjaGluZUZHLA0KICAgICAgICAgICAgc2VsVGFyZ2V0TW9kZTogdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRNb2RlRGVjbGFyYXRpb24sDQoNCiAgICAgICAgICAgIGlzZGVsZXRlRXhlY3V0aW9uRDogZmFsc2UsDQogICAgICAgICAgICBzZWxlY3REZWxlY3RFeGVjdXRpb25ESXRlbTogW10sDQogICAgICAgICAgICBpc0VkaXRpbmdDTTogdHJ1ZSwNCiAgICAgICAgICAgIGlzRWRpdGluZ1RNOiB0cnVlLA0KICAgICAgICAgICAgZWRpdEV4ZWN1dGlvbkRJdGVtOiB7IGNvbnRleHRNb2RlOiBudWxsLCB0YXJnZXRNb2RlOiBudWxsLCBpZDogJycgfSwNCg0KICAgICAgICAgICAgcmVmRGVzaWduOiBmYWxzZSwNCiAgICAgICAgICAgIHJlZkRldGVybWluaXN0cmljOiBmYWxzZSwNCiAgICAgICAgICAgIHJlZkV4ZWN1dGFibGU6IGZhbHNlLA0KICAgICAgICAgICAgcmVmVHlwZTogZmFsc2UsDQogICAgICAgICAgICByZWZFeGVjdXRpb246ICcnLA0KICAgICAgICAgICAgcmVmRnVuY3Rpb246ICcnLA0KICAgICAgICAgICAgcmVmUmVzb3VyY2U6IGZhbHNlLA0KICAgICAgICAgICAgcmVmU3RhcnR1cEM6IGZhbHNlLA0KDQogICAgICAgIH0NCiAgICB9LA0KICAgIG1vdW50ZWQgKCkgew0KICAgICAgICBpZiAodGhpcy5taW5pbWFwdG9vbGJhciAmJiB0aGlzLnpvb212YWx1ZSA8IHRoaXMuJHNldFpvb21pbkVsZW1lbnQpIHsNCiAgICAgICAgICAgIHRoaXMuaXNUb29sdGlwID0gZmFsc2UNCiAgICAgICAgfQ0KICAgICAgICBFdmVudEJ1cy4kb24odGhpcy5lbGVtZW50LnV1aWQsIChyZWZOdW0sIGlkeElELCB0YWJJRCwgaWQsIGlzRGVsZXRlSXRlbSwgaXRlbSwgaWR4Um93KSA9PiB7DQogICAgICAgICAgICBjb25zb2xlLmxvZygnIyMgJytpZCsnIC8gJytpc0RlbGV0ZUl0ZW0rICcgLyAnICsgaXRlbSsgJyAvICcrdGFiSUQpDQogICAgICAgICAgICBpZiAoaXNEZWxldGVJdGVtKSB7DQogICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzb3VyY2VSZWYgJiYgdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkID09IHRhYklEICYmIGl0ZW0gPT0gJ3Jlc291cmNlJykgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmNsaWNrT3RoZXJGaWVsZHMoKQ0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5yZWZTdGFydHVwQyAmJiB0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQgPT0gdGFiSUQgJiYgaXRlbSA9PSAnc3RhcnR1cCcpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGlja090aGVyRmllbGRzKCkNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucmVmRXhlY3V0aW9uID09IGlkICYmIGl0ZW0gPT0gJ0V4ZWN1dGlvbicgJiYgdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkID09IHRhYklEKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVmRXhlY3V0aW9uID0gaWQgKyAxDQogICAgICAgICAgICAgICAgICAgIHRoaXMucm93RXhlY3V0aW9uQ2xpY2soaWR4Um93KQ0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5yZWZGdW5jdGlvbiA9PSBpZCAmJiBpdGVtID09ICdGdW5jdGlvbicgJiYgdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkID09IHRhYklEKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVmRnVuY3Rpb24gPSBpZCArIDENCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yb3dGdW5jdGlvbkNsaWNrKGlkeFJvdykNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMucmVmRGVzaWduID0gZmFsc2UNCiAgICAgICAgICAgICAgICB0aGlzLnJlZkRldGVybWluaXN0cmljID0gZmFsc2UNCiAgICAgICAgICAgICAgICB0aGlzLnJlZkV4ZWN1dGFibGUgPSBmYWxzZQ0KICAgICAgICAgICAgICAgIHRoaXMucmVmVHlwZSA9IGZhbHNlDQogICAgICAgICAgICAgICAgdGhpcy5yZWZSZXNvdXJjZSA9IGZhbHNlDQogICAgICAgICAgICAgICAgdGhpcy5yZWZTdGFydHVwQyA9IGZhbHNlDQogICAgICAgICAgICAgICAgdGhpcy5yZWZFeGVjdXRpb24gPSBudWxsDQogICAgICAgICAgICAgICAgdGhpcy5yZWZGdW5jdGlvbiA9IG51bGwNCg0KICAgICAgICAgICAgICAgIGlmIChyZWZOdW0gPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZkRlc2lnbiA9IHRydWUNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlZk51bSA9PSAyKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVmRGV0ZXJtaW5pc3RyaWMgPSB0cnVlDQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZWZOdW0gPT0gMykgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZkV4ZWN1dGFibGUgPSB0cnVlDQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZWZOdW0gPT0gNCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZlR5cGUgPSB0cnVlDQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZWZOdW0gPT0gNSkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWIgPSB0YWJJRA0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZkV4ZWN1dGlvbiA9IGlkeElEDQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZWZOdW0gPT0gNikgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWIgPSB0YWJJRA0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZkZ1bmN0aW9uID0gaWR4SUQNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlZk51bSA9PSA3KSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZGVwZW5kZW50U3RhcnR1cFRhYiA9IHRhYklEDQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVmUmVzb3VyY2UgPSBpZHhJRA0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVmTnVtID09IDgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiID0gdGFiSUQNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZTdGFydHVwQyA9IGlkeElEDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgIH0sDQogICAgbWV0aG9kczogew0KICAgICAgICBzdWJtaXREaWFsb2coZWxlbWVudCkgew0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LnBhdGggPSBlbGVtZW50DQogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2NoYW5nZVBhdGhFbGVtZW50Jywge3V1aWQ6dGhpcy5lbGVtZW50LnV1aWQsIHBhdGg6IHRoaXMuZWxlbWVudC5wYXRoLCBuYW1lOiB0aGlzLmVsZW1lbnQubmFtZX0gKQ0KICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdpc2ludG9FcnJvckxpc3QnLCB7dXVpZDp0aGlzLmVsZW1lbnQudXVpZCwgbmFtZTp0aGlzLmVsZW1lbnQubmFtZSwgcGF0aDp0aGlzLmVsZW1lbnQucGF0aH0pDQogICAgICAgIH0sDQogICAgICAgIHNldFRvb2xiYXJDb2xvcihhY3RpdmVpZCkgDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmKHRoaXMuZWxlbWVudC51dWlkID09IGFjdGl2ZWlkKSB7DQogICAgICAgICAgICAgICAgdGhpcy5jb2xvclRvb2xiYXIgPSAiI0ZGMTQ5MyIgDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMuY29sb3JUb29sYmFyID0gIiM2QTVBQ0QiDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIHNldFRvb2xiYXJDb2xvckRldGFpbFZpZXcoaXNkZXRhaWwpIHsNCiAgICAgICAgICAgIGlmKHRoaXMuZWxlbWVudC51dWlkID09IGlzZGV0YWlsKSB7DQogICAgICAgICAgICAgICAgdGhpcy5jb2xvclRvb2xiYXIgPSAiI0IwRTBFNiIgDQogICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZWxlbWVudC51dWlkID09IHRoaXMuJHN0b3JlLnN0YXRlLmFjdGl2ZVVVSUQpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmNvbG9yVG9vbGJhciAgPSAiI0ZGMTQ5MyINCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgdGhpcy5jb2xvclRvb2xiYXIgPSAiIzZBNUFDRCINCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgc2hvd1Byb2Nlc3MoKSB7DQogICAgICAgICAgICB0aGlzLmNsaWNrT3RoZXJGaWVsZHMoKQ0KICAgICAgICAgICAgdGhpcy5pc2VsZW1lbnRPcGVuQ2xvc2UgPSB0aGlzLmlzZWxlbWVudE9wZW5DbG9zZSA/IGZhbHNlIDogdHJ1ZQ0KICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdkcmF3TGluZScpDQogICAgICAgICAgICB9KQ0KICAgICAgICB9LA0KICAgICAgICBzaG93U3RhdGVNYWNoaW5lKCkgew0KICAgICAgICAgICAgdGhpcy5jbGlja090aGVyRmllbGRzKCkNCiAgICAgICAgICAgIHRoaXMuaXNTdGF0ZU1hY2hpbmVPcGVuQ2xvc2UgPSB0aGlzLmlzU3RhdGVNYWNoaW5lT3BlbkNsb3NlID8gZmFsc2UgOiB0cnVlDQogICAgICAgICAgICAvLyDshKDsnYQg64uk7IucIOq3uOugpOykmOyVvCDtlZjquLAg65WM66y47JeQDQogICAgICAgICAgICAvL0V2ZW50QnVzLiRlbWl0KCdkcmF3TGluZScpDQogICAgICAgIH0sDQogICAgICAgIHNob3dEZXBlbmRlbnRTdGFydHVwKCkgew0KICAgICAgICAgICAgdGhpcy5jbGlja090aGVyRmllbGRzKCkNCiAgICAgICAgICAgIHRoaXMuaXNEZXBlbmRlbnRTdGFydHVwT3BlbkNsb3NlID0gdGhpcy5pc0RlcGVuZGVudFN0YXJ0dXBPcGVuQ2xvc2UgPyBmYWxzZSA6IHRydWUNCiAgICAgICAgICAgLyogaWYodGhpcy5lbGVtZW50LmRlcGVuZGVudC5sZW5ndGggPiAwICYmIHRoaXMubG9jYXRpb24gPT0gMSkgew0KICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5pc0RlcGVuZGVudFN0YXJ0dXBPcGVuQ2xvc2UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdjaGFuZ2VMaW5lLXNvbWVpcFNlcnZpY2UnLCAnJywgdGhpcy5lbGVtZW50LnV1aWQsIHRoaXMuZGVwZW5kZW50U3RhcnR1cFRhYiwgdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ2NoYW5nZUxpbmUtc29tZWlwU2VydmljZScsICcnLCB0aGlzLmVsZW1lbnQudXVpZCwgbnVsbCkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnZHJhd0xpbmUnKQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9Ki8NCiAgICAgICAgfSwNCiAgICAgICAgc2hvd0Z1bmN0aW9uRygpIHsNCiAgICAgICAgICAgIHRoaXMuY2xpY2tPdGhlckZpZWxkcygpDQogICAgICAgICAgICB0aGlzLmlzRnVuY3Rpb25HT3BlbkNsb3NlID0gdGhpcy5pc0Z1bmN0aW9uR09wZW5DbG9zZSA/IGZhbHNlIDogdHJ1ZQ0KICAgICAgICAgICAgLy8g7ISg7J2EIOuLpOyLnCDqt7jroKTspJjslbwg7ZWY6riwIOuVjOusuOyXkA0KICAgICAgICAgICAgLy9FdmVudEJ1cy4kZW1pdCgnZHJhd0xpbmUnKQ0KICAgICAgICB9LA0KICAgICAgICBzaG93RXhlY3V0aW9uRCgpIHsNCiAgICAgICAgICAgIHRoaXMuY2xpY2tPdGhlckZpZWxkcygpDQogICAgICAgICAgICB0aGlzLmlzRXhlY3V0aW9uRE9wZW5DbG9zZSA9IHRoaXMuaXNFeGVjdXRpb25ET3BlbkNsb3NlID8gZmFsc2UgOiB0cnVlDQogICAgICAgICAgICAvLyDshKDsnYQg64uk7IucIOq3uOugpOykmOyVvCDtlZjquLAg65WM66y47JeQDQogICAgICAgICAgICAvL0V2ZW50QnVzLiRlbWl0KCdkcmF3TGluZScpDQogICAgICAgIH0sDQogICAgICAgIGlucHV0UHJvY2Vzc05hbWUoKSB7DQogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXRQcm9jZXNzJywge2NvbXBvOiJOYW1lIiwgdXVpZDp0aGlzLmVsZW1lbnQudXVpZCwgbmFtZTp0aGlzLmVsZW1lbnQubmFtZX0gKQ0KICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdjaGFuZ2VQYXRoRWxlbWVudCcsIHt1dWlkOnRoaXMuZWxlbWVudC51dWlkLCBwYXRoOiB0aGlzLmVsZW1lbnQucGF0aCwgbmFtZTogdGhpcy5lbGVtZW50Lm5hbWV9ICkNCiAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQubmFtZSAhPSAnJykgew0KICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnaXNpbnRvRXJyb3JMaXN0Jywge3V1aWQ6dGhpcy5lbGVtZW50LnV1aWQsIG5hbWU6dGhpcy5lbGVtZW50Lm5hbWUsIHBhdGg6dGhpcy5lbGVtZW50LnBhdGh9KQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBjbGlja090aGVyRmllbGRzKCkgew0KICAgICAgICAgICAgaWYgKHRoaXMucmVmRGVzaWduIHx8IHRoaXMucmVmRGV0ZXJtaW5pc3RyaWMgfHx0aGlzLnJlZkV4ZWN1dGFibGUgfHx0aGlzLnJlZlR5cGUgfHwNCiAgICAgICAgICAgICAgICB0aGlzLnJlZlJlc291cmNlIHx8dGhpcy5yZWZTdGFydHVwQyB8fCB0aGlzLnJlZkV4ZWN1dGlvbiAhPSBudWxsIHx8IHRoaXMucmVmRnVuY3Rpb24gIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlT3BlbkVsZW1lbnQoKQ0KICAgICAgICAgICAgICAgIHRoaXMucmVmRGVzaWduID0gZmFsc2UNCiAgICAgICAgICAgICAgICB0aGlzLnJlZkRldGVybWluaXN0cmljID0gZmFsc2UNCiAgICAgICAgICAgICAgICB0aGlzLnJlZkV4ZWN1dGFibGUgPSBmYWxzZQ0KICAgICAgICAgICAgICAgIHRoaXMucmVmVHlwZSA9IGZhbHNlDQogICAgICAgICAgICAgICAgdGhpcy5yZWZSZXNvdXJjZSA9IGZhbHNlDQogICAgICAgICAgICAgICAgdGhpcy5yZWZTdGFydHVwQyA9IGZhbHNlDQogICAgICAgICAgICAgICAgdGhpcy5yZWZFeGVjdXRpb24gPSBudWxsDQogICAgICAgICAgICAgICAgdGhpcy5yZWZGdW5jdGlvbiA9IG51bGwNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgcm93RXhlY3V0aW9uQ2xpY2soaWR4KSB7DQogICAgICAgICAgICBjb25zb2xlLmxvZygncm93Q2xpY2sgJyArIGlkeCsnIC8gJysgdGhpcy5yZWZFeGVjdXRpb24pDQogICAgICAgICAgICBpZiAodGhpcy5yZWZFeGVjdXRpb24gIT0gdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbltpZHhdLmlkKSB7IC8vIOqwmeydgOqxsCDqs4Tsho0g64iE66W066m0IOyViOuQqA0KICAgICAgICAgICAgICAgIC8v6riw7KG06rKDIGRlbGV0Ze2VmOqzoCANCiAgICAgICAgICAgICAgICB0aGlzLmNsaWNrT3RoZXJGaWVsZHMoKQ0KICAgICAgICAgICAgICAgIC8vIOyDiOuhnOuTpOyWtOyYqCBpZHggbGluZSBkcmF3DQogICAgICAgICAgICAgICAgdmFyIGVuZExpbmVDb250ZXh0ID0gbnVsbCwgZW5kTGluZVRhcmdldCA9IG51bGwNCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uW2lkeF0uY29udGV4dE1vZGUpDQogICAgICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5leGVjdXRpb25baWR4XS50YXJnZXRNb2RlICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgZW5kTGluZVRhcmdldCA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2VkdGFyZ2V0LScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbltpZHhdLmlkKyctJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQpDQogICAgICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lVGFyZ2V0ID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZVRhcmdldCA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0TW9kZURlY2xhcmF0aW9uUGF0aCh0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uW2lkeF0udGFyZ2V0TW9kZSwgMSkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoZW5kTGluZVRhcmdldCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyDquLDsobTsl5Ag7J6I642Y6rGwIOyijO2RnCDrsJTqv5TspJjslbztlaguDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXRNb2RlRGVjbGFyYXRpb25Hcm91cCcsIHtjb21wbzoiZHJhZyIsIHV1aWQ6IGVuZExpbmVUYXJnZXQsIHRvcDogdGhpcy5lbGVtZW50LnRvcCArIDIwMCwgbGVmdDogdGhpcy5lbGVtZW50LmxlZnQgKyB0aGlzLiRzZXRQb3NpdGlvbkxlZnR9ICkNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0ekluZGV4VmlzaWJsZScsIHtwYXJlbnQ6Y29uc3RhbnQuTW9kZURlY2xhcmF0aW9uR3JvdXBfc3RyLCB1dWlkOiBlbmRMaW5lVGFyZ2V0LCBpc1Zpc2libGU6IHRydWUsIGNvbXBvOiAndmlzaWJsZScsIHN0YXJ0VVVJRDogdGhpcy5lbGVtZW50LnV1aWR9ICkNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0Vmlld0xpbmVJbmZvJywge3N0YXJ0OnRoaXMuZWxlbWVudC51dWlkKycvZWR0YWJsZScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCBlbmQ6ZW5kTGluZVRhcmdldCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNjaXJjbGU6ZmFsc2UsIHJlZk51bTo1LCBpZHhJRDogdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbltpZHhdLmlkLCB0YWJJRDogdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFifSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ0VsZW1lbnQtb3BlbicsIGZhbHNlLCBlbmRMaW5lVGFyZ2V0KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCduZXctbGluZScsIHRoaXMuZWxlbWVudC51dWlkKycvZWR0YWJsZScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCBlbmRMaW5lVGFyZ2V0KQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbltpZHhdLmNvbnRleHRNb2RlICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgZW5kTGluZUNvbnRleHQgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9lZGNvbnRleHQtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uW2lkeF0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgICAgICAgICAgaWYgKGVuZExpbmVDb250ZXh0ID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZUNvbnRleHQgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldE1hY2hpbmVQYXRoKHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5leGVjdXRpb25baWR4XS5jb250ZXh0TW9kZSwgMikNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoZW5kTGluZUNvbnRleHQgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8g6riw7KG07JeQIOyeiOuNmOqxsCDsooztkZwg67CU6r+U7KSY7JW87ZWoLg0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRvcCA9IDIwMA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuZExpbmVUYXJnZXQgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcCA9IDYwMA0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdlZGl0TWFjaGluZScsIHtjb21wbzoiZHJhZyIsIHV1aWQ6IGVuZExpbmVDb250ZXh0LCB0b3A6IHRoaXMuZWxlbWVudC50b3AgKyB0b3AsIGxlZnQ6IHRoaXMuZWxlbWVudC5sZWZ0ICsgdGhpcy4kc2V0UG9zaXRpb25MZWZ0fSApDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldHpJbmRleFZpc2libGUnLCB7cGFyZW50OmNvbnN0YW50Lk1hY2hpbmVfc3RyLCB1dWlkOiBlbmRMaW5lQ29udGV4dCwgaXNWaXNpYmxlOiB0cnVlLCBjb21wbzogJ3Zpc2libGUnLCBzdGFydFVVSUQ6IHRoaXMuZWxlbWVudC51dWlkfSApDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFZpZXdMaW5lSW5mbycsIHtzdGFydDp0aGlzLmVsZW1lbnQudXVpZCsnL2VkdGFibGUnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgZW5kOmVuZExpbmVDb250ZXh0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc2NpcmNsZTpmYWxzZSwgcmVmTnVtOjUsIGlkeElEOiB0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uW2lkeF0uaWQsIHRhYklEOiB0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJ9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4geyANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnRWxlbWVudC1vcGVuJywgZmFsc2UsIGVuZExpbmVDb250ZXh0KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCduZXctbGluZScsIHRoaXMuZWxlbWVudC51dWlkKycvZWR0YWJsZScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCBlbmRMaW5lQ29udGV4dCkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7IA0KICAgICAgICAgICAgICAgICAgICBpZiAoZW5kTGluZUNvbnRleHQgIT0gbnVsbCAmJiBlbmRMaW5lVGFyZ2V0ID09IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdFbGVtZW50LW9wZW4nLCB0cnVlLCBlbmRMaW5lQ29udGV4dCkNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbmRMaW5lQ29udGV4dCA9PSBudWxsICYmIGVuZExpbmVUYXJnZXQgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ0VsZW1lbnQtb3BlbicsIHRydWUsIGVuZExpbmVUYXJnZXQpDQogICAgICAgICAgICAgICAgICAgIH0gDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICB0aGlzLnJlZkV4ZWN1dGlvbiA9IHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5leGVjdXRpb25baWR4XS5pZA0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICByb3dGdW5jdGlvbkNsaWNrKGlkeCkgew0KICAgICAgICAgICAgY29uc29sZS5sb2coJ3Jvd0NsaWNrICcgKyBpZHgpDQogICAgICAgICAgICBpZiAodGhpcy5yZWZGdW5jdGlvbiAhPSB0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZnVuY3Rpb25JdGVtW2lkeF0uaWQpIHsgLy8g6rCZ7J2A6rGwIOqzhOyGjSDriITrpbTrqbQg7JWI65CoDQogICAgICAgICAgICAgICAgLy/quLDsobTqsoMgZGVsZXRl7ZWY6rOgIA0KICAgICAgICAgICAgICAgIHRoaXMuY2xpY2tPdGhlckZpZWxkcygpDQogICAgICAgICAgICAgICAgLy8g7IOI66Gc65Ok7Ja07JioIGlkeCBsaW5lIGRyYXcNCiAgICAgICAgICAgICAgICB2YXIgZW5kTGluZUNvbnRleHQgPSBudWxsLCBlbmRMaW5lVGFyZ2V0ID0gbnVsbA0KICAgICAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZnVuY3Rpb25JdGVtW2lkeF0udGFyZ2V0TW9kZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIGVuZExpbmVUYXJnZXQgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ3RhcmdldC0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW1baWR4XS5pZCsnLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgICAgICAgICBpZiAoZW5kTGluZVRhcmdldCA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZExpbmVUYXJnZXQgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldE1vZGVEZWNsYXJhdGlvblBhdGgodGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmZ1bmN0aW9uSXRlbVtpZHhdLnRhcmdldE1vZGUsIDEpDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKGVuZExpbmVUYXJnZXQgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8g6riw7KG07JeQIOyeiOuNmOqxsCDsooztkZwg67CU6r+U7KSY7JW87ZWoLg0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdlZGl0TW9kZURlY2xhcmF0aW9uR3JvdXAnLCB7Y29tcG86ImRyYWciLCB1dWlkOiBlbmRMaW5lVGFyZ2V0LCB0b3A6IHRoaXMuZWxlbWVudC50b3AgKyAyMDAsIGxlZnQ6IHRoaXMuZWxlbWVudC5sZWZ0ICsgdGhpcy4kc2V0UG9zaXRpb25MZWZ0fSApDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldHpJbmRleFZpc2libGUnLCB7cGFyZW50OmNvbnN0YW50Lk1vZGVEZWNsYXJhdGlvbkdyb3VwX3N0ciwgdXVpZDogZW5kTGluZVRhcmdldCwgaXNWaXNpYmxlOiB0cnVlLCBjb21wbzogJ3Zpc2libGUnLCBzdGFydFVVSUQ6IHRoaXMuZWxlbWVudC51dWlkfSApDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFZpZXdMaW5lSW5mbycsIHtzdGFydDp0aGlzLmVsZW1lbnQudXVpZCsnL2ZndGFibGUnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgZW5kOmVuZExpbmVUYXJnZXQsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNjaXJjbGU6ZmFsc2UsIHJlZk51bTo2LCBpZHhJRDogdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmZ1bmN0aW9uSXRlbVtpZHhdLmlkLCB0YWJJRDogdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFifSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ0VsZW1lbnQtb3BlbicsIGZhbHNlLCBlbmRMaW5lVGFyZ2V0KQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ25ldy1saW5lJywgdGhpcy5lbGVtZW50LnV1aWQrJy9mZ3RhYmxlJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsIGVuZExpbmVUYXJnZXQpDQogICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZnVuY3Rpb25JdGVtW2lkeF0uY29udGV4dE1vZGUgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICBlbmRMaW5lQ29udGV4dCA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2ZnY29udGV4dC0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW1baWR4XS5pZCsnLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgICAgICAgICBpZiAoZW5kTGluZUNvbnRleHQgPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lQ29udGV4dCA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0TWFjaGluZVBhdGgodGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmZ1bmN0aW9uSXRlbVtpZHhdLmNvbnRleHRNb2RlLCAyKQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lQ29udGV4dCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyDquLDsobTsl5Ag7J6I642Y6rGwIOyijO2RnCDrsJTqv5TspJjslbztlaguDQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9wID0gMjAwDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW5kTGluZVRhcmdldCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0gNjAwDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXRNYWNoaW5lJywge2NvbXBvOiJkcmFnIiwgdXVpZDogZW5kTGluZUNvbnRleHQsIHRvcDogdGhpcy5lbGVtZW50LnRvcCArIHRvcCwgbGVmdDogdGhpcy5lbGVtZW50LmxlZnQgKyB0aGlzLiRzZXRQb3NpdGlvbkxlZnR9ICkNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0ekluZGV4VmlzaWJsZScsIHtwYXJlbnQ6Y29uc3RhbnQuTWFjaGluZV9zdHIsIHV1aWQ6IGVuZExpbmVDb250ZXh0LCBpc1Zpc2libGU6IHRydWUsIGNvbXBvOiAndmlzaWJsZScsIHN0YXJ0VVVJRDogdGhpcy5lbGVtZW50LnV1aWR9ICkNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0Vmlld0xpbmVJbmZvJywge3N0YXJ0OnRoaXMuZWxlbWVudC51dWlkKycvZmd0YWJsZScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCBlbmQ6ZW5kTGluZUNvbnRleHQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNjaXJjbGU6ZmFsc2UsIHJlZk51bTo2LCBpZHhJRDogdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmZ1bmN0aW9uSXRlbVtpZHhdLmlkLCB0YWJJRDogdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFifSkNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ0VsZW1lbnQtb3BlbicsIGZhbHNlLCBlbmRMaW5lQ29udGV4dCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCduZXctbGluZScsIHRoaXMuZWxlbWVudC51dWlkKycvZmd0YWJsZScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCBlbmRMaW5lQ29udGV4dCkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7IA0KICAgICAgICAgICAgICAgICAgICBpZiAoZW5kTGluZUNvbnRleHQgIT0gbnVsbCAmJiBlbmRMaW5lVGFyZ2V0ID09IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdFbGVtZW50LW9wZW4nLCB0cnVlLCBlbmRMaW5lQ29udGV4dCkNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbmRMaW5lQ29udGV4dCA9PSBudWxsICYmIGVuZExpbmVUYXJnZXQgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ0VsZW1lbnQtb3BlbicsIHRydWUsIGVuZExpbmVUYXJnZXQpDQogICAgICAgICAgICAgICAgICAgIH0gDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICB0aGlzLnJlZkZ1bmN0aW9uID0gdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmZ1bmN0aW9uSXRlbVtpZHhdLmlkDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgY2xlYXJQcm9jZXNzRGVzaWduKCkgew0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LnByb2Rlc2lnbiA9IG51bGwNCiAgICAgICAgICAgIHZhciBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3Byb2Rlc2lnbicpDQogICAgICAgICAgICBpZiAoZW5kTGluZSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzcHJvZGVzaWduJykNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuY2xpY2tPdGhlckZpZWxkcygpDQogICAgICAgIH0sDQogICAgICAgIHNldFByb2Nlc3NEZXNpZ25TZWxlY3QoKSB7DQogICAgICAgICAgICB0aGlzLmNsaWNrT3RoZXJGaWVsZHMoKQ0KICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudC5wcm9kZXNpZ24gIT0gbnVsbCkge3RoaXMucmVmRGVzaWduID0gdHJ1ZX0NCiAgICAgICAgICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldERlbGV0ZU9wZW5FbGVtZW50KHRoaXMuZWxlbWVudC51dWlkKSsxID09IHRoaXMuJHN0b3JlLnN0YXRlLm9wZW5FbGVtZW50Lmxlbmd0aCkgew0KICAgICAgICAgICAgICAgIHZhciBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3Byb2Rlc2lnbicpDQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldFByb2Nlc3NEZXNpZ25QYXRoKHRoaXMuZWxlbWVudC5wcm9kZXNpZ24pDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdlZGl0UHJvY2Vzc0Rlc2lnbicsIHtjb21wbzoiZHJhZyIsIHV1aWQ6IGVuZExpbmUsIHRvcDogdGhpcy5lbGVtZW50LnRvcCwgbGVmdDogdGhpcy5lbGVtZW50LmxlZnQgKyB0aGlzLiRzZXRQb3NpdGlvbkxlZnR9ICkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXR6SW5kZXhWaXNpYmxlJywge3BhcmVudDpjb25zdGFudC5Qcm9jZXNzRGVzaWduX3N0ciwgdXVpZDogZW5kTGluZSwgaXNWaXNpYmxlOiB0cnVlLCBjb21wbzogJ3Zpc2libGUnLCBzdGFydFVVSUQ6IHRoaXMuZWxlbWVudC51dWlkfSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsgDQogICAgICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnbmV3LWxpbmUnLCB0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3Nwcm9kZXNpZ24nLCBlbmRMaW5lKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZW5kTGluZSsxKS5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSkNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRWaWV3TGluZUluZm8nLCB7c3RhcnQ6dGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzcHJvZGVzaWduJywgZW5kOmVuZExpbmUsIGlzY2lyY2xlOmZhbHNlLCByZWZOdW06MX0pDQogICAgICAgICAgICAgICAgICAgIC8vdGhpcy4kc3RvcmUuY29tbWl0KCdzZXREZXRhaWxWaWV3Jywge3V1aWQ6IGVuZExpbmUsIGVsZW1lbnQ6IGNvbnN0YW50LlByb2Nlc3NEZXNpZ25fc3RyfSApDQogICAgICAgICAgICAgICAgICAgIC8vIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVuZExpbmUrdGhpcy5sb2NhdGlvbikuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pDQogICAgICAgICAgICAgICAgICAgIC8vIEV2ZW50QnVzLiRlbWl0KCdhY3RpdmUtZWxlbWVudCcsIGVuZExpbmUpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBzZXRQcm9jZXNzRGVzaWduTGlzdCgpIHsNCiAgICAgICAgICAgIHRoaXMuc2VsUHJvY2Vzc0Rlc2lnbiA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0UHJvY2Vzc0Rlc2lnbg0KICAgICAgICAgICAgdGhpcy5zZXRhY3RpdmVVVUlEKCkNCiAgICAgICAgfSwNCiAgICAgICAgc2V0UHJvY2Vzc0Rlc2lnbihpdGVtKSB7DQogICAgICAgICAgICB0aGlzLmNsaWNrT3RoZXJGaWVsZHMoKQ0KICAgICAgICAgICAgaWYodGhpcy5lbGVtZW50LnByb2Rlc2lnbiAhPSBpdGVtLm5hbWUpIHsNCiAgICAgICAgICAgICAgICB2YXIgZW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3Nwcm9kZXNpZ24nKQ0KICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IHVuZGVmaW5lZCAmJiBlbmRMaW5lICE9IGl0ZW0udXVpZCkgew0KICAgICAgICAgICAgICAgICAgICAvL+q4sOyhtOq6vCDsgq3soJztlbTslbztlZzri6QgdnVleOyXkOyEnOuPhCDsgq3soJztlZjqs6AgbWFpbnZpZXfsl5DshJzrj4Qg7IKt7KCc7ZWY6rOgIA0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzcHJvZGVzaWduJykNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy/sg4jroZwg7LaU6rCA7ZW07KSA64ukDQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gaXRlbS51dWlkKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVmRGVzaWduID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXRQcm9jZXNzRGVzaWduJywge2NvbXBvOiJkcmFnIiwgdXVpZDogaXRlbS51dWlkLCB0b3A6IHRoaXMuZWxlbWVudC50b3AsIGxlZnQ6IHRoaXMuZWxlbWVudC5sZWZ0ICsgdGhpcy4kc2V0UG9zaXRpb25MZWZ0fSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0ekluZGV4VmlzaWJsZScsIHtwYXJlbnQ6Y29uc3RhbnQuUHJvY2Vzc0Rlc2lnbl9zdHIsIHV1aWQ6IGl0ZW0udXVpZCwgaXNWaXNpYmxlOiB0cnVlLCBjb21wbzogJ3Zpc2libGUnLCBzdGFydFVVSUQ6IHRoaXMuZWxlbWVudC51dWlkfSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsgDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5ld0xpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzcHJvZGVzaWduJywgdGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzcHJvZGVzaWduJywgaXRlbS51dWlkLCB0cnVlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaXRlbS51dWlkKzEpLnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFZpZXdMaW5lSW5mbycsIHtzdGFydDp0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3Nwcm9kZXNpZ24nLCBlbmQ6aXRlbS51dWlkLCBpc2NpcmNsZTpmYWxzZSwgcmVmTnVtOjF9KQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQucHJvZGVzaWduID0gaXRlbS5uYW1lDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldERlbGV0ZU9wZW5FbGVtZW50KHRoaXMuZWxlbWVudC51dWlkKSsxID09IHRoaXMuJHN0b3JlLnN0YXRlLm9wZW5FbGVtZW50Lmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZkRlc2lnbiA9IHRydWUNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdlZGl0UHJvY2Vzc0Rlc2lnbicsIHtjb21wbzoiZHJhZyIsIHV1aWQ6IGl0ZW0udXVpZCwgdG9wOiB0aGlzLmVsZW1lbnQudG9wLCBsZWZ0OiB0aGlzLmVsZW1lbnQubGVmdCArIHRoaXMuJHNldFBvc2l0aW9uTGVmdH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldHpJbmRleFZpc2libGUnLCB7cGFyZW50OmNvbnN0YW50LlByb2Nlc3NEZXNpZ25fc3RyLCB1dWlkOiBpdGVtLnV1aWQsIGlzVmlzaWJsZTogdHJ1ZSwgY29tcG86ICd2aXNpYmxlJywgc3RhcnRVVUlEOiB0aGlzLmVsZW1lbnQudXVpZH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7IA0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXdMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3Byb2Rlc2lnbicsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3Byb2Rlc2lnbicsIGl0ZW0udXVpZCwgdHJ1ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGl0ZW0udXVpZCsxKS5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSkNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRWaWV3TGluZUluZm8nLCB7c3RhcnQ6dGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzcHJvZGVzaWduJywgZW5kOml0ZW0udXVpZCwgaXNjaXJjbGU6ZmFsc2UsIHJlZk51bToxfSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLnNldGFjdGl2ZVVVSUQoKQ0KICAgICAgICB9LA0KICAgICAgICBuZXdQcm9jZXNzRGVzaWduKCkgew0KICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdhZGRFbGVtZW50UHJvY2Vzc0Rlc2lnbicsIHsgLy9leGVjdXRhYmxlcmVmIOuKlCBudWxs7ZW07KSY7JW87ZWc64ukLiBjbGVhcmFibGXtlZjrqbQg6rCS7J20IG51bGzrs4DtlZjquLAg65WM66y47JeQIA0KICAgICAgICAgICAgICAgIG5hbWU6IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0TmFtZVByb2Nlc3NEZXNpZ24sIHBhdGg6ICcnLCBpbnB1dDogZmFsc2UsDQogICAgICAgICAgICAgICAgdG9wOiB0aGlzLmVsZW1lbnQudG9wLCBsZWZ0OiB0aGlzLmVsZW1lbnQubGVmdCArIHRoaXMuJHNldFBvc2l0aW9uTGVmdCwgemluZGV4OiAxMCwgaWNvbjoibWRpLWNsaXBib2FyZC1vdXRsaW5lIiwgdmFsaWRhdGlvbjogZmFsc2UsDQogICAgICAgICAgICAgICAgZXhlY3V0YWJsZXJlZjogbnVsbCwgZGV0ZXJtaW46IFtdLA0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdhZGQtZWxlbWVudCcsIGNvbnN0YW50LlByb2Nlc3NEZXNpZ25fc3RyKQ0KICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ2FkZC1lbGVtZW50JywgY29uc3RhbnQuQWRhcHRpdmVBcHBsaWNhdGlvbl9zdHIpDQogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXRQcm9jZXNzJywge2NvbXBvOiJ6IiwgdXVpZDp0aGlzLmVsZW1lbnQudXVpZCwgemluZGV4OjJ9ICkNCiAgICAgICAgfSwNCg0KICAgICAgICBjbGVhckRldGVybWluKCkgew0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LmRldGVybWluID0gbnVsbA0KICAgICAgICAgICAgdmFyIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzZGV0ZXJtaW4nKQ0KICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc2RldGVybWluJykNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuY2xpY2tPdGhlckZpZWxkcygpDQogICAgICAgIH0sDQogICAgICAgIHNldERldGVybWluU2VsZWN0KCkgew0KICAgICAgICAgICAgdGhpcy5jbGlja090aGVyRmllbGRzKCkNCiAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQuZGV0ZXJtaW4gIT0gbnVsbCkge3RoaXMucmVmRGV0ZXJtaW5pc3RyaWMgPSB0cnVlfQ0KICAgICAgICAgICAgaWYgKHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0RGVsZXRlT3BlbkVsZW1lbnQodGhpcy5lbGVtZW50LnV1aWQpKzEgPT0gdGhpcy4kc3RvcmUuc3RhdGUub3BlbkVsZW1lbnQubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgdmFyIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzZGV0ZXJtaW4nKQ0KICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXREZXRlcm1pbmlzdGljQ2xpZW50UGF0aCh0aGlzLmVsZW1lbnQuZGV0ZXJtaW4pDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdlZGl0RGV0ZXJtaW5pc3RpY0NsaWVuJywge2NvbXBvOiJkcmFnIiwgdXVpZDogZW5kTGluZSwgdG9wOiB0aGlzLmVsZW1lbnQudG9wICsgNjAsIGxlZnQ6IHRoaXMuZWxlbWVudC5sZWZ0ICsgdGhpcy4kc2V0UG9zaXRpb25MZWZ0fSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0ekluZGV4VmlzaWJsZScsIHtwYXJlbnQ6Y29uc3RhbnQuRGV0ZXJtaW5pc3RpY0NsaWVudF9zdHIsIHV1aWQ6IGVuZExpbmUsIGlzVmlzaWJsZTogdHJ1ZSwgY29tcG86ICd2aXNpYmxlJywgc3RhcnRVVUlEOiB0aGlzLmVsZW1lbnQudXVpZH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7IA0KICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ25ldy1saW5lJywgdGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzZGV0ZXJtaW4nLCBlbmRMaW5lKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZW5kTGluZSsxKS5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSkNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRWaWV3TGluZUluZm8nLCB7c3RhcnQ6dGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzZGV0ZXJtaW4nLCBlbmQ6ZW5kTGluZSwgaXNjaXJjbGU6ZmFsc2UsIHJlZk51bToyfSkNCiAgICAgICAgICAgICAgICAgICAgLy90aGlzLiRzdG9yZS5jb21taXQoJ3NldERldGFpbFZpZXcnLCB7dXVpZDogZW5kTGluZSwgZWxlbWVudDogY29uc3RhbnQuRGV0ZXJtaW5pc3RpY0NsaWVudF9zdHJ9ICkNCiAgICAgICAgICAgICAgICAgICAgLypkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbmRMaW5lK3RoaXMubG9jYXRpb24pLnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KQ0KICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnYWN0aXZlLWVsZW1lbnQnLCBlbmRMaW5lKSovDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBzZXREZXRlcm1pbkxpc3QoKSB7DQogICAgICAgICAgICB0aGlzLnNlbERldGVybWluaXN0aWMgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldERldGVybWluaXN0aWNDbGllbnQNCiAgICAgICAgICAgIHRoaXMuc2V0YWN0aXZlVVVJRCgpDQogICAgICAgIH0sDQogICAgICAgIHNldERldGVybWluaXN0aWNDbGllbnQoaXRlbSkgew0KICAgICAgICAgICAgdGhpcy5jbGlja090aGVyRmllbGRzKCkNCiAgICAgICAgICAgIGlmKHRoaXMuZWxlbWVudC5kZXRlcm1pbiAhPSBpdGVtLm5hbWUpIHsNCiAgICAgICAgICAgICAgICB2YXIgZW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NkZXRlcm1pbicpDQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gdW5kZWZpbmVkICYmIGVuZExpbmUgIT0gaXRlbS51dWlkKSB7DQogICAgICAgICAgICAgICAgICAgIC8v6riw7KG06rq8IOyCreygnO2VtOyVvO2VnOuLpCB2dWV47JeQ7ISc64+EIOyCreygnO2VmOqzoCBtYWludmlld+yXkOyEnOuPhCDsgq3soJztlZjqs6AgDQogICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NkZXRlcm1pbicpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8v7IOI66GcIOy2lOqwgO2VtOykgOuLpA0KICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IGl0ZW0udXVpZCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZkRldGVybWluaXN0cmljID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXREZXRlcm1pbmlzdGljQ2xpZW4nLCB7Y29tcG86ImRyYWciLCB1dWlkOiBpdGVtLnV1aWQsIHRvcDogdGhpcy5lbGVtZW50LnRvcCArIDYwLCBsZWZ0OiB0aGlzLmVsZW1lbnQubGVmdCArIHRoaXMuJHNldFBvc2l0aW9uTGVmdH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldHpJbmRleFZpc2libGUnLCB7cGFyZW50OmNvbnN0YW50LkRldGVybWluaXN0aWNDbGllbnRfc3RyLCB1dWlkOiBpdGVtLnV1aWQsIGlzVmlzaWJsZTogdHJ1ZSwgY29tcG86ICd2aXNpYmxlJywgc3RhcnRVVUlEOiB0aGlzLmVsZW1lbnQudXVpZH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7IA0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXdMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc2RldGVybWluJywgdGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzZGV0ZXJtaW4nLCBpdGVtLnV1aWQsIHRydWUpDQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpdGVtLnV1aWQrMSkuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0Vmlld0xpbmVJbmZvJywge3N0YXJ0OnRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc2RldGVybWluJywgZW5kOml0ZW0udXVpZCwgaXNjaXJjbGU6ZmFsc2UsIHJlZk51bToyfSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmRldGVybWluID0gaXRlbS5uYW1lDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldERlbGV0ZU9wZW5FbGVtZW50KHRoaXMuZWxlbWVudC51dWlkKSsxID09IHRoaXMuJHN0b3JlLnN0YXRlLm9wZW5FbGVtZW50Lmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZkRldGVybWluaXN0cmljID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXREZXRlcm1pbmlzdGljQ2xpZW4nLCB7Y29tcG86ImRyYWciLCB1dWlkOiBpdGVtLnV1aWQsIHRvcDogdGhpcy5lbGVtZW50LnRvcCArIDYwLCBsZWZ0OiB0aGlzLmVsZW1lbnQubGVmdCArIHRoaXMuJHNldFBvc2l0aW9uTGVmdH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldHpJbmRleFZpc2libGUnLCB7cGFyZW50OmNvbnN0YW50LkRldGVybWluaXN0aWNDbGllbnRfc3RyLCB1dWlkOiBpdGVtLnV1aWQsIGlzVmlzaWJsZTogdHJ1ZSwgY29tcG86ICd2aXNpYmxlJywgc3RhcnRVVUlEOiB0aGlzLmVsZW1lbnQudXVpZH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7IA0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXdMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc2RldGVybWluJywgdGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzZGV0ZXJtaW4nLCBpdGVtLnV1aWQsIHRydWUpDQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpdGVtLnV1aWQrMSkuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0Vmlld0xpbmVJbmZvJywge3N0YXJ0OnRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc2RldGVybWluJywgZW5kOml0ZW0udXVpZCwgaXNjaXJjbGU6ZmFsc2UsIHJlZk51bToyfSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLnNldGFjdGl2ZVVVSUQoKQ0KICAgICAgICB9LA0KICAgICAgICBuZXdEZXRlcm1pbmlzdGljQ2xpZW50KCkgew0KICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdhZGRFbGVtZW50RGV0ZXJtaW5pc3RpY0NsaWVuJywgew0KICAgICAgICAgICAgICAgIG5hbWU6IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0TmFtZURldGVybWluaXN0aWNDbGllbnQsIHBhdGg6ICcnLCBpbnB1dDogZmFsc2UsDQogICAgICAgICAgICAgICAgdG9wOiB0aGlzLmVsZW1lbnQudG9wICsgNjAsIGxlZnQ6IHRoaXMuZWxlbWVudC5sZWZ0ICsgdGhpcy4kc2V0UG9zaXRpb25MZWZ0LCB6aW5kZXg6IDEwLCBpY29uOiJtZGktY2xpcGJvYXJkLW91dGxpbmUiLCB2YWxpZGF0aW9uOiBmYWxzZSwNCiAgICAgICAgICAgICAgICBjeWNsZXRpZW06ICcnLCBudW1vZndvcmtlcnM6ICcnLA0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdhZGQtZWxlbWVudCcsIGNvbnN0YW50LkRldGVybWluaXN0aWNDbGllbnRfc3RyKQ0KICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ2FkZC1lbGVtZW50JywgY29uc3RhbnQuQWRhcHRpdmVBcHBsaWNhdGlvbl9zdHIpDQogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXRQcm9jZXNzJywge2NvbXBvOiJ6IiwgdXVpZDp0aGlzLmVsZW1lbnQudXVpZCwgemluZGV4OjJ9ICkNCiAgICAgICAgfSwNCg0KICAgICAgICBjbGVhckV4ZWN1dGFibGUoKSB7DQogICAgICAgICAgICB0aGlzLmVsZW1lbnQuZXhlY3V0ID0gbnVsbA0KICAgICAgICAgICAgdmFyIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzZXhlY3V0JykNCiAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NleGVjdXQnKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5jbGlja090aGVyRmllbGRzKCkNCiAgICAgICAgfSwNCiAgICAgICAgc2V0RXhlY3V0YWJsZVNlbGVjdCgpIHsNCiAgICAgICAgICAgIHRoaXMuY2xpY2tPdGhlckZpZWxkcygpDQogICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50LmV4ZWN1dCAhPSBudWxsKSB7dGhpcy5yZWZFeGVjdXRhYmxlID0gdHJ1ZX0NCiAgICAgICAgICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldERlbGV0ZU9wZW5FbGVtZW50KHRoaXMuZWxlbWVudC51dWlkKSsxID09IHRoaXMuJHN0b3JlLnN0YXRlLm9wZW5FbGVtZW50Lmxlbmd0aCkgew0KICAgICAgICAgICAgICAgIHZhciBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc2V4ZWN1dCcpDQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldEV4ZWN1dGFibGVQYXRoKHRoaXMuZWxlbWVudC5leGVjdXQpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdlZGl0RXhlY3V0YWJsZScsIHtjb21wbzoiZHJhZyIsIHV1aWQ6IGVuZExpbmUsIHRvcDogdGhpcy5lbGVtZW50LnRvcCwgbGVmdDogdGhpcy5lbGVtZW50LmxlZnQgKyB0aGlzLiRzZXRQb3NpdGlvbkxlZnR9ICkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXR6SW5kZXhWaXNpYmxlJywge3BhcmVudDpjb25zdGFudC5FeGVjdXRhYmxlX3N0ciwgdXVpZDogZW5kTGluZSwgaXNWaXNpYmxlOiB0cnVlLCBjb21wbzogJ3Zpc2libGUnLCBzdGFydFVVSUQ6IHRoaXMuZWxlbWVudC51dWlkfSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsgDQogICAgICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnbmV3LWxpbmUnLCB0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NleGVjdXQnLCBlbmRMaW5lKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZW5kTGluZSsxKS5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSkNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRWaWV3TGluZUluZm8nLCB7c3RhcnQ6dGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzZXhlY3V0JywgZW5kOmVuZExpbmUsIGlzY2lyY2xlOmZhbHNlLCByZWZOdW06M30pDQogICAgICAgICAgICAgICAgICAgIC8vdGhpcy4kc3RvcmUuY29tbWl0KCdzZXREZXRhaWxWaWV3Jywge3V1aWQ6IGVuZExpbmUsIGVsZW1lbnQ6IGNvbnN0YW50LkV4ZWN1dGFibGVfc3RyfSApDQogICAgICAgICAgICAgICAgICAgIC8vIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVuZExpbmUrdGhpcy5sb2NhdGlvbikuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pDQogICAgICAgICAgICAgICAgICAgIC8vIEV2ZW50QnVzLiRlbWl0KCdhY3RpdmUtZWxlbWVudCcsIGVuZExpbmUpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBzZXRFeGVjdXRhYmxlTGlzdCgpIHsNCiAgICAgICAgICAgIHRoaXMuc2VsRXhlY3V0YWJsZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0RXhlY3V0YWJsZQ0KICAgICAgICAgICAgdGhpcy5zZXRhY3RpdmVVVUlEKCkNCiAgICAgICAgfSwNCiAgICAgICAgc2V0RXhlY3V0YWJsZShpdGVtKSB7DQogICAgICAgICAgICB0aGlzLmNsaWNrT3RoZXJGaWVsZHMoKQ0KICAgICAgICAgICAgaWYodGhpcy5lbGVtZW50LmV4ZWN1dCAhPSBpdGVtLm5hbWUpIHsNCiAgICAgICAgICAgICAgICB2YXIgZW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NleGVjdXQnKQ0KICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IHVuZGVmaW5lZCAmJiBlbmRMaW5lICE9IGl0ZW0udXVpZCkgew0KICAgICAgICAgICAgICAgICAgICAvL+q4sOyhtOq6vCDsgq3soJztlbTslbztlZzri6QgdnVleOyXkOyEnOuPhCDsgq3soJztlZjqs6AgbWFpbnZpZXfsl5DshJzrj4Qg7IKt7KCc7ZWY6rOgIA0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzZXhlY3V0JykNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy/sg4jroZwg7LaU6rCA7ZW07KSA64ukDQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gaXRlbS51dWlkKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVmRXhlY3V0YWJsZSA9IHRydWUNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdlZGl0RXhlY3V0YWJsZScsIHtjb21wbzoiZHJhZyIsIHV1aWQ6IGl0ZW0udXVpZCwgdG9wOiB0aGlzLmVsZW1lbnQudG9wLCBsZWZ0OiB0aGlzLmVsZW1lbnQubGVmdCArIHRoaXMuJHNldFBvc2l0aW9uTGVmdH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldHpJbmRleFZpc2libGUnLCB7cGFyZW50OmNvbnN0YW50LkV4ZWN1dGFibGVfc3RyLCB1dWlkOiBpdGVtLnV1aWQsIGlzVmlzaWJsZTogdHJ1ZSwgY29tcG86ICd2aXNpYmxlJywgc3RhcnRVVUlEOiB0aGlzLmVsZW1lbnQudXVpZH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7IA0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXdMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc2V4ZWN1dCcsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc2V4ZWN1dCcsIGl0ZW0udXVpZCwgdHJ1ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGl0ZW0udXVpZCsxKS5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSkNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRWaWV3TGluZUluZm8nLCB7c3RhcnQ6dGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzZXhlY3V0JywgZW5kOml0ZW0udXVpZCwgaXNjaXJjbGU6ZmFsc2UsIHJlZk51bTozfSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmV4ZWN1dCA9IGl0ZW0ubmFtZQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZiAodGhpcy4kc3RvcmUuZ2V0dGVycy5nZXREZWxldGVPcGVuRWxlbWVudCh0aGlzLmVsZW1lbnQudXVpZCkrMSA9PSB0aGlzLiRzdG9yZS5zdGF0ZS5vcGVuRWxlbWVudC5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZFeGVjdXRhYmxlID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXRFeGVjdXRhYmxlJywge2NvbXBvOiJkcmFnIiwgdXVpZDogaXRlbS51dWlkLCB0b3A6IHRoaXMuZWxlbWVudC50b3AsIGxlZnQ6IHRoaXMuZWxlbWVudC5sZWZ0ICsgdGhpcy4kc2V0UG9zaXRpb25MZWZ0fSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0ekluZGV4VmlzaWJsZScsIHtwYXJlbnQ6Y29uc3RhbnQuRXhlY3V0YWJsZV9zdHIsIHV1aWQ6IGl0ZW0udXVpZCwgaXNWaXNpYmxlOiB0cnVlLCBjb21wbzogJ3Zpc2libGUnLCBzdGFydFVVSUQ6IHRoaXMuZWxlbWVudC51dWlkfSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsgDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5ld0xpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzZXhlY3V0JywgdGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzZXhlY3V0JywgaXRlbS51dWlkLCB0cnVlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaXRlbS51dWlkKzEpLnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFZpZXdMaW5lSW5mbycsIHtzdGFydDp0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NleGVjdXQnLCBlbmQ6aXRlbS51dWlkLCBpc2NpcmNsZTpmYWxzZSwgcmVmTnVtOjN9KQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuc2V0YWN0aXZlVVVJRCgpDQogICAgICAgIH0sDQogICAgICAgIG5ld0V4ZWN1dGFibGUoKSB7DQogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2FkZEVsZW1lbnRFeGVjdXRhYmxlJywgeyAvL2FwcGxpY2F0aW9udHlwZXJlZiDripQgbnVsbO2VtOykmOyVvO2VnOuLpC4gY2xlYXJhYmxl7ZWY66m0IOqwkuydtCBudWxs67OA7ZWY6riwIOuVjOusuOyXkCANCiAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldE5hbWVFeGVjdXRhYmxlLCBwYXRoOiAnJywgaW5wdXQ6IGZhbHNlLA0KICAgICAgICAgICAgICAgIHRvcDogdGhpcy5lbGVtZW50LnRvcCwgbGVmdDogdGhpcy5lbGVtZW50LmxlZnQgKyB0aGlzLiRzZXRQb3NpdGlvbkxlZnQsIHppbmRleDogMTAsIGljb246Im1kaS1jbGlwYm9hcmQtb3V0bGluZSIsIHZhbGlkYXRpb246IGZhbHNlLA0KICAgICAgICAgICAgICAgIHZlcnNpb246ICcnLCBjYXRlZ29yeTonJywgYnVpbGRUeXBlOm51bGwsIGxvZ2dpbmdCZWhhYmlvcjpudWxsLCByZXBvcnRpbmdCZWhhYmlvcjpudWxsLCBzd25hbWU6JycsIGFwcGxpY2F0aW9udHlwZXJlZjogbnVsbCwNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnYWRkLWVsZW1lbnQnLCBjb25zdGFudC5FeGVjdXRhYmxlX3N0cikNCiAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdhZGQtZWxlbWVudCcsIGNvbnN0YW50LkFkYXB0aXZlQXBwbGljYXRpb25fc3RyKQ0KICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdlZGl0UHJvY2VzcycsIHtjb21wbzoieiIsIHV1aWQ6dGhpcy5lbGVtZW50LnV1aWQsIHppbmRleDoyfSApDQogICAgICAgIH0sDQoNCiAgICAgICAgY2xlYXJNb2RlRGVjbGFyYXRpb24oKSB7DQogICAgICAgICAgICB0aGlzLmVsZW1lbnQubWFjaGluZXR5cGUgPSBudWxsDQogICAgICAgICAgICB2YXIgZW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3Ntb2RlZGVjbGFyJykNCiAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3Ntb2RlZGVjbGFyJykNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuY2xpY2tPdGhlckZpZWxkcygpDQogICAgICAgIH0sDQogICAgICAgIHNldE1vZGVEZWNsYXJhdGlvblNlbGVjdCgpIHsNCiAgICAgICAgICAgIHRoaXMuY2xpY2tPdGhlckZpZWxkcygpDQogICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50Lm1hY2hpbmV0eXBlICE9IG51bGwpIHt0aGlzLnJlZlR5cGUgPSB0cnVlfQ0KICAgICAgICAgICAgaWYgKHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0RGVsZXRlT3BlbkVsZW1lbnQodGhpcy5lbGVtZW50LnV1aWQpKzEgPT0gdGhpcy4kc3RvcmUuc3RhdGUub3BlbkVsZW1lbnQubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgdmFyIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzbW9kZWRlY2xhcicpDQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldE1vZGVEZWNsYXJhdGlvblBhdGgodGhpcy5lbGVtZW50Lm1hY2hpbmV0eXBlLCAwKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoZW5kTGluZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnZWRpdE1vZGVEZWNsYXJhdGlvbkdyb3VwJywge2NvbXBvOiJkcmFnIiwgdXVpZDogZW5kTGluZSwgdG9wOiB0aGlzLmVsZW1lbnQudG9wICsgNDgwLCBsZWZ0OiB0aGlzLmVsZW1lbnQubGVmdCArIHRoaXMuJHNldFBvc2l0aW9uTGVmdH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldHpJbmRleFZpc2libGUnLCB7cGFyZW50OmNvbnN0YW50Lk1vZGVEZWNsYXJhdGlvbkdyb3VwX3N0ciwgdXVpZDogZW5kTGluZSwgaXNWaXNpYmxlOiB0cnVlLCBjb21wbzogJ3Zpc2libGUnLCBzdGFydFVVSUQ6IHRoaXMuZWxlbWVudC51dWlkfSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsgDQogICAgICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnRWxlbWVudC1vcGVuJywgdHJ1ZSwgZW5kTGluZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCduZXctbGluZScsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc21vZGVkZWNsYXInLCBlbmRMaW5lKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZW5kTGluZSsxKS5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSkNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRWaWV3TGluZUluZm8nLCB7c3RhcnQ6dGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzbW9kZWRlY2xhcicsIGVuZDplbmRMaW5lLCBpc2NpcmNsZTpmYWxzZSwgcmVmTnVtOjR9KQ0KICAgICAgICAgICAgICAgICAgICAvL3RoaXMuJHN0b3JlLmNvbW1pdCgnc2V0RGV0YWlsVmlldycsIHt1dWlkOiBlbmRMaW5lLCBlbGVtZW50OiBjb25zdGFudC5Nb2RlRGVjbGFyYXRpb25Hcm91cF9zdHJ9ICkNCiAgICAgICAgICAgICAgICAgICAgLypkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbmRMaW5lK3RoaXMubG9jYXRpb24pLnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KQ0KICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnYWN0aXZlLWVsZW1lbnQnLCBlbmRMaW5lKSovDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBzZXRNb2RlRGVjbGFyYXRpb25MaXN0KCkgew0KICAgICAgICAgICAgdGhpcy5zZWxNb2RlRGVjbGFyYXRpb24gPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldE1vZGVEZWNsYXJhdGlvbkcNCiAgICAgICAgICAgIHRoaXMuc2V0YWN0aXZlVVVJRCgpDQogICAgICAgIH0sDQogICAgICAgIHNldE1vZGVEZWNsYXJhdGlvbihpdGVtKSB7DQogICAgICAgICAgICB0aGlzLmNsaWNrT3RoZXJGaWVsZHMoKQ0KICAgICAgICAgICAgaWYodGhpcy5lbGVtZW50Lm1hY2hpbmV0eXBlICE9IGl0ZW0ubmFtZSkgew0KICAgICAgICAgICAgICAgIHZhciBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc21vZGVkZWNsYXInKQ0KICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IHVuZGVmaW5lZCAmJiBlbmRMaW5lICE9IGl0ZW0udXVpZCkgew0KICAgICAgICAgICAgICAgICAgICAvL+q4sOyhtOq6vCDsgq3soJztlbTslbztlZzri6QgdnVleOyXkOyEnOuPhCDsgq3soJztlZjqs6AgbWFpbnZpZXfsl5DshJzrj4Qg7IKt7KCc7ZWY6rOgIA0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzbW9kZWRlY2xhcicpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8v7IOI66GcIOy2lOqwgO2VtOykgOuLpA0KICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IGl0ZW0udXVpZCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZlR5cGUgPSB0cnVlDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnZWRpdE1vZGVEZWNsYXJhdGlvbkdyb3VwJywge2NvbXBvOiJkcmFnIiwgdXVpZDogaXRlbS51dWlkLCB0b3A6IHRoaXMuZWxlbWVudC50b3AgKyA0ODAsIGxlZnQ6IHRoaXMuZWxlbWVudC5sZWZ0ICsgdGhpcy4kc2V0UG9zaXRpb25MZWZ0fSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0ekluZGV4VmlzaWJsZScsIHtwYXJlbnQ6Y29uc3RhbnQuTW9kZURlY2xhcmF0aW9uR3JvdXBfc3RyLCB1dWlkOiBpdGVtLnV1aWQsIGlzVmlzaWJsZTogdHJ1ZSwgY29tcG86ICd2aXNpYmxlJywgc3RhcnRVVUlEOiB0aGlzLmVsZW1lbnQudXVpZH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnRWxlbWVudC1vcGVuJywgdHJ1ZSwgaXRlbS51dWlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXdMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc21vZGVkZWNsYXInLCB0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3Ntb2RlZGVjbGFyJywgaXRlbS51dWlkLCB0cnVlKSANCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGl0ZW0udXVpZCsxKS5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSkNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRWaWV3TGluZUluZm8nLCB7c3RhcnQ6dGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzbW9kZWRlY2xhcicsIGVuZDppdGVtLnV1aWQsIGlzY2lyY2xlOmZhbHNlLCByZWZOdW06NH0pDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5tYWNoaW5ldHlwZSA9IGl0ZW0ubmFtZQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZiAodGhpcy4kc3RvcmUuZ2V0dGVycy5nZXREZWxldGVPcGVuRWxlbWVudCh0aGlzLmVsZW1lbnQudXVpZCkrMSA9PSB0aGlzLiRzdG9yZS5zdGF0ZS5vcGVuRWxlbWVudC5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZUeXBlID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXRNb2RlRGVjbGFyYXRpb25Hcm91cCcsIHtjb21wbzoiZHJhZyIsIHV1aWQ6IGl0ZW0udXVpZCwgdG9wOiB0aGlzLmVsZW1lbnQudG9wICsgNDgwLCBsZWZ0OiB0aGlzLmVsZW1lbnQubGVmdCArIHRoaXMuJHNldFBvc2l0aW9uTGVmdH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldHpJbmRleFZpc2libGUnLCB7cGFyZW50OmNvbnN0YW50Lk1vZGVEZWNsYXJhdGlvbkdyb3VwX3N0ciwgdXVpZDogaXRlbS51dWlkLCBpc1Zpc2libGU6IHRydWUsIGNvbXBvOiAndmlzaWJsZScsIHN0YXJ0VVVJRDogdGhpcy5lbGVtZW50LnV1aWR9ICkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4geyANCiAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdFbGVtZW50LW9wZW4nLCB0cnVlLCBpdGVtLnV1aWQpDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5ld0xpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzbW9kZWRlY2xhcicsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc21vZGVkZWNsYXInLCBpdGVtLnV1aWQsIHRydWUpDQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpdGVtLnV1aWQrMSkuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0Vmlld0xpbmVJbmZvJywge3N0YXJ0OnRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc21vZGVkZWNsYXInLCBlbmQ6aXRlbS51dWlkLCBpc2NpcmNsZTpmYWxzZSwgcmVmTnVtOjR9KQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuc2V0YWN0aXZlVVVJRCgpDQogICAgICAgIH0sDQogICAgICAgIG5ld01vZGVEZWNsYXJhdGlvbkdyb3VwKCkgew0KICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdhZGRFbGVtZW50TW9kZURlY2xhcmF0aW9uR3JvdXAnLCB7DQogICAgICAgICAgICAgICAgbmFtZTogdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXROYW1lTW9kZURlY2xhcmF0aW9uR3JvdXAsIHBhdGg6ICcnLCBpbnB1dDogZmFsc2UsDQogICAgICAgICAgICAgICAgdG9wOiB0aGlzLmVsZW1lbnQudG9wICsgNDgwLCBsZWZ0OiB0aGlzLmVsZW1lbnQubGVmdCArIHRoaXMuJHNldFBvc2l0aW9uTGVmdCwgemluZGV4OiAxMCwgDQogICAgICAgICAgICAgICAgbW9kZWRlY2xhcmF0aW9uOlt7bmFtZTogJ09mZicsIHZhbHVlOiAnJ30se25hbWU6ICdTdGFydHVwJywgVmFsdWU6ICcnfV0sIGluaXRtb2RlOidPZmYnLCBpY29uOiJtZGktY2xpcGJvYXJkLW91dGxpbmUiLCB2YWxpZGF0aW9uOiBmYWxzZQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdhZGQtZWxlbWVudCcsIGNvbnN0YW50Lk1vZGVEZWNsYXJhdGlvbkdyb3VwX3N0cikNCiAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdhZGQtZWxlbWVudCcsIGNvbnN0YW50Lk1hY2hpbmVzX3N0cikNCiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnZWRpdFByb2Nlc3MnLCB7Y29tcG86InoiLCB1dWlkOnRoaXMuZWxlbWVudC51dWlkLCB6aW5kZXg6Mn0gKQ0KICAgICAgICB9LA0KDQogICAgICAgIGFkZERlcGVuZGVudFN0YXJ0dXAoKSB7DQogICAgICAgICAgICB0aGlzLmNsaWNrT3RoZXJGaWVsZHMoKQ0KICAgICAgICAgICAgY29uc3QgZWRpdEl0ZW0gPSB7IGV4ZWN1dGlvbjogW10sIGZ1bmN0aW9uSXRlbTogW10sIHJlc291cmNlUmVmOiBudWxsLCBzdGFydHVwQ29uZmlnUmVmOiBudWxsLCBpZDogJyd9DQogICAgICAgICAgICBsZXQgcmVzID0gdHJ1ZSwgbiA9IDANCiAgICAgICAgICAgIHdoaWxlIChyZXMpIHsNCiAgICAgICAgICAgICAgICBuKys7DQogICAgICAgICAgICAgICAgcmVzID0gdGhpcy5lbGVtZW50LmRlcGVuZGVudC5zb21lKGl0ZW0gPT4gaXRlbS5pZCA9PSBuKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWRpdEl0ZW0uaWQgPSBuDQogICAgICAgICAgICBjb25zdCBhZGRPYmogPSBuZXcgT2JqZWN0KGVkaXRJdGVtKQ0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LmRlcGVuZGVudC5wdXNoKGFkZE9iaikNCiAgICAgICAgICAgIHRoaXMuZGVwZW5kZW50U3RhcnR1cFRhYiA9IHRoaXMuZWxlbWVudC5kZXBlbmRlbnQubGVuZ3RoLTENCiAgICAgICAgICAgIGlmICh0aGlzLmxvY2F0aW9uID09IDEpIHsNCiAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnY2hhbmdlTGluZS1zb21laXBTZXJ2aWNlJywgJycsIHRoaXMuZWxlbWVudC51dWlkLCBudWxsKQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBjbGlja0RlcGVuZGVudFN0YXJ0dXB0YWIoKSB7DQogICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdjbGlja0RlcGVuZGVudFN0YXJ0dXB0YWInKQ0KICAgICAgICAgICAgdGhpcy5pc2RlbGV0ZUZ1bmN0aW9uRyA9IGZhbHNlDQogICAgICAgICAgICB0aGlzLmlzZGVsZXRlRXhlY3V0aW9uRCA9IGZhbHNlDQogICAgICAgICAgICB0aGlzLnNlbGVjdERlbGVjdEZ1bmN0aW9uR0l0ZW0gPSBbXQ0KICAgICAgICAgICAgdGhpcy5zZWxlY3REZWxlY3RFeGVjdXRpb25ESXRlbSA9IFtdDQogICAgICAgIH0sDQogICAgICAgIGNoYW5nZURlcGVuZGVudFN0YXJ0dXBUYWIoKSB7DQogICAgICAgICAgICBpZiAodGhpcy5yZWZFeGVjdXRpb24gIT0gbnVsbCB8fCB0aGlzLnJlZkZ1bmN0aW9uICE9IG51bGwgfHwgdGhpcy5yZWZSZXNvdXJjZSB8fCB0aGlzLnJlZlN0YXJ0dXBDKSB7DQogICAgICAgICAgICAgICAgdGhpcy5kZWxldGVPcGVuRWxlbWVudCgpDQogICAgICAgICAgICAgICAgdGhpcy5yZWZFeGVjdXRpb24gPSBudWxsDQogICAgICAgICAgICAgICAgdGhpcy5yZWZGdW5jdGlvbiA9IG51bGwNCiAgICAgICAgICAgICAgICB0aGlzLnJlZlJlc291cmNlID0gZmFsc2UNCiAgICAgICAgICAgICAgICB0aGlzLnJlZlN0YXJ0dXBDID0gZmFsc2UNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2NoYW5nZURlcGVuZGVudFN0YXJ0dXBUYWInICt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWIpDQogICAgICAgICAgICAvKmlmKHRoaXMuZWxlbWVudC5kZXBlbmRlbnQubGVuZ3RoID4gMCAmJiB0aGlzLmxvY2F0aW9uID09IDEgJiYgdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge0V2ZW50QnVzLiRlbWl0KCdjaGFuZ2VMaW5lLXNvbWVpcFNlcnZpY2UnLCAnJywgdGhpcy5lbGVtZW50LnV1aWQsIHRoaXMuZGVwZW5kZW50U3RhcnR1cFRhYiwgdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKX0sIDMwMCk7DQogICAgICAgICAgICB9Ki8NCiAgICAgICAgfSwNCiAgICAgICAgZGVsZXRlRGVwZW5kZW50U3RhcnR1cChpZHgpIHsNCiAgICAgICAgICAgIHRoaXMuY2xpY2tPdGhlckZpZWxkcygpDQogICAgICAgICAgICBjb25zb2xlLmxvZygnZGVsZXRlRGVwZW5kZW50U3RhcnR1cCcgKyBpZHgpDQogICAgICAgICAgICB0aGlzLmVsZW1lbnQuZGVwZW5kZW50W2lkeF0uZnVuY3Rpb25JdGVtLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgICAgICAgICAgdmFyIGVuZExpbmVDb24gPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ2NvbnRleHQtJytpdGVtLmlkKyctJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W2lkeF0uaWQpDQogICAgICAgICAgICAgICAgaWYoZW5kTGluZUNvbiAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZmdjb250ZXh0LScraXRlbS5pZCsnLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFtpZHhdLmlkKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB2YXIgZW5kTGluZXRhcmcgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ3RhcmdldC0nK2l0ZW0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbaWR4XS5pZCkNCiAgICAgICAgICAgICAgICBpZihlbmRMaW5ldGFyZyAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZmd0YXJnZXQtJytpdGVtLmlkKyctJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W2lkeF0uaWQpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbaWR4XS5leGVjdXRpb24uZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgICAgICAgICB2YXIgZW5kTGluZUMgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9lZGNvbnRleHQtJytpdGVtLmlkKyctJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W2lkeF0uaWQpDQogICAgICAgICAgICAgICAgaWYoZW5kTGluZUMgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2VkY29udGV4dC0nK2l0ZW0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbaWR4XS5pZCkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdmFyIGVuZExpbmV0ID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZWR0YXJnZXQtJytpdGVtLmlkKyctJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W2lkeF0uaWQpDQogICAgICAgICAgICAgICAgaWYoZW5kTGluZXQgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2VkdGFyZ2V0LScraXRlbS5pZCsnLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFtpZHhdLmlkKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICB2YXIgZW5kTGluZQ0KICAgICAgICAgICAgZW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NyZXNvcmNlLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFtpZHhdLmlkKQ0KICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3Jlc29yY2UtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W2lkeF0uaWQpDQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3N0YXJ0dXAtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W2lkeF0uaWQpDQogICAgICAgICAgICBpZiAoZW5kTGluZSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzc3RhcnR1cC0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbaWR4XS5pZCkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LmRlcGVuZGVudC5zcGxpY2UoaWR4LCAxKQ0KICAgICAgICB9LA0KICAgICAgICBpc0NoZWNrRnVuY3Rpb25HKCkgew0KICAgICAgICAgICAgdGhpcy5jbGlja090aGVyRmllbGRzKCkNCiAgICAgICAgICAgIGlmICh0aGlzLmlzZGVsZXRlRnVuY3Rpb25HID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmlzZGVsZXRlRnVuY3Rpb25HID0gZmFsc2UNCiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdERlbGVjdEZ1bmN0aW9uR0l0ZW0gPSBbXQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLmlzZGVsZXRlRnVuY3Rpb25HID0gdHJ1ZQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBkZWxldGVGdW5jdGlvbkcoKSB7DQogICAgICAgICAgICB0aGlzLmNsaWNrT3RoZXJGaWVsZHMoKQ0KICAgICAgICAgICAgaWYgKHRoaXMuaXNkZWxldGVGdW5jdGlvbkcgPT0gdHJ1ZSkgew0KICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0RGVsZWN0RnVuY3Rpb25HSXRlbS5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGk9MDsgaTx0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZnVuY3Rpb25JdGVtLmxlbmd0aDsgaSsrKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLmlkID09IHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW1baV0uaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW5kTGluZUNvbiA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2ZnY29udGV4dC0nK2l0ZW0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihlbmRMaW5lQ29uICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ2NvbnRleHQtJytpdGVtLmlkKyctJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbmRMaW5ldGFyZyA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2ZndGFyZ2V0LScraXRlbS5pZCsnLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVuZExpbmV0YXJnICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ3RhcmdldC0nK2l0ZW0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KQ0KDQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmZ1bmN0aW9uSXRlbSA9IHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW0uZmlsdGVyKGl0ZW0gPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbGVjdERlbGVjdEZ1bmN0aW9uR0l0ZW0uaW5kZXhPZihpdGVtKSA8IDAgfSkNCg0KICAgICAgICAgICAgICAgIHRoaXMuaXNkZWxldGVGdW5jdGlvbkcgPSBmYWxzZQ0KICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0RGVsZWN0RnVuY3Rpb25HSXRlbSA9IFtdDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIG9wZW5GdW5jdGlvbkcoaWR4KSB7DQogICAgICAgICAgICB0aGlzLnNlbENvbnRleHRNb2RlID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRNYWNoaW5lRkcNCiAgICAgICAgICAgIHRoaXMuc2VsVGFyZ2V0TW9kZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0TW9kZURlY2xhcmF0aW9uDQoNCiAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZnVuY3Rpb25JdGVtW2lkeF0uY29udGV4dE1vZGUgIT0gbnVsbCApIHsNCiAgICAgICAgICAgICAgICB2YXIgZW5kTGluZUMgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ2NvbnRleHQtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZnVuY3Rpb25JdGVtW2lkeF0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgICAgICBpZiAoZW5kTGluZUMgPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIGVuZExpbmVDID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRNYWNoaW5lUGF0aCh0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZnVuY3Rpb25JdGVtW2lkeF0uY29udGV4dE1vZGUsIDIpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0uY29udGV4dE1vZGUgPSB7IG5hbWUgOnRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW1baWR4XS5jb250ZXh0TW9kZSwgdXVpZDogZW5kTGluZUMgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW1baWR4XS50YXJnZXRNb2RlICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICB2YXIgZW5kTGluZVQgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ3RhcmdldC0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW1baWR4XS5pZCsnLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lVCA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgZW5kTGluZVQgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldE1vZGVEZWNsYXJhdGlvblBhdGgodGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmZ1bmN0aW9uSXRlbVtpZHhdLnRhcmdldE1vZGUsIDEpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0udGFyZ2V0TW9kZSA9IHsgbmFtZSA6dGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmZ1bmN0aW9uSXRlbVtpZHhdLnRhcmdldE1vZGUsIHV1aWQ6IGVuZExpbmVUIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgZWRpdEZ1bmN0aW9uRyhpZHgpIHsNCiAgICAgICAgICAgIHZhciBlbmRjb250ZXh0TUxpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ2NvbnRleHQtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZnVuY3Rpb25JdGVtW2lkeF0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgIGlmIChlbmRjb250ZXh0TUxpbmUgIT0gdW5kZWZpbmVkICYmIHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0uY29udGV4dE1vZGUgPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2ZnY29udGV4dC0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW1baWR4XS5pZCsnLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW1baWR4XS5jb250ZXh0TW9kZSA9IG51bGwNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoZW5kY29udGV4dE1MaW5lICE9IHVuZGVmaW5lZCAmJiBlbmRjb250ZXh0TUxpbmUgIT0gdGhpcy5lZGl0RnVuY3Rpb25HSXRlbS5jb250ZXh0TW9kZS51dWlkKSB7DQogICAgICAgICAgICAgICAgLy/quLDsobTqurwg7IKt7KCc7ZW07JW87ZWc64ukIHZ1ZXjsl5DshJzrj4Qg7IKt7KCc7ZWY6rOgIG1haW52aWV37JeQ7ISc64+EIOyCreygnO2VmOqzoCANCiAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ2NvbnRleHQtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZnVuY3Rpb25JdGVtW2lkeF0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgICAgICB0aGlzLm5ld0xpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ2NvbnRleHQtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZnVuY3Rpb25JdGVtW2lkeF0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC51dWlkKycvZmd0YWJsZScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLmNvbnRleHRNb2RlLnV1aWQsIGZhbHNlKQ0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW1baWR4XS5jb250ZXh0TW9kZSA9IHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0uY29udGV4dE1vZGUubmFtZQ0KICAgICAgICAgICAgfSBlbHNlIGlmKGVuZGNvbnRleHRNTGluZSA9PSB1bmRlZmluZWQgJiYgdGhpcy5lZGl0RnVuY3Rpb25HSXRlbS5jb250ZXh0TW9kZSAhPSBudWxsICYmIHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0uY29udGV4dE1vZGUudXVpZCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgdGhpcy5uZXdMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZmdjb250ZXh0LScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmZ1bmN0aW9uSXRlbVtpZHhdLmlkKyctJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQudXVpZCsnL2ZndGFibGUnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgdGhpcy5lZGl0RnVuY3Rpb25HSXRlbS5jb250ZXh0TW9kZS51dWlkLCBmYWxzZSkNCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZnVuY3Rpb25JdGVtW2lkeF0uY29udGV4dE1vZGUgPSB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLmNvbnRleHRNb2RlLm5hbWUNCiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5lZGl0RnVuY3Rpb25HSXRlbS5jb250ZXh0TW9kZSAhPSBudWxsICYmIGVuZGNvbnRleHRNTGluZSA9PSB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLmNvbnRleHRNb2RlLnV1aWQgJiYgdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmZ1bmN0aW9uSXRlbVtpZHhdLmNvbnRleHRNb2RlICE9IHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0uY29udGV4dE1vZGUubmFtZSkgew0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW1baWR4XS5jb250ZXh0TW9kZSA9IHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0uY29udGV4dE1vZGUubmFtZQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB2YXIgZW5kdGFyZ2V0TUxpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ3RhcmdldC0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW1baWR4XS5pZCsnLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgaWYgKGVuZHRhcmdldE1MaW5lICE9IHVuZGVmaW5lZCAmJiB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLnRhcmdldE1vZGUgPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2ZndGFyZ2V0LScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmZ1bmN0aW9uSXRlbVtpZHhdLmlkKyctJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQpDQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmZ1bmN0aW9uSXRlbVtpZHhdLnRhcmdldE1vZGUgPSBudWxsDQogICAgICAgICAgICB9IGVsc2UgaWYgKGVuZHRhcmdldE1MaW5lICE9IHVuZGVmaW5lZCAmJiBlbmR0YXJnZXRNTGluZSAhPSB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLnRhcmdldE1vZGUudXVpZCkgew0KICAgICAgICAgICAgICAgIC8v6riw7KG06rq8IOyCreygnO2VtOyVvO2VnOuLpCB2dWV47JeQ7ISc64+EIOyCreygnO2VmOqzoCBtYWludmlld+yXkOyEnOuPhCDsgq3soJztlZjqs6AgDQogICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZmd0YXJnZXQtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZnVuY3Rpb25JdGVtW2lkeF0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgICAgICB0aGlzLm5ld0xpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ3RhcmdldC0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW1baWR4XS5pZCsnLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnV1aWQrJy9mZ3RhYmxlJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsIHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0udGFyZ2V0TW9kZS51dWlkLCBmYWxzZSkNCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZnVuY3Rpb25JdGVtW2lkeF0udGFyZ2V0TW9kZSA9IHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0udGFyZ2V0TW9kZS5uYW1lDQogICAgICAgICAgICB9IGVsc2UgaWYgKGVuZHRhcmdldE1MaW5lID09IHVuZGVmaW5lZCAmJiB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLnRhcmdldE1vZGUgIT0gdW5kZWZpbmVkICYmIHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0udGFyZ2V0TW9kZS51dWlkICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIHRoaXMubmV3TGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2ZndGFyZ2V0LScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmZ1bmN0aW9uSXRlbVtpZHhdLmlkKyctJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQudXVpZCsnL2ZndGFibGUnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgdGhpcy5lZGl0RnVuY3Rpb25HSXRlbS50YXJnZXRNb2RlLnV1aWQsIGZhbHNlKQ0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW1baWR4XS50YXJnZXRNb2RlID0gdGhpcy5lZGl0RnVuY3Rpb25HSXRlbS50YXJnZXRNb2RlLm5hbWUNCiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5lZGl0RnVuY3Rpb25HSXRlbS50YXJnZXRNb2RlICE9IHVuZGVmaW5lZCAmJiBlbmR0YXJnZXRNTGluZSA9PSB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLnRhcmdldE1vZGUudXVpZCAmJiB0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZnVuY3Rpb25JdGVtW2lkeF0udGFyZ2V0TW9kZSAhPSB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLnRhcmdldE1vZGUubmFtZSkgew0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW1baWR4XS50YXJnZXRNb2RlID0gdGhpcy5lZGl0RnVuY3Rpb25HSXRlbS50YXJnZXRNb2RlLm5hbWUNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdmFyIGVuZExpbmVDb250ZXh0ID0gbnVsbCwgZW5kTGluZVRhcmdldCA9IG51bGwNCiAgICAgICAgICAgIGlmICh0aGlzLnJlZkZ1bmN0aW9uID09IHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW1baWR4XS5pZCkgew0KICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlT3BlbkVsZW1lbnQoKQ0KICAgICAgICAgICAgICAgIGlmICh0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLnRhcmdldE1vZGUgIT0gbnVsbCAmJiB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLnRhcmdldE1vZGUudXVpZCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIGVuZExpbmVUYXJnZXQgPSB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLnRhcmdldE1vZGUudXVpZA0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXRNb2RlRGVjbGFyYXRpb25Hcm91cCcsIHtjb21wbzoiZHJhZyIsIHV1aWQ6IHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0udGFyZ2V0TW9kZS51dWlkLCB0b3A6IHRoaXMuZWxlbWVudC50b3AgKyAyMDAsIGxlZnQ6IHRoaXMuZWxlbWVudC5sZWZ0ICsgdGhpcy4kc2V0UG9zaXRpb25MZWZ0fSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0ekluZGV4VmlzaWJsZScsIHtwYXJlbnQ6Y29uc3RhbnQuTW9kZURlY2xhcmF0aW9uR3JvdXBfc3RyLCB1dWlkOiB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLnRhcmdldE1vZGUudXVpZCwgaXNWaXNpYmxlOiB0cnVlLCBjb21wbzogJ3Zpc2libGUnLCBzdGFydFVVSUQ6IHRoaXMuZWxlbWVudC51dWlkfSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0Vmlld0xpbmVJbmZvJywge3N0YXJ0OnRoaXMuZWxlbWVudC51dWlkKycvZmd0YWJsZScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCBlbmQ6ZW5kTGluZVRhcmdldCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc2NpcmNsZTpmYWxzZSwgcmVmTnVtOjYsIGlkeElEOiB0aGlzLnJlZkZ1bmN0aW9uLCB0YWJJRDogdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFifSkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4geyANCiAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdFbGVtZW50LW9wZW4nLCBmYWxzZSwgdGhpcy5lZGl0RnVuY3Rpb25HSXRlbS50YXJnZXRNb2RlLnV1aWQpDQogICAgICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnbmV3LWxpbmUnLCB0aGlzLmVsZW1lbnQudXVpZCsnL2ZndGFibGUnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgZW5kTGluZVRhcmdldCkNCiAgICAgICAgICAgICAgICAgICAgfSkNCg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAodGhpcy5lZGl0RnVuY3Rpb25HSXRlbS5jb250ZXh0TW9kZSAhPSBudWxsICYmIHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0uY29udGV4dE1vZGUudXVpZCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIGVuZExpbmVDb250ZXh0ID0gdGhpcy5lZGl0RnVuY3Rpb25HSXRlbS5jb250ZXh0TW9kZS51dWlkDQogICAgICAgICAgICAgICAgICAgIHZhciB0b3AgPSAyMDANCiAgICAgICAgICAgICAgICAgICAgaWYgKGVuZExpbmVUYXJnZXQgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0gNjAwDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdlZGl0TWFjaGluZScsIHtjb21wbzoiZHJhZyIsIHV1aWQ6IHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0uY29udGV4dE1vZGUudXVpZCwgdG9wOiB0aGlzLmVsZW1lbnQudG9wICsgdG9wLCBsZWZ0OiB0aGlzLmVsZW1lbnQubGVmdCArIHRoaXMuJHNldFBvc2l0aW9uTGVmdH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldHpJbmRleFZpc2libGUnLCB7cGFyZW50OmNvbnN0YW50Lk1hY2hpbmVfc3RyLCB1dWlkOiB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLmNvbnRleHRNb2RlLnV1aWQsIGlzVmlzaWJsZTogdHJ1ZSwgY29tcG86ICd2aXNpYmxlJywgc3RhcnRVVUlEOiB0aGlzLmVsZW1lbnQudXVpZH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFZpZXdMaW5lSW5mbycsIHtzdGFydDp0aGlzLmVsZW1lbnQudXVpZCsnL2ZndGFibGUnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQ6ZW5kTGluZUNvbnRleHQsIGlzY2lyY2xlOmZhbHNlLCByZWZOdW06NiwgaWR4SUQ6IHRoaXMucmVmRnVuY3Rpb24sIHRhYklEOiB0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJ9KQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7IA0KICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ0VsZW1lbnQtb3BlbicsIGZhbHNlLCB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLmNvbnRleHRNb2RlLnV1aWQpDQogICAgICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnbmV3LWxpbmUnLCB0aGlzLmVsZW1lbnQudXVpZCsnL2ZndGFibGUnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgZW5kTGluZUNvbnRleHQpDQogICAgICAgICAgICAgICAgICAgIH0pDQoNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7IA0KICAgICAgICAgICAgICAgICAgICBpZiAoZW5kTGluZUNvbnRleHQgIT0gbnVsbCAmJiBlbmRMaW5lVGFyZ2V0ID09IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdFbGVtZW50LW9wZW4nLCB0cnVlLCBlbmRMaW5lQ29udGV4dCkNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbmRMaW5lQ29udGV4dCA9PSBudWxsICYmIGVuZExpbmVUYXJnZXQgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ0VsZW1lbnQtb3BlbicsIHRydWUsIGVuZExpbmVUYXJnZXQpDQogICAgICAgICAgICAgICAgICAgIH0gDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgdGhpcy5jYW5jZWxGdW5jdGlvbkcoKQ0KICAgICAgICB9LA0KICAgICAgICBjYW5jZWxGdW5jdGlvbkcoKSB7DQogICAgICAgICAgICB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SXRlbSkNCiAgICAgICAgICAgIHRoaXMuc2V0YWN0aXZlVVVJRCgpDQogICAgICAgIH0sDQogICAgICAgIGFkZEZ1bmN0aW9uRygpIHsNCiAgICAgICAgICAgIHRoaXMuY2xpY2tPdGhlckZpZWxkcygpDQogICAgICAgICAgICBsZXQgcmVzID0gdHJ1ZSwgbiA9IDANCiAgICAgICAgICAgIHdoaWxlIChyZXMpIHsNCiAgICAgICAgICAgICAgICBuKysNCiAgICAgICAgICAgICAgICByZXMgPSB0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZnVuY3Rpb25JdGVtLnNvbWUoaXRlbSA9PiBpdGVtLmlkID09PSBuKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5lZGl0RnVuY3Rpb25HSXRlbS5pZCA9IG4NCiAgICAgICAgICAgIHZhciBlbmRMaW5lQ29udGV4dCA9IG51bGwsIGVuZExpbmVUYXJnZXQgPSBudWxsDQogICAgICAgICAgICBpZiggdGhpcy5lZGl0RnVuY3Rpb25HSXRlbS50YXJnZXRNb2RlICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICBlbmRMaW5lVGFyZ2V0ID0gdGhpcy5lZGl0RnVuY3Rpb25HSXRlbS50YXJnZXRNb2RlLnV1aWQNCiAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXRNb2RlRGVjbGFyYXRpb25Hcm91cCcsIHtjb21wbzoiZHJhZyIsIHV1aWQ6IHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0udGFyZ2V0TW9kZS51dWlkLCB0b3A6IHRoaXMuZWxlbWVudC50b3AgKyAyMDAsIGxlZnQ6IHRoaXMuZWxlbWVudC5sZWZ0ICsgdGhpcy4kc2V0UG9zaXRpb25MZWZ0fSApDQogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXR6SW5kZXhWaXNpYmxlJywge3BhcmVudDpjb25zdGFudC5Nb2RlRGVjbGFyYXRpb25Hcm91cF9zdHIsIHV1aWQ6IHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0udGFyZ2V0TW9kZS51dWlkLCBpc1Zpc2libGU6IHRydWUsIGNvbXBvOiAndmlzaWJsZScsIHN0YXJ0VVVJRDogdGhpcy5lbGVtZW50LnV1aWR9ICkNCiAgICAgICAgICAgICAgICB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLnRhcmdldE1vZGUgPSB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLnRhcmdldE1vZGUubmFtZQ0KICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0Vmlld0xpbmVJbmZvJywge3N0YXJ0OnRoaXMuZWxlbWVudC51dWlkKycvZmd0YWJsZScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCBlbmQ6ZW5kTGluZVRhcmdldCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc2NpcmNsZTpmYWxzZSwgcmVmTnVtOjYsIGlkeElEOiB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLmlkLCB0YWJJRDogdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFifSkNCiAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7IA0KICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnRWxlbWVudC1vcGVuJywgZmFsc2UsIHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0udGFyZ2V0TW9kZS51dWlkKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLm5ld0xpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ3RhcmdldC0nK24rJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgdGhpcy5lbGVtZW50LnV1aWQrJy9mZ3RhYmxlJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lVGFyZ2V0LCB0cnVlKQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiggdGhpcy5lZGl0RnVuY3Rpb25HSXRlbS5jb250ZXh0TW9kZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgZW5kTGluZUNvbnRleHQgPSB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLmNvbnRleHRNb2RlLnV1aWQNCiAgICAgICAgICAgICAgICB2YXIgdG9wID0gMjAwDQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmVUYXJnZXQgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICB0b3AgPSA2MDANCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdlZGl0TWFjaGluZScsIHtjb21wbzoiZHJhZyIsIHV1aWQ6IHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0uY29udGV4dE1vZGUudXVpZCwgdG9wOiB0aGlzLmVsZW1lbnQudG9wICsgdG9wLCBsZWZ0OiB0aGlzLmVsZW1lbnQubGVmdCArIHRoaXMuJHNldFBvc2l0aW9uTGVmdH0gKQ0KICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0ekluZGV4VmlzaWJsZScsIHtwYXJlbnQ6Y29uc3RhbnQuTWFjaGluZV9zdHIsIHV1aWQ6IHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0uY29udGV4dE1vZGUudXVpZCwgaXNWaXNpYmxlOiB0cnVlLCBjb21wbzogJ3Zpc2libGUnLCBzdGFydFVVSUQ6IHRoaXMuZWxlbWVudC51dWlkfSApDQogICAgICAgICAgICAgICAgdGhpcy5lZGl0RnVuY3Rpb25HSXRlbS5jb250ZXh0TW9kZSA9IHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0uY29udGV4dE1vZGUubmFtZQ0KICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0Vmlld0xpbmVJbmZvJywge3N0YXJ0OnRoaXMuZWxlbWVudC51dWlkKycvZmd0YWJsZScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCBlbmQ6ZW5kTGluZUNvbnRleHQsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNjaXJjbGU6ZmFsc2UsIHJlZk51bTo2LCBpZHhJRDogdGhpcy5lZGl0RnVuY3Rpb25HSXRlbS5pZCwgdGFiSUQ6IHRoaXMuZGVwZW5kZW50U3RhcnR1cFRhYn0pDQogICAgICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4geyANCiAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ0VsZW1lbnQtb3BlbicsIGZhbHNlLCB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLmNvbnRleHRNb2RlLnV1aWQpDQogICAgICAgICAgICAgICAgICAgIHRoaXMubmV3TGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2ZnY29udGV4dC0nK24rJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgdGhpcy5lbGVtZW50LnV1aWQrJy9mZ3RhYmxlJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lQ29udGV4dCwgdHJ1ZSkNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7IA0KICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lQ29udGV4dCAhPSBudWxsICYmIGVuZExpbmVUYXJnZXQgPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnRWxlbWVudC1vcGVuJywgdHJ1ZSwgZW5kTGluZUNvbnRleHQpDQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbmRMaW5lQ29udGV4dCA9PSBudWxsICYmIGVuZExpbmVUYXJnZXQgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnRWxlbWVudC1vcGVuJywgdHJ1ZSwgZW5kTGluZVRhcmdldCkNCiAgICAgICAgICAgICAgICB9IA0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgYWRkT2JqID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5lZGl0RnVuY3Rpb25HSXRlbSkNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5mdW5jdGlvbkl0ZW0ucHVzaChhZGRPYmopDQogICAgICAgICAgICB0aGlzLnJlZkZ1bmN0aW9uID0gbg0KICAgICAgICAgICAgdGhpcy5jYW5jZWxGdW5jdGlvbkcoKQ0KICAgICAgICB9LA0KICAgICAgICBzZXRDb250ZXh0TW9kZVNlbGVjdCgpIHsNCiAgICAgICAgICAgIGlmICh0aGlzLmlzRWRpdGluZ0NvbnRleHRNb2RlID09IHRydWUpIHsgDQogICAgICAgICAgICAgICAgaWYgKHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0uY29udGV4dE1vZGUgIT0gbnVsbCAmJiB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLmNvbnRleHRNb2RlLnV1aWQgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldERldGFpbFZpZXcnLCB7dXVpZDogdGhpcy5lZGl0RnVuY3Rpb25HSXRlbS5jb250ZXh0TW9kZS51dWlkLCBlbGVtZW50OiBjb25zdGFudC5NYWNoaW5lX3N0cn0gKQ0KICAgICAgICAgICAgICAgICAgICAvLyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLmNvbnRleHRNb2RlLnV1aWQrdGhpcy5sb2NhdGlvbikuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pDQogICAgICAgICAgICAgICAgICAgIC8vIEV2ZW50QnVzLiRlbWl0KCdhY3RpdmUtZWxlbWVudCcsIHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0uY29udGV4dE1vZGUudXVpZCkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5zZXRDb250ZXh0TUxpc3QoKQ0KICAgICAgICAgICAgICAgIHRoaXMuaXNFZGl0aW5nQ29udGV4dE1vZGUgPSBmYWxzZQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLmlzRWRpdGluZ0NvbnRleHRNb2RlID0gdHJ1ZQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBzZXRDb250ZXh0TUxpc3QoKSB7DQogICAgICAgICAgICB0aGlzLnNlbENvbnRleHRNb2RlID0gIHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0TWFjaGluZUZHDQogICAgICAgICAgICB0aGlzLnNldGFjdGl2ZVVVSUQoKQ0KICAgICAgICB9LA0KICAgICAgICBjbGVhckNvbnRleHRNb2RlUmVmKCkgew0KICAgICAgICAgICAgdGhpcy5pc0VkaXRpbmdDb250ZXh0TW9kZSA9IHRydWUNCiAgICAgICAgICAgIHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0uY29udGV4dE1vZGUgPSBudWxsDQogICAgICAgIH0sDQogICAgICAgIHNldFRhcmdldE1vZGVTZWxlY3QoKSB7DQogICAgICAgICAgICBpZiAodGhpcy5pc0VkaXRpbmdUYXJnZXRNb2RlID09IHRydWUpIHsgDQogICAgICAgICAgICAgICAgaWYgKHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0udGFyZ2V0TW9kZSAhPSBudWxsICYmIHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0udGFyZ2V0TW9kZS51dWlkICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXREZXRhaWxWaWV3Jywge3V1aWQ6IHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0udGFyZ2V0TW9kZS51dWlkLCBlbGVtZW50OiBjb25zdGFudC5Nb2RlRGVjbGFyYXRpb25Hcm91cF9zdHJ9ICkNCiAgICAgICAgICAgICAgICAgICAgLy8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5lZGl0RnVuY3Rpb25HSXRlbS50YXJnZXRNb2RlLnV1aWQrdGhpcy5sb2NhdGlvbikuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pDQogICAgICAgICAgICAgICAgICAgIC8vIEV2ZW50QnVzLiRlbWl0KCdhY3RpdmUtZWxlbWVudCcsIHRoaXMuZWRpdEZ1bmN0aW9uR0l0ZW0udGFyZ2V0TW9kZS51dWlkKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLnNldFRhcmdldE1MaXN0KCkNCiAgICAgICAgICAgICAgICB0aGlzLmlzRWRpdGluZ1RhcmdldE1vZGUgPSBmYWxzZQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aGlzLmlzRWRpdGluZ1RhcmdldE1vZGUgPSB0cnVlDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIHNldFRhcmdldE1MaXN0KCkgew0KICAgICAgICAgICAgdGhpcy5zZWxUYXJnZXRNb2RlID0gIHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0TW9kZURlY2xhcmF0aW9uDQogICAgICAgICAgICBjb25zb2xlLmxvZygnc2V0VGFyZ2V0TUxpc3QnK3RoaXMuc2VsVGFyZ2V0TW9kZS5sZW5ndGgpDQogICAgICAgICAgICB0aGlzLnNldGFjdGl2ZVVVSUQoKQ0KICAgICAgICB9LA0KICAgICAgICBjbGVhclRhcmdldE1vZGVSZWYoKSB7DQogICAgICAgICAgICB0aGlzLmlzRWRpdGluZ1RhcmdldE1vZGUgPSB0cnVlDQogICAgICAgICAgICB0aGlzLmVkaXRGdW5jdGlvbkdJdGVtLnRhcmdldE1vZGUgPSBudWxsDQogICAgICAgIH0sDQoNCg0KICAgICAgICBjbGVhclJlc291cmNlRyhpdGVtKSB7DQogICAgICAgICAgICBpdGVtLnJlc291cmNlUmVmID0gbnVsbA0KICAgICAgICAgICAgdmFyIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzcmVzb3JjZS0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NyZXNvcmNlLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5jbGlja090aGVyRmllbGRzKCkNCiAgICAgICAgfSwNCiAgICAgICAgc2V0UmVzb3VyY2VHU2VsZWN0KGl0ZW0pIHsNCiAgICAgICAgICAgIHRoaXMuY2xpY2tPdGhlckZpZWxkcygpDQogICAgICAgICAgICBpZiAoaXRlbS5yZXNvdXJjZVJlZiAhPSBudWxsKSB7dGhpcy5yZWZSZXNvdXJjZSA9IHRydWV9DQogICAgICAgICAgICBpZiAodGhpcy4kc3RvcmUuZ2V0dGVycy5nZXREZWxldGVPcGVuRWxlbWVudCh0aGlzLmVsZW1lbnQudXVpZCkrMSA9PSB0aGlzLiRzdG9yZS5zdGF0ZS5vcGVuRWxlbWVudC5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICB2YXIgZW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NyZXNvcmNlLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRNYWNoaW5lUGF0aChpdGVtLnJlc291cmNlUmVmLCAxKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoZW5kTGluZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnZWRpdE1hY2hpbmUnLCB7Y29tcG86ImRyYWciLCB1dWlkOiBlbmRMaW5lLCB0b3A6IHRoaXMuZWxlbWVudC50b3AgKyAyMDAsIGxlZnQ6IHRoaXMuZWxlbWVudC5sZWZ0ICsgdGhpcy4kc2V0UG9zaXRpb25MZWZ0fSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0ekluZGV4VmlzaWJsZScsIHtwYXJlbnQ6Y29uc3RhbnQuTWFjaGluZV9zdHIsIHV1aWQ6IGVuZExpbmUsIGlzVmlzaWJsZTogdHJ1ZSwgY29tcG86ICd2aXNpYmxlJywgc3RhcnRVVUlEOiB0aGlzLmVsZW1lbnQudXVpZH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnRWxlbWVudC1vcGVuJywgdHJ1ZSwgZW5kTGluZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCduZXctbGluZScsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3Jlc29yY2UtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsIGVuZExpbmUpDQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbmRMaW5lKzEpLnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFZpZXdMaW5lSW5mbycsIHtzdGFydDp0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NyZXNvcmNlLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQ6ZW5kTGluZSwgaXNjaXJjbGU6ZmFsc2UsIHJlZk51bTogNywgaWR4SUQ6IDAsIHRhYklEOiB0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJ9KQ0KICAgICAgICAgICAgICAgICAgICAvL3RoaXMuJHN0b3JlLmNvbW1pdCgnc2V0RGV0YWlsVmlldycsIHt1dWlkOiBlbmRMaW5lLCBlbGVtZW50OiBjb25zdGFudC5NYWNoaW5lX3N0cn0gKQ0KICAgICAgICAgICAgICAgICAgICAvLyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbmRMaW5lK3RoaXMubG9jYXRpb24pLnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KQ0KICAgICAgICAgICAgICAgICAgICAvLyBFdmVudEJ1cy4kZW1pdCgnYWN0aXZlLWVsZW1lbnQnLCBlbmRMaW5lKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgc2V0UmVzb3VyY2VHTGlzdCgpIHsNCiAgICAgICAgICAgIHRoaXMuc2VsUmVzb3VyY2VHID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRSZXNvdXJjZUdyb3VwDQogICAgICAgICAgICB0aGlzLnNldGFjdGl2ZVVVSUQoKQ0KICAgICAgICB9LA0KICAgICAgICBzZXRSZXNvdXJjZUcoaXRlbSwgdGFiKSB7DQogICAgICAgICAgICB0aGlzLmNsaWNrT3RoZXJGaWVsZHMoKQ0KICAgICAgICAgICAgaWYodGFiLnJlc291cmNlUmVmICE9IGl0ZW0ubmFtZSkgew0KICAgICAgICAgICAgICAgIHZhciBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3Jlc29yY2UtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQpDQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gdW5kZWZpbmVkICYmIGVuZExpbmUgIT0gaXRlbS51dWlkKSB7DQogICAgICAgICAgICAgICAgICAgIC8v6riw7KG06rq8IOyCreygnO2VtOyVvO2VnOuLpCB2dWV47JeQ7ISc64+EIOyCreygnO2VmOqzoCBtYWludmlld+yXkOyEnOuPhCDsgq3soJztlZjqs6AgDQogICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NyZXNvcmNlLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvL+yDiOuhnCDstpTqsIDtlbTspIDri6QNCiAgICAgICAgICAgICAgICBpZiAoZW5kTGluZSAhPSBpdGVtLnV1aWQpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZSZXNvdXJjZSA9IHRydWUNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdlZGl0TWFjaGluZScsIHtjb21wbzoiZHJhZyIsIHV1aWQ6IGl0ZW0udXVpZCwgdG9wOiB0aGlzLmVsZW1lbnQudG9wICsgMjAwLCBsZWZ0OiB0aGlzLmVsZW1lbnQubGVmdCArIHRoaXMuJHNldFBvc2l0aW9uTGVmdH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldHpJbmRleFZpc2libGUnLCB7cGFyZW50OmNvbnN0YW50Lk1hY2hpbmVfc3RyLCB1dWlkOiBpdGVtLnV1aWQsIGlzVmlzaWJsZTogdHJ1ZSwgY29tcG86ICd2aXNpYmxlJywgc3RhcnRVVUlEOiB0aGlzLmVsZW1lbnQudXVpZH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnRWxlbWVudC1vcGVuJywgdHJ1ZSwgaXRlbS51dWlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXdMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3Jlc29yY2UtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3Jlc29yY2UnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgaXRlbS51dWlkLCB0cnVlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaXRlbS51dWlkKzEpLnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFZpZXdMaW5lSW5mbycsIHtzdGFydDp0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NyZXNvcmNlJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDppdGVtLnV1aWQsIGlzY2lyY2xlOmZhbHNlLCByZWZOdW06NywgaWR4SUQ6IDAsIHRhYklEOiB0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJ9KQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0YWIucmVzb3VyY2VSZWYgPSBpdGVtLm5hbWUNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgaWYgKHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0RGVsZXRlT3BlbkVsZW1lbnQodGhpcy5lbGVtZW50LnV1aWQpKzEgPT0gdGhpcy4kc3RvcmUuc3RhdGUub3BlbkVsZW1lbnQubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVmUmVzb3VyY2UgPSB0cnVlDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnZWRpdE1hY2hpbmUnLCB7Y29tcG86ImRyYWciLCB1dWlkOiBpdGVtLnV1aWQsIHRvcDogdGhpcy5lbGVtZW50LnRvcCArIDIwMCwgbGVmdDogdGhpcy5lbGVtZW50LmxlZnQgKyB0aGlzLiRzZXRQb3NpdGlvbkxlZnR9ICkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXR6SW5kZXhWaXNpYmxlJywge3BhcmVudDpjb25zdGFudC5NYWNoaW5lX3N0ciwgdXVpZDogaXRlbS51dWlkLCBpc1Zpc2libGU6IHRydWUsIGNvbXBvOiAndmlzaWJsZScsIHN0YXJ0VVVJRDogdGhpcy5lbGVtZW50LnV1aWR9ICkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ0VsZW1lbnQtb3BlbicsIHRydWUsIGl0ZW0udXVpZCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmV3TGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NyZXNvcmNlLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCB0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NyZXNvcmNlJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsIGl0ZW0udXVpZCwgdHJ1ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGl0ZW0udXVpZCsxKS5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSkNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRWaWV3TGluZUluZm8nLCB7c3RhcnQ6dGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzcmVzb3JjZScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQ6aXRlbS51dWlkLCBpc2NpcmNsZTpmYWxzZSwgcmVmTnVtOjcsIGlkeElEOiAwLCB0YWJJRDogdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFifSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLnNldGFjdGl2ZVVVSUQoKQ0KICAgICAgICB9LA0KDQogICAgICAgIGNsZWFyU3RhcnR1cEMoaXRlbSkgew0KICAgICAgICAgICAgaXRlbS5zdGFydHVwQ29uZmlnUmVmID0gbnVsbA0KICAgICAgICAgICAgdmFyIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzc3RhcnR1cC0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NzdGFydHVwLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5jbGlja090aGVyRmllbGRzKCkNCiAgICAgICAgfSwNCiAgICAgICAgc2V0U3RhcnR1cENTZWxlY3QoaXRlbSkgew0KICAgICAgICAgICAgdGhpcy5jbGlja090aGVyRmllbGRzKCkNCiAgICAgICAgICAgIGlmIChpdGVtLnN0YXJ0dXBDb25maWdSZWYgIT0gbnVsbCkge3RoaXMucmVmU3RhcnR1cEMgPSB0cnVlfQ0KICAgICAgICAgICAgaWYgKHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0RGVsZXRlT3BlbkVsZW1lbnQodGhpcy5lbGVtZW50LnV1aWQpKzEgPT0gdGhpcy4kc3RvcmUuc3RhdGUub3BlbkVsZW1lbnQubGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgdmFyIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzc3RhcnR1cC0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgICAgICBpZiAoZW5kTGluZSA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgZW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0U3RhcnR1cENvbmZpZ1BhdGgoaXRlbS5zdGFydHVwQ29uZmlnUmVmKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoZW5kTGluZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnZWRpdFN0YXJ0dXBDb25maWcnLCB7Y29tcG86ImRyYWciLCB1dWlkOiBlbmRMaW5lLCB0b3A6IHRoaXMuZWxlbWVudC50b3AgKyAyMDAsIGxlZnQ6IHRoaXMuZWxlbWVudC5sZWZ0ICsgdGhpcy4kc2V0UG9zaXRpb25MZWZ0fSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0ekluZGV4VmlzaWJsZScsIHtwYXJlbnQ6Y29uc3RhbnQuU3RhcnR1cENvbmZpZ19zdHIsIHV1aWQ6IGVuZExpbmUsIGlzVmlzaWJsZTogdHJ1ZSwgY29tcG86ICd2aXNpYmxlJywgc3RhcnRVVUlEOiB0aGlzLmVsZW1lbnQudXVpZH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnbmV3LWxpbmUnLCB0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NzdGFydHVwJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsIGVuZExpbmUpDQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbmRMaW5lKzEpLnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFZpZXdMaW5lSW5mbycsIHtzdGFydDp0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NzdGFydHVwLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCBlbmQ6ZW5kTGluZSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNjaXJjbGU6ZmFsc2UsIHJlZk51bTo4LCBpZHhJRDogMCwgdGFiSUQ6IHRoaXMuZGVwZW5kZW50U3RhcnR1cFRhYn0pDQogICAgICAgICAgICAgICAgICAgIC8vdGhpcy4kc3RvcmUuY29tbWl0KCdzZXREZXRhaWxWaWV3Jywge3V1aWQ6IGVuZExpbmUsIGVsZW1lbnQ6IGNvbnN0YW50LlN0YXJ0dXBDb25maWdfc3RyfSApDQogICAgICAgICAgICAgICAgICAgIC8vIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVuZExpbmUrdGhpcy5sb2NhdGlvbikuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pDQogICAgICAgICAgICAgICAgICAgIC8vIEV2ZW50QnVzLiRlbWl0KCdhY3RpdmUtZWxlbWVudCcsIGVuZExpbmUpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBzZXRTdGFydHVwQ0xpc3QoKSB7DQogICAgICAgICAgICB0aGlzLnNlbFN0YXJ0dXBDID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRTdGFydHVwQ29uZmlnDQogICAgICAgICAgICB0aGlzLnNldGFjdGl2ZVVVSUQoKQ0KICAgICAgICB9LA0KICAgICAgICBzZXRTdGFydHVwQyhpdGVtLCB0YWIpIHsNCiAgICAgICAgICAgIHRoaXMuY2xpY2tPdGhlckZpZWxkcygpDQogICAgICAgICAgICBpZih0YWIuc3RhcnR1cENvbmZpZ1JlZiAhPSBpdGVtLm5hbWUpIHsNCiAgICAgICAgICAgICAgICB2YXIgZW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NzdGFydHVwLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IHVuZGVmaW5lZCAmJiBlbmRMaW5lICE9IGl0ZW0udXVpZCkgew0KICAgICAgICAgICAgICAgICAgICAvL+q4sOyhtOq6vCDsgq3soJztlbTslbztlZzri6QgdnVleOyXkOyEnOuPhCDsgq3soJztlZjqs6AgbWFpbnZpZXfsl5DshJzrj4Qg7IKt7KCc7ZWY6rOgIA0KICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzc3RhcnR1cC0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy/sg4jroZwg7LaU6rCA7ZW07KSA64ukDQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gaXRlbS51dWlkKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVmU3RhcnR1cEMgPSB0cnVlDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnZWRpdFN0YXJ0dXBDb25maWcnLCB7Y29tcG86ImRyYWciLCB1dWlkOiBpdGVtLnV1aWQsIHRvcDogdGhpcy5lbGVtZW50LnRvcCArIDIwMCwgbGVmdDogdGhpcy5lbGVtZW50LmxlZnQgKyB0aGlzLiRzZXRQb3NpdGlvbkxlZnR9ICkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXR6SW5kZXhWaXNpYmxlJywge3BhcmVudDpjb25zdGFudC5TdGFydHVwQ29uZmlnX3N0ciwgdXVpZDogaXRlbS51dWlkLCBpc1Zpc2libGU6IHRydWUsIGNvbXBvOiAndmlzaWJsZScsIHN0YXJ0VVVJRDogdGhpcy5lbGVtZW50LnV1aWR9ICkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXdMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3N0YXJ0dXAtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3N0YXJ0dXAnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnV1aWQsIHRydWUpDQogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpdGVtLnV1aWQrMSkuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pDQogICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0Vmlld0xpbmVJbmZvJywge3N0YXJ0OnRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3N0YXJ0dXAnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOml0ZW0udXVpZCwgaXNjaXJjbGU6ZmFsc2UsIHJlZk51bTo4LCBpZHhJRDogMCwgdGFiSUQ6IHRoaXMuZGVwZW5kZW50U3RhcnR1cFRhYn0pDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRhYi5zdGFydHVwQ29uZmlnUmVmID0gaXRlbS5uYW1lDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldERlbGV0ZU9wZW5FbGVtZW50KHRoaXMuZWxlbWVudC51dWlkKSsxID09IHRoaXMuJHN0b3JlLnN0YXRlLm9wZW5FbGVtZW50Lmxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZlN0YXJ0dXBDID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXRTdGFydHVwQ29uZmlnJywge2NvbXBvOiJkcmFnIiwgdXVpZDogaXRlbS51dWlkLCB0b3A6IHRoaXMuZWxlbWVudC50b3AgKyAyMDAsIGxlZnQ6IHRoaXMuZWxlbWVudC5sZWZ0ICsgdGhpcy4kc2V0UG9zaXRpb25MZWZ0fSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0ekluZGV4VmlzaWJsZScsIHtwYXJlbnQ6Y29uc3RhbnQuU3RhcnR1cENvbmZpZ19zdHIsIHV1aWQ6IGl0ZW0udXVpZCwgaXNWaXNpYmxlOiB0cnVlLCBjb21wbzogJ3Zpc2libGUnLCBzdGFydFVVSUQ6IHRoaXMuZWxlbWVudC51dWlkfSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmV3TGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NzdGFydHVwLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCB0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NzdGFydHVwJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0udXVpZCwgdHJ1ZSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGl0ZW0udXVpZCsxKS5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCcgfSkNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRWaWV3TGluZUluZm8nLCB7c3RhcnQ6dGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzc3RhcnR1cC0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOml0ZW0udXVpZCwgaXNjaXJjbGU6ZmFsc2UsIHJlZk51bTo4LCBpZHhJRDogMCwgdGFiSUQ6IHRoaXMuZGVwZW5kZW50U3RhcnR1cFRhYn0pDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5zZXRhY3RpdmVVVUlEKCkNCiAgICAgICAgfSwNCiAgICAgICAgbmV3U3RhcnR1cEMoKSB7DQogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2FkZEVsZW1lbnRTdGFydHVwQ29uZmlnJywgew0KICAgICAgICAgICAgICAgIG5hbWU6IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0TmFtZVN0YXJ0dXBDb25maWcsIHBhdGg6ICcnLCBpbnB1dDogZmFsc2UsDQogICAgICAgICAgICAgICAgdG9wOiB0aGlzLmVsZW1lbnQudG9wICsgMTE0NSwgbGVmdDogdGhpcy5lbGVtZW50LmxlZnQgKyB0aGlzLiRzZXRQb3NpdGlvbkxlZnQsIHppbmRleDogMTAsIGljb246Im1kaS1jbGlwYm9hcmQtb3V0bGluZSIsIHZhbGlkYXRpb246IGZhbHNlLA0KICAgICAgICAgICAgICAgIGNvbmZpZzogW10NCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnYWRkLWVsZW1lbnQnLCBjb25zdGFudC5TdGFydHVwQ29uZmlnX3N0cikNCiAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdhZGQtZWxlbWVudCcsIGNvbnN0YW50LkFkYXB0aXZlQXBwbGljYXRpb25fc3RyKQ0KICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdlZGl0UHJvY2VzcycsIHtjb21wbzoieiIsIHV1aWQ6dGhpcy5lbGVtZW50LnV1aWQsIHppbmRleDoyfSApDQogICAgICAgIH0sDQoNCiAgICAgICAgaXNDaGVja0V4ZWN1dGlvbkQoKSB7DQogICAgICAgICAgICB0aGlzLmNsaWNrT3RoZXJGaWVsZHMoKQ0KICAgICAgICAgICAgaWYgKHRoaXMuaXNkZWxldGVFeGVjdXRpb25EID09IHRydWUpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmlzZGVsZXRlRXhlY3V0aW9uRCA9IGZhbHNlDQogICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REZWxlY3RFeGVjdXRpb25ESXRlbSA9IFtdDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMuaXNkZWxldGVFeGVjdXRpb25EID0gdHJ1ZQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBkZWxldGVFeGVjdXRpb25EKCkgew0KICAgICAgICAgICAgdGhpcy5jbGlja090aGVyRmllbGRzKCkNCiAgICAgICAgICAgIGlmICh0aGlzLmlzZGVsZXRlRXhlY3V0aW9uRCA9PSB0cnVlKSB7DQogICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REZWxlY3RFeGVjdXRpb25ESXRlbS5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGk9MDsgaTx0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uLmxlbmd0aDsgaSsrKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLmlkID09IHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5leGVjdXRpb25baV0uaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW5kTGluZUNvbiA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2VkY29udGV4dC0nK2l0ZW0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihlbmRMaW5lQ29uICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9lZGNvbnRleHQtJytpdGVtLmlkKyctJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbmRMaW5ldGFyZyA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2VkdGFyZ2V0LScraXRlbS5pZCsnLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVuZExpbmV0YXJnICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9lZHRhcmdldC0nK2l0ZW0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KQ0KDQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbiA9IHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5leGVjdXRpb24uZmlsdGVyKGl0ZW0gPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbGVjdERlbGVjdEV4ZWN1dGlvbkRJdGVtLmluZGV4T2YoaXRlbSkgPCAwIH0pDQoNCiAgICAgICAgICAgICAgICB0aGlzLmlzZGVsZXRlRXhlY3V0aW9uRCA9IGZhbHNlDQogICAgICAgICAgICAgICAgdGhpcy5zZWxlY3REZWxlY3RFeGVjdXRpb25ESXRlbSA9IFtdDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIG9wZW5FeGVjdXRpb25EKGlkeCkgew0KICAgICAgICAgICAgdGhpcy5zZWxDb250ZXh0TW9kZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0TWFjaGluZUZHDQogICAgICAgICAgICB0aGlzLnNlbFRhcmdldE1vZGUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldE1vZGVEZWNsYXJhdGlvbg0KDQogICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbltpZHhdLmNvbnRleHRNb2RlICE9IG51bGwgKSB7DQogICAgICAgICAgICAgICAgdmFyIGVuZExpbmVDID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZWRjb250ZXh0LScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbltpZHhdLmlkKyctJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQpDQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmVDID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICBlbmRMaW5lQyA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0TWFjaGluZVBhdGgodGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbltpZHhdLmNvbnRleHRNb2RlLCAyKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS5jb250ZXh0TW9kZSA9IHsgbmFtZSA6dGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbltpZHhdLmNvbnRleHRNb2RlLCB1dWlkOiBlbmRMaW5lQyB9DQogICAgICAgICAgICB9IA0KDQogICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbltpZHhdLnRhcmdldE1vZGUgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIHZhciBlbmRMaW5lVCA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2VkdGFyZ2V0LScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbltpZHhdLmlkKyctJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQpDQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmVUID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICBlbmRMaW5lVCA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0TW9kZURlY2xhcmF0aW9uUGF0aCh0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uW2lkeF0udGFyZ2V0TW9kZSwgMSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0udGFyZ2V0TW9kZSA9IHsgbmFtZSA6dGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbltpZHhdLnRhcmdldE1vZGUsIHV1aWQ6IGVuZExpbmVUIH0NCiAgICAgICAgICAgIH0gDQogICAgICAgIH0sDQogICAgICAgIGVkaXRFeGVjdXRpb25EKGlkeCkgew0KICAgICAgICAgICAgdmFyIGVuZGNvbnRleHRNTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2VkY29udGV4dC0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5leGVjdXRpb25baWR4XS5pZCsnLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgaWYgKGVuZGNvbnRleHRNTGluZSAhPSB1bmRlZmluZWQgJiYgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0uY29udGV4dE1vZGUgPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2VkY29udGV4dC0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5leGVjdXRpb25baWR4XS5pZCsnLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkKQ0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5leGVjdXRpb25baWR4XS5jb250ZXh0TW9kZSA9IG51bGwNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoZW5kY29udGV4dE1MaW5lICE9IHVuZGVmaW5lZCAmJiBlbmRjb250ZXh0TUxpbmUgIT0gdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0uY29udGV4dE1vZGUudXVpZCkgew0KICAgICAgICAgICAgICAgIC8v6riw7KG06rq8IOyCreygnO2VtOyVvO2VnOuLpCB2dWV47JeQ7ISc64+EIOyCreygnO2VmOqzoCBtYWludmlld+yXkOyEnOuPhCDsgq3soJztlZjqs6AgDQogICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZWRjb250ZXh0LScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbltpZHhdLmlkKyctJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQpDQogICAgICAgICAgICAgICAgdGhpcy5uZXdMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZWRjb250ZXh0LScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbltpZHhdLmlkKyctJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQudXVpZCsnL2VkdGFibGUnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0uY29udGV4dE1vZGUudXVpZCwgZmFsc2UpDQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbltpZHhdLmNvbnRleHRNb2RlID0gdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0uY29udGV4dE1vZGUubmFtZQ0KICAgICAgICAgICAgfSBlbHNlIGlmKGVuZGNvbnRleHRNTGluZSA9PSB1bmRlZmluZWQgJiYgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0uY29udGV4dE1vZGUgIT0gbnVsbCAmJiB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS5jb250ZXh0TW9kZS51dWlkICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICB0aGlzLm5ld0xpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9lZGNvbnRleHQtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uW2lkeF0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC51dWlkKycvZWR0YWJsZScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS5jb250ZXh0TW9kZS51dWlkLCBmYWxzZSkNCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uW2lkeF0uY29udGV4dE1vZGUgPSB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS5jb250ZXh0TW9kZS5uYW1lDQogICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLmNvbnRleHRNb2RlIT0gbnVsbCAmJiBlbmRjb250ZXh0TUxpbmUgPT0gdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0uY29udGV4dE1vZGUudXVpZCAmJiB0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uW2lkeF0uY29udGV4dE1vZGUgIT0gdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0uY29udGV4dE1vZGUubmFtZSkgew0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5leGVjdXRpb25baWR4XS5jb250ZXh0TW9kZSA9IHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLmNvbnRleHRNb2RlLm5hbWUNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgdmFyIGVuZHRhcmdldE1MaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZWR0YXJnZXQtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uW2lkeF0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgIGlmIChlbmR0YXJnZXRNTGluZSAhPSB1bmRlZmluZWQgJiYgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0udGFyZ2V0TW9kZSA9PSBudWxsKSB7DQogICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZWR0YXJnZXQtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uW2lkeF0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uW2lkeF0udGFyZ2V0TW9kZSA9IG51bGwNCiAgICAgICAgICAgIH0gZWxzZSBpZiAoZW5kdGFyZ2V0TUxpbmUgIT0gdW5kZWZpbmVkICYmIGVuZHRhcmdldE1MaW5lICE9IHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLnRhcmdldE1vZGUudXVpZCkgew0KICAgICAgICAgICAgICAgIC8v6riw7KG06rq8IOyCreygnO2VtOyVvO2VnOuLpCB2dWV47JeQ7ISc64+EIOyCreygnO2VmOqzoCBtYWludmlld+yXkOyEnOuPhCDsgq3soJztlZjqs6AgDQogICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZWR0YXJnZXQtJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uW2lkeF0uaWQrJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCkNCiAgICAgICAgICAgICAgICB0aGlzLm5ld0xpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9lZHRhcmdldC0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5leGVjdXRpb25baWR4XS5pZCsnLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQudXVpZCsnL2VkdGFibGUnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0udGFyZ2V0TW9kZS51dWlkLCBmYWxzZSkNCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uW2lkeF0udGFyZ2V0TW9kZSA9IHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLnRhcmdldE1vZGUubmFtZQ0KICAgICAgICAgICAgfSBlbHNlIGlmIChlbmR0YXJnZXRNTGluZSA9PSB1bmRlZmluZWQgJiYgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0udGFyZ2V0TW9kZSAhPSB1bmRlZmluZWQgJiYgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0udGFyZ2V0TW9kZS51dWlkICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICB0aGlzLm5ld0xpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9lZHRhcmdldC0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5leGVjdXRpb25baWR4XS5pZCsnLScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnV1aWQrJy9lZHRhYmxlJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsIHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLnRhcmdldE1vZGUudXVpZCwgZmFsc2UpDQogICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbltpZHhdLnRhcmdldE1vZGUgPSB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS50YXJnZXRNb2RlLm5hbWUNCiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0udGFyZ2V0TW9kZSAhPSBudWxsICYmIGVuZHRhcmdldE1MaW5lID09IHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLnRhcmdldE1vZGUudXVpZCAmJiB0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uW2lkeF0udGFyZ2V0TW9kZSAhPSB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS50YXJnZXRNb2RlLm5hbWUpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uW2lkeF0udGFyZ2V0TW9kZSA9IHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLnRhcmdldE1vZGUubmFtZQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICB2YXIgZW5kTGluZUNvbnRleHQgPSBudWxsLCBlbmRMaW5lVGFyZ2V0ID0gbnVsbA0KICAgICAgICAgICAgaWYgKHRoaXMucmVmRXhlY3V0aW9uID09IHRoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5leGVjdXRpb25baWR4XS5pZCkgew0KICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlT3BlbkVsZW1lbnQoKQ0KICAgICAgICAgICAgICAgIGlmICggdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0udGFyZ2V0TW9kZSAhPSB1bmRlZmluZWQgJiYgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0udGFyZ2V0TW9kZS51dWlkICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgZW5kTGluZVRhcmdldCA9IHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLnRhcmdldE1vZGUudXVpZA0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXRNb2RlRGVjbGFyYXRpb25Hcm91cCcsIHtjb21wbzoiZHJhZyIsIHV1aWQ6IHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLnRhcmdldE1vZGUudXVpZCwgdG9wOiB0aGlzLmVsZW1lbnQudG9wICsgMjAwLCBsZWZ0OiB0aGlzLmVsZW1lbnQubGVmdCArIHRoaXMuJHNldFBvc2l0aW9uTGVmdH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldHpJbmRleFZpc2libGUnLCB7cGFyZW50OmNvbnN0YW50Lk1vZGVEZWNsYXJhdGlvbkdyb3VwX3N0ciwgdXVpZDogdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0udGFyZ2V0TW9kZS51dWlkLCBpc1Zpc2libGU6IHRydWUsIGNvbXBvOiAndmlzaWJsZScsIHN0YXJ0VVVJRDogdGhpcy5lbGVtZW50LnV1aWR9ICkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRWaWV3TGluZUluZm8nLCB7c3RhcnQ6dGhpcy5lbGVtZW50LnV1aWQrJy9kdGFibGUnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOmVuZExpbmVUYXJnZXQsIGlzY2lyY2xlOmZhbHNlLCByZWZOdW06NSwgaWR4SUQ6IHRoaXMucmVmRXhlY3V0aW9uLCB0YWJJRDogdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFifSkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ0VsZW1lbnQtb3BlbicsIGZhbHNlLCB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS50YXJnZXRNb2RlLnV1aWQpDQogICAgICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnbmV3LWxpbmUnLCB0aGlzLmVsZW1lbnQudXVpZCsnL2VkdGFibGUnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgZW5kTGluZVRhcmdldCkNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLmNvbnRleHRNb2RlICE9IG51bGwgJiYgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0uY29udGV4dE1vZGUudXVpZCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIGVuZExpbmVDb250ZXh0ID0gdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0uY29udGV4dE1vZGUudXVpZA0KICAgICAgICAgICAgICAgICAgICB2YXIgdG9wID0gMjAwDQogICAgICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lVGFyZ2V0ICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRvcCA9IDYwMA0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnZWRpdE1hY2hpbmUnLCB7Y29tcG86ImRyYWciLCB1dWlkOiB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS5jb250ZXh0TW9kZS51dWlkLCB0b3A6IHRoaXMuZWxlbWVudC50b3AgKyB0b3AsIGxlZnQ6IHRoaXMuZWxlbWVudC5sZWZ0ICsgdGhpcy4kc2V0UG9zaXRpb25MZWZ0fSApDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0ekluZGV4VmlzaWJsZScsIHtwYXJlbnQ6Y29uc3RhbnQuTWFjaGluZV9zdHIsIHV1aWQ6IHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLmNvbnRleHRNb2RlLnV1aWQsIGlzVmlzaWJsZTogdHJ1ZSwgY29tcG86ICd2aXNpYmxlJywgc3RhcnRVVUlEOiB0aGlzLmVsZW1lbnQudXVpZH0gKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFZpZXdMaW5lSW5mbycsIHtzdGFydDp0aGlzLmVsZW1lbnQudXVpZCsnL2VkdGFibGUnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOmVuZExpbmVDb250ZXh0LCBpc2NpcmNsZTpmYWxzZSwgcmVmTnVtOjUsIGlkeElEOiB0aGlzLnJlZkV4ZWN1dGlvbiwgdGFiSUQ6IHRoaXMuZGVwZW5kZW50U3RhcnR1cFRhYn0pDQogICAgICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdFbGVtZW50LW9wZW4nLCBmYWxzZSwgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0uY29udGV4dE1vZGUudXVpZCkNCiAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCduZXctbGluZScsIHRoaXMuZWxlbWVudC51dWlkKycvZWR0YWJsZScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLCBlbmRMaW5lQ29udGV4dCkNCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lQ29udGV4dCAhPSBudWxsICYmIGVuZExpbmVUYXJnZXQgPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ0VsZW1lbnQtb3BlbicsIHRydWUsIGVuZExpbmVDb250ZXh0KQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVuZExpbmVDb250ZXh0ID09IG51bGwgJiYgZW5kTGluZVRhcmdldCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgnRWxlbWVudC1vcGVuJywgdHJ1ZSwgZW5kTGluZVRhcmdldCkNCiAgICAgICAgICAgICAgICAgICAgfSANCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLmNhbmNlbEV4ZWN1dGlvbkQoKQ0KICAgICAgICB9LA0KICAgICAgICBjYW5jZWxFeGVjdXRpb25EKCkgew0KICAgICAgICAgICAgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0gPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRJdGVtKQ0KICAgICAgICAgICAgdGhpcy5zZXRhY3RpdmVVVUlEKCkNCiAgICAgICAgfSwNCiAgICAgICAgbmV3T3BlbkRlcGVuZGVudCgpIHsNCiAgICAgICAgICAgIHRoaXMuc2VsQ29udGV4dE1vZGUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldE1hY2hpbmVGRw0KICAgICAgICAgICAgdGhpcy5zZWxUYXJnZXRNb2RlID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRNb2RlRGVjbGFyYXRpb24NCiAgICAgICAgICAgIHRoaXMuY2xpY2tPdGhlckZpZWxkcygpDQogICAgICAgIH0sDQogICAgICAgIGFkZEV4ZWN1dGlvbkQoKSB7DQogICAgICAgICAgICB0aGlzLmNsaWNrT3RoZXJGaWVsZHMoKQ0KICAgICAgICAgICAgbGV0IHJlcyA9IHRydWUsIG4gPSAwDQogICAgICAgICAgICB3aGlsZSAocmVzKSB7DQogICAgICAgICAgICAgICAgbisrDQogICAgICAgICAgICAgICAgcmVzID0gdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmV4ZWN1dGlvbi5zb21lKGl0ZW0gPT4gaXRlbS5pZCA9PT0gbikNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLmlkID0gbg0KDQogICAgICAgICAgICB2YXIgZW5kTGluZUNvbnRleHQgPSBudWxsLCBlbmRMaW5lVGFyZ2V0ID0gbnVsbCANCiAgICAgICAgICAgIGlmKCB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS50YXJnZXRNb2RlICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICBlbmRMaW5lVGFyZ2V0ID0gdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0udGFyZ2V0TW9kZS51dWlkDQogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdlZGl0TW9kZURlY2xhcmF0aW9uR3JvdXAnLCB7Y29tcG86ImRyYWciLCB1dWlkOiB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS50YXJnZXRNb2RlLnV1aWQsIHRvcDogdGhpcy5lbGVtZW50LnRvcCArIDIwMCwgbGVmdDogdGhpcy5lbGVtZW50LmxlZnQgKyB0aGlzLiRzZXRQb3NpdGlvbkxlZnR9ICkNCiAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldHpJbmRleFZpc2libGUnLCB7cGFyZW50OmNvbnN0YW50Lk1vZGVEZWNsYXJhdGlvbkdyb3VwX3N0ciwgdXVpZDogdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0udGFyZ2V0TW9kZS51dWlkLCBpc1Zpc2libGU6IHRydWUsIGNvbXBvOiAndmlzaWJsZScsIHN0YXJ0VVVJRDogdGhpcy5lbGVtZW50LnV1aWR9ICkNCiAgICAgICAgICAgICAgICB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS50YXJnZXRNb2RlID0gdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0udGFyZ2V0TW9kZS5uYW1lDQogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRWaWV3TGluZUluZm8nLCB7c3RhcnQ6dGhpcy5lbGVtZW50LnV1aWQrJy9lZHRhYmxlJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsIGVuZDplbmRMaW5lVGFyZ2V0LCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzY2lyY2xlOmZhbHNlLCByZWZOdW06NSwgaWR4SUQ6IHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLmlkLCB0YWJJRDogdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFifSkNCiAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdFbGVtZW50LW9wZW4nLCBmYWxzZSwgZW5kTGluZVRhcmdldCkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXdMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZWR0YXJnZXQtJytuKyctJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsIHRoaXMuZWxlbWVudC51dWlkKycvZWR0YWJsZScrdGhpcy5lbGVtZW50LmRlcGVuZGVudFt0aGlzLmRlcGVuZGVudFN0YXJ0dXBUYWJdLmlkLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZVRhcmdldCwgdHJ1ZSkNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYoIHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLmNvbnRleHRNb2RlICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICB2YXIgdG9wID0gMjAwDQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmVUYXJnZXQgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICB0b3AgPSA2MDANCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZW5kTGluZUNvbnRleHQgPSB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS5jb250ZXh0TW9kZS51dWlkDQogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdlZGl0TWFjaGluZScsIHtjb21wbzoiZHJhZyIsIHV1aWQ6IHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLmNvbnRleHRNb2RlLnV1aWQsIHRvcDogdGhpcy5lbGVtZW50LnRvcCArIHRvcCwgbGVmdDogdGhpcy5lbGVtZW50LmxlZnQgKyB0aGlzLiRzZXRQb3NpdGlvbkxlZnR9ICkNCiAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldHpJbmRleFZpc2libGUnLCB7cGFyZW50OmNvbnN0YW50Lk1hY2hpbmVfc3RyLCB1dWlkOiB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS5jb250ZXh0TW9kZS51dWlkLCBpc1Zpc2libGU6IHRydWUsIGNvbXBvOiAndmlzaWJsZScsIHN0YXJ0VVVJRDogdGhpcy5lbGVtZW50LnV1aWR9ICkNCiAgICAgICAgICAgICAgICB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS5jb250ZXh0TW9kZSA9IHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLmNvbnRleHRNb2RlLm5hbWUNCiAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFZpZXdMaW5lSW5mbycsIHtzdGFydDp0aGlzLmVsZW1lbnQudXVpZCsnL2VkdGFibGUnK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgZW5kOmVuZExpbmVDb250ZXh0LCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzY2lyY2xlOmZhbHNlLCByZWZOdW06NSwgaWR4SUQ6IHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLmlkLCB0YWJJRDogdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFifSkNCiAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdFbGVtZW50LW9wZW4nLCBmYWxzZSwgZW5kTGluZUNvbnRleHQpDQogICAgICAgICAgICAgICAgICAgIHRoaXMubmV3TGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2VkY29udGV4dC0nK24rJy0nK3RoaXMuZWxlbWVudC5kZXBlbmRlbnRbdGhpcy5kZXBlbmRlbnRTdGFydHVwVGFiXS5pZCwgdGhpcy5lbGVtZW50LnV1aWQrJy9lZHRhYmxlJyt0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uaWQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lQ29udGV4dCwgdHJ1ZSkNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmVDb250ZXh0ICE9IG51bGwgJiYgZW5kTGluZVRhcmdldCA9PSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdFbGVtZW50LW9wZW4nLCB0cnVlLCBlbmRMaW5lQ29udGV4dCkNCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVuZExpbmVDb250ZXh0ID09IG51bGwgJiYgZW5kTGluZVRhcmdldCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCdFbGVtZW50LW9wZW4nLCB0cnVlLCBlbmRMaW5lVGFyZ2V0KQ0KICAgICAgICAgICAgICAgIH0gDQogICAgICAgICAgICB9KQ0KICAgICAgICAgICAgY29uc3QgYWRkT2JqID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0pDQogICAgICAgICAgICB0aGlzLmVsZW1lbnQuZGVwZW5kZW50W3RoaXMuZGVwZW5kZW50U3RhcnR1cFRhYl0uZXhlY3V0aW9uLnB1c2goYWRkT2JqKQ0KICAgICAgICAgICAgdGhpcy5yZWZFeGVjdXRpb24gPSBuDQogICAgICAgICAgICB0aGlzLmNhbmNlbEV4ZWN1dGlvbkQoKQ0KICAgICAgICB9LA0KICAgICAgICBzZXRDTVNlbGVjdCgpIHsNCiAgICAgICAgICAgIGlmICh0aGlzLmlzRWRpdGluZ0NNID09IHRydWUpIHsgDQogICAgICAgICAgICAgICAgaWYgKHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLmNvbnRleHRNb2RlICE9IG51bGwgJiYgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0uY29udGV4dE1vZGUudXVpZCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0RGV0YWlsVmlldycsIHt1dWlkOiB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS5jb250ZXh0TW9kZS51dWlkLCBlbGVtZW50OiBjb25zdGFudC5NYWNoaW5lX3N0cn0gKQ0KICAgICAgICAgICAgICAgICAgICAvLyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS5jb250ZXh0TW9kZS51dWlkK3RoaXMubG9jYXRpb24pLnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0JyB9KQ0KICAgICAgICAgICAgICAgICAgICAvLyBFdmVudEJ1cy4kZW1pdCgnYWN0aXZlLWVsZW1lbnQnLCB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS5jb250ZXh0TW9kZS51dWlkKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB0aGlzLnNldENvbnRleHRNTGlzdCgpDQogICAgICAgICAgICAgICAgdGhpcy5pc0VkaXRpbmdDTSA9IGZhbHNlDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMuaXNFZGl0aW5nQ00gPSB0cnVlDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGNsZWFyQ01SZWYoKSB7DQogICAgICAgICAgICB0aGlzLmlzRWRpdGluZ0NNID0gdHJ1ZQ0KICAgICAgICAgICAgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0uY29udGV4dE1vZGUgPSBudWxsDQogICAgICAgIH0sDQogICAgICAgIHNldFRNU2VsZWN0KCkgew0KICAgICAgICAgICAgaWYgKHRoaXMuaXNFZGl0aW5nVE0gPT0gdHJ1ZSkgeyANCiAgICAgICAgICAgICAgICBpZiAodGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0udGFyZ2V0TW9kZSAhPSBudWxsICYmIHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLnRhcmdldE1vZGUudXVpZCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0RGV0YWlsVmlldycsIHt1dWlkOiB0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS50YXJnZXRNb2RlLnV1aWQsIGVsZW1lbnQ6IGNvbnN0YW50Lk1vZGVEZWNsYXJhdGlvbkdyb3VwX3N0cn0gKQ0KICAgICAgICAgICAgICAgICAgICAvLyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmVkaXRFeGVjdXRpb25ESXRlbS50YXJnZXRNb2RlLnV1aWQrdGhpcy5sb2NhdGlvbikuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnc3RhcnQnIH0pDQogICAgICAgICAgICAgICAgICAgIC8vIEV2ZW50QnVzLiRlbWl0KCdhY3RpdmUtZWxlbWVudCcsIHRoaXMuZWRpdEV4ZWN1dGlvbkRJdGVtLnRhcmdldE1vZGUudXVpZCkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5zZXRUYXJnZXRNTGlzdCgpDQogICAgICAgICAgICAgICAgdGhpcy5pc0VkaXRpbmdUTSA9IGZhbHNlDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMuaXNFZGl0aW5nVE0gPSB0cnVlDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGNsZWFyVE1SZWYoKSB7DQogICAgICAgICAgICB0aGlzLmlzRWRpdGluZ1RNID0gdHJ1ZQ0KICAgICAgICAgICAgdGhpcy5lZGl0RXhlY3V0aW9uREl0ZW0udGFyZ2V0TW9kZSA9IG51bGwNCiAgICAgICAgfSwNCg0KICAgICAgICBzZXRhY3RpdmVVVUlEKCkgew0KICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXR1dWlkJywge3V1aWQ6IHRoaXMuZWxlbWVudC51dWlkfSApDQogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2VkaXRQcm9jZXNzJywge2NvbXBvOiJ6IiwgdXVpZDp0aGlzLmVsZW1lbnQudXVpZCwgemluZGV4OjEwfSApDQogICAgICAgIH0sDQogICAgICAgIGRlbGV0ZUxpbmUoZmluZUxpbmUpIHsNCiAgICAgICAgICAgIHZhciBsaW5lbnVtID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRjb25uZWN0TGluZU51bShmaW5lTGluZSkNCiAgICAgICAgICAgIGlmIChsaW5lbnVtICE9IC0xKSB7DQogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdkZWxldENvbm5lY3Rpb25saW5lJywge3N0YXJ0bnVtOiBsaW5lbnVtfSApDQogICAgICAgICAgICAgICAgdGhpcy5kZWxldGVPcGVuRWxlbWVudCgpDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGRlbGV0ZU9wZW5FbGVtZW50KCkgew0KICAgICAgICAgICAgLy9FdmVudEJ1cy4kZW1pdCgnZGVsZXRlLWxpbmUnLCB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldERlbGV0ZU9wZW5FbGVtZW50KHRoaXMuZWxlbWVudC51dWlkKSkNCiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnZGVsZXRlT3BlbkVsZW1udCcsIHt1dWlkOiB0aGlzLmVsZW1lbnQudXVpZCwgaXNEZWxldGVBbGw6IGZhbHNlLCBzdGFydFVVSUQ6IHRoaXMuZWxlbWVudC51dWlkfSApDQogICAgICAgIH0sDQogICAgICAgIG5ld0xpbmUoc3RhcnRMaW5lLCBkcmF3TGluZSwgZW5kTGluZSwgaXNWaWV3KSB7DQogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldENvbm5lY3Rpb25saW5lJywge3N0YXJ0OiBzdGFydExpbmUsIGVuZDogZW5kTGluZX0gKQ0KICAgICAgICAgICAgaWYgKGlzVmlldykgew0KICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCduZXctbGluZScsIGRyYXdMaW5lLCBlbmRMaW5lKQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIHZpZXdBUlhNTCgpIHsNCiAgICAgICAgICAgIHRoaXMuZWRpdEFSWE1MLm5hbWUgPSB0aGlzLmVsZW1lbnQubmFtZQ0KICAgICAgICAgICAgdGhpcy5lZGl0QVJYTUwubG9nTGV2ZWwgPSB0aGlzLmVsZW1lbnQubG9nTGV2ZWwNCiAgICAgICAgICAgIHRoaXMuZWRpdEFSWE1MLmxvZ1BhdGggPSB0aGlzLmVsZW1lbnQubG9nUGF0aA0KICAgICAgICAgICAgdGhpcy5lZGl0QVJYTUwubG9nUHJvRGVzYyA9IHRoaXMuZWxlbWVudC5sb2dQcm9EZXNjDQogICAgICAgICAgICB0aGlzLmVkaXRBUlhNTC5sb2dQcm9JRCA9IHRoaXMuZWxlbWVudC5sb2dQcm9JRA0KICAgICAgICAgICAgdGhpcy5lZGl0QVJYTUwucmVzdGFydCA9IHRoaXMuZWxlbWVudC5yZXN0YXJ0DQogICAgICAgICAgICB0aGlzLmVkaXRBUlhNTC5wcmVNYXBwaW5nID0gdGhpcy5lbGVtZW50LnByZU1hcHBpbmcNCiAgICAgICAgICAgIHRoaXMuZWRpdEFSWE1MLnByb2Rlc2lnbiA9IHRoaXMuZWxlbWVudC5wcm9kZXNpZ24NCiAgICAgICAgICAgIHRoaXMuZWRpdEFSWE1MLmRldGVybWluID0gdGhpcy5lbGVtZW50LmRldGVybWluDQogICAgICAgICAgICB0aGlzLmVkaXRBUlhNTC5leGVjdXQgPSB0aGlzLmVsZW1lbnQuZXhlY3V0DQogICAgICAgICAgICB0aGlzLmVkaXRBUlhNTC5tYWNoaW5uYW1lID0gdGhpcy5lbGVtZW50Lm1hY2hpbm5hbWUNCiAgICAgICAgICAgIHRoaXMuZWRpdEFSWE1MLm1hY2hpbmV0eXBlID0gdGhpcy5lbGVtZW50Lm1hY2hpbmV0eXBlDQogICAgICAgICAgICB0aGlzLmVkaXRBUlhNTC5sb2dNb2RlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmVsZW1lbnQubG9nTW9kZSkpDQogICAgICAgICAgICB0aGlzLmVkaXRBUlhNTC5kZXBlbmRlbnQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuZWxlbWVudC5kZXBlbmRlbnQpKQ0KICAgICAgICAgICAgdGhpcy5kaWFsb2dUZXh0PSB0cnVlDQogICAgICAgIH0sDQogICAgICAgIHNhdmVBUlhNTCgpIHsNCiAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQubmFtZSAhPSB0aGlzLmVkaXRBUlhNTC5uYW1lKSB7DQogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdlZGl0UHJvY2VzcycsIHtjb21wbzoiTmFtZSIsIHV1aWQ6dGhpcy5lbGVtZW50LnV1aWQsIG5hbWU6dGhpcy5lZGl0QVJYTUwubmFtZX0gKQ0KICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnY2hhbmdlUGF0aEVsZW1lbnQnLCB7dXVpZDp0aGlzLmVsZW1lbnQudXVpZCwgcGF0aDogdGhpcy5lbGVtZW50LnBhdGgsIG5hbWU6IHRoaXMuZWRpdEFSWE1MLm5hbWV9ICkNCiAgICAgICAgICAgICAgICBpZiAodGhpcy5lZGl0QVJYTUwubmFtZSAhPSAnJykgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2lzaW50b0Vycm9yTGlzdCcsIHt1dWlkOnRoaXMuZWxlbWVudC51dWlkLCBuYW1lOnRoaXMuZWRpdEFSWE1MLm5hbWUsIHBhdGg6dGhpcy5lbGVtZW50LnBhdGh9KQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5uYW1lID0gdGhpcy5lZGl0QVJYTUwubmFtZQ0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LmxvZ1BhdGggPSB0aGlzLmVkaXRBUlhNTC5sb2dQYXRoDQogICAgICAgICAgICB0aGlzLmVsZW1lbnQubG9nUHJvRGVzYyA9IHRoaXMuZWRpdEFSWE1MLmxvZ1Byb0Rlc2MNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5sb2dQcm9JRCA9IHRoaXMuZWRpdEFSWE1MLmxvZ1Byb0lEDQogICAgICAgICAgICB0aGlzLmVsZW1lbnQucmVzdGFydCA9IHRoaXMuZWRpdEFSWE1MLnJlc3RhcnQNCiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5wcmVNYXBwaW5nID0gdGhpcy5lZGl0QVJYTUwucHJlTWFwcGluZw0KICAgICAgICAgICAgdGhpcy5lbGVtZW50Lm1hY2hpbm5hbWUgPSB0aGlzLmVkaXRBUlhNTC5tYWNoaW5uYW1lDQoNCiAgICAgICAgICAgIHRoaXMuZWRpdEFSWE1MLmxvZ0xldmVsID0gdGhpcy5lZGl0QVJYTUwubG9nTGV2ZWwudG9VcHBlckNhc2UoKQ0KICAgICAgICAgICAgaWYodGhpcy5lZGl0QVJYTUwubG9nTGV2ZWwgPT0gJ0ZBVEFMJyB8fCB0aGlzLmVkaXRBUlhNTC5sb2dMZXZlbCA9PSAnRVJST1InIHx8IHRoaXMuZWRpdEFSWE1MLmxvZ0xldmVsID09ICdXQVJOJyANCiAgICAgICAgICAgICAgIHx8IHRoaXMuZWRpdEFSWE1MLmxvZ0xldmVsID09ICdJTkZPJyB8fCB0aGlzLmVkaXRBUlhNTC5sb2dMZXZlbCA9PSAnREVCVUcnIHx8IHRoaXMuZWRpdEFSWE1MLmxvZ0xldmVsID09ICdWRVJCT1NFJykgew0KICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5sb2dMZXZlbCA9IHRoaXMuZWRpdEFSWE1MLmxvZ0xldmVsDQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhciBlbmRMaW5lID0gbnVsbCwgY2hhbmdFbmRMaW5lID0gbnVsbA0KDQogICAgICAgICAgICBpZiAodGhpcy5lZGl0QVJYTUwucHJvZGVzaWduICE9IHRoaXMuZWxlbWVudC5wcm9kZXNpZ24pIHsNCiAgICAgICAgICAgICAgICBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3Byb2Rlc2lnbicpDQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3Nwcm9kZXNpZ24nKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBjaGFuZ0VuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldFByb2Nlc3NEZXNpZ25QYXRoKHRoaXMuZWRpdEFSWE1MLnByb2Rlc2lnbikNCiAgICAgICAgICAgICAgICBpZiAoY2hhbmdFbmRMaW5lICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXdMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3Byb2Rlc2lnbicsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3Byb2Rlc2lnbicsIGNoYW5nRW5kTGluZSwgZmFsc2UpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LnByb2Rlc2lnbiA9IHRoaXMuZWRpdEFSWE1MLnByb2Rlc2lnbg0KDQogICAgICAgICAgICBpZiAodGhpcy5lZGl0QVJYTUwuZGV0ZXJtaW4gIT0gdGhpcy5lbGVtZW50LmRldGVybWluKSB7DQogICAgICAgICAgICAgICAgZW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NkZXRlcm1pbicpDQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NkZXRlcm1pbicpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGNoYW5nRW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0RGV0ZXJtaW5pc3RpY0NsaWVudFBhdGgodGhpcy5lZGl0QVJYTUwuZGV0ZXJtaW4pDQogICAgICAgICAgICAgICAgaWYgKGNoYW5nRW5kTGluZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubmV3TGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NkZXRlcm1pbicsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc2RldGVybWluJywgY2hhbmdFbmRMaW5lLCBmYWxzZSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLmVsZW1lbnQuZGV0ZXJtaW4gPSB0aGlzLmVkaXRBUlhNTC5kZXRlcm1pbg0KDQogICAgICAgICAgICBpZiAodGhpcy5lZGl0QVJYTUwuZXhlY3V0ICE9IHRoaXMuZWxlbWVudC5leGVjdXQpIHsNCiAgICAgICAgICAgICAgICBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc2V4ZWN1dCcpDQogICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NleGVjdXQnKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBjaGFuZ0VuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldEV4ZWN1dGFibGVQYXRoKHRoaXMuZWRpdEFSWE1MLmV4ZWN1dCkNCiAgICAgICAgICAgICAgICBpZiAoY2hhbmdFbmRMaW5lICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXdMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc2V4ZWN1dCcsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc2V4ZWN1dCcsIGNoYW5nRW5kTGluZSwgZmFsc2UpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LmV4ZWN1dCA9IHRoaXMuZWRpdEFSWE1MLmV4ZWN1dA0KDQogICAgICAgICAgICBpZiAodGhpcy5lZGl0QVJYTUwubWFjaGluZXR5cGUgIT0gdGhpcy5lbGVtZW50Lm1hY2hpbmV0eXBlKSB7DQogICAgICAgICAgICAgICAgZW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3Ntb2RlZGVjbGFyJykNCiAgICAgICAgICAgICAgICBpZiAoZW5kTGluZSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc21vZGVkZWNsYXInKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBjaGFuZ0VuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldE1vZGVEZWNsYXJhdGlvblBhdGgodGhpcy5lZGl0QVJYTUwubWFjaGluZXR5cGUsIDApDQogICAgICAgICAgICAgICAgaWYgKGNoYW5nRW5kTGluZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubmV3TGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3Ntb2RlZGVjbGFyJywgdGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzbW9kZWRlY2xhcicsIGNoYW5nRW5kTGluZSwgZmFsc2UpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5lbGVtZW50Lm1hY2hpbmV0eXBlID0gdGhpcy5lZGl0QVJYTUwubWFjaGluZXR5cGUNCg0KICAgICAgICAgICAgaWYgKHRoaXMuZWRpdEFSWE1MLmRlcGVuZGVudC5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgdGhpcy5lZGl0QVJYTUwuZGVwZW5kZW50LmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGl0ZW0uZXhlY3V0aW9uLmZvckVhY2goZGF0YSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNIYXZlVGFibGVDID0gZmFsc2UsIGlzSGF2ZVRhYmxlVCA9IGZhbHNlDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuZGVwZW5kZW50LmZvckVhY2goZGVwID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXAuZXhlY3V0aW9uLmZvckVhY2goZXhlID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4ZS5pZCA9PSBkYXRhLmlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhlLmNvbnRleHRNb2RlID09IGRhdGEuY29udGV4dE1vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0hhdmVUYWJsZUMgPSB0cnVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhlLnRhcmdldE1vZGUgPT0gZGF0YS50YXJnZXRNb2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNIYXZlVGFibGVUID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzSGF2ZVRhYmxlQykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9lZGNvbnRleHQtJytkYXRhLmlkKyctJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9lZGNvbnRleHQtJytkYXRhLmlkKyctJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ0VuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldE1hY2hpbmVQYXRoKGRhdGEuY29udGV4dE1vZGUsIDIpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoYW5nRW5kTGluZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmV3TGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2VkY29udGV4dC0nK2RhdGEuaWQrJy0nK2l0ZW0uaWQsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc1N0YXJ1cEMnLCBjaGFuZ0VuZExpbmUsIGZhbHNlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNIYXZlVGFibGVUKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2VkdGFyZ2V0LScrZGF0YS5pZCsnLScraXRlbS5pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW5kTGluZSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZWR0YXJnZXQtJytkYXRhLmlkKyctJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ0VuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldE1vZGVEZWNsYXJhdGlvblBhdGgoZGF0YS50YXJnZXRNb2RlLCAxKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGFuZ0VuZExpbmUgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5ld0xpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9lZHRhcmdldC0nK2RhdGEuaWQrJy0nK2l0ZW0uaWQsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc1N0YXJ1cEMnLCBjaGFuZ0VuZExpbmUsIGZhbHNlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgaXRlbS5mdW5jdGlvbkl0ZW0uZm9yRWFjaChkYXRhID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc0hhdmVUYWJsZUMgPSBmYWxzZSwgaXNIYXZlVGFibGVUID0gZmFsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5kZXBlbmRlbnQuZm9yRWFjaChkZXAgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlcC5mdW5jdGlvbkl0ZW0uZm9yRWFjaChmdW4gPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZnVuLmlkID09IGRhdGEuaWQgKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZnVuLmNvbnRleHRNb2RlID09IGRhdGEuY29udGV4dE1vZGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0hhdmVUYWJsZUMgPSB0cnVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZnVuLnRhcmdldE1vZGUgPT0gZGF0YS50YXJnZXRNb2RlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNIYXZlVGFibGVUID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzSGF2ZVRhYmxlQykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ2NvbnRleHQtJytkYXRhLmlkKyctJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ2NvbnRleHQtJytkYXRhLmlkKyctJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ0VuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldE1hY2hpbmVQYXRoKGRhdGEuY29udGV4dE1vZGUsIDIpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoYW5nRW5kTGluZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmV3TGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2ZnY29udGV4dC0nK2RhdGEuaWQrJy0nK2l0ZW0uaWQsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc1N0YXJ1cEMnLCBjaGFuZ0VuZExpbmUsIGZhbHNlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNIYXZlVGFibGVUKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2ZndGFyZ2V0LScrZGF0YS5pZCsnLScraXRlbS5pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW5kTGluZSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZmd0YXJnZXQtJytkYXRhLmlkKyctJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ0VuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldE1vZGVEZWNsYXJhdGlvblBhdGgoZGF0YS50YXJnZXRNb2RlLCAxKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGFuZ0VuZExpbmUgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5ld0xpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ3RhcmdldC0nK2RhdGEuaWQrJy0nK2l0ZW0uaWQsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc1N0YXJ1cEMnLCBjaGFuZ0VuZExpbmUsIGZhbHNlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgdmFyIGlzSGF2ZVRhYmxlUiA9IGZhbHNlLCBpc0hhdmVUYWJsZVMgPSBmYWxzZQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuZGVwZW5kZW50LmZvckVhY2goZWxlID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGUuaWQgPT0gaXRlbS5pZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGUucmVzb3VyY2VSZWYgPT0gaXRlbS5yZXNvdXJjZVJlZikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0hhdmVUYWJsZVIgPSB0cnVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGUuc3RhcnR1cENvbmZpZ1JlZiA9PSBpdGVtLnN0YXJ0dXBDb25maWdSZWYpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNIYXZlVGFibGVTID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0hhdmVUYWJsZVIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzcmVzb3JjZS0nK2l0ZW0uaWQpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW5kTGluZSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzcmVzb3JjZS0nK2l0ZW0uaWQpDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ0VuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldE1hY2hpbmVQYXRoKGl0ZW0ucmVzb3VyY2VSZWYsIDEpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hhbmdFbmRMaW5lICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5ld0xpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzcmVzb3JjZS0nK2l0ZW0uaWQsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc1N0YXJ1cEMnLCBjaGFuZ0VuZExpbmUsIGZhbHNlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICghaXNIYXZlVGFibGVTKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3N0YXJ0dXAtJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3N0YXJ0dXAtJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdFbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRTdGFydHVwQ29uZmlnUGF0aChpdGVtLnN0YXJ0dXBDb25maWdSZWYpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hhbmdFbmRMaW5lICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5ld0xpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzc3RhcnR1cC0nK2l0ZW0uaWQsIHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc1N0YXJ1cEMnLCBjaGFuZ0VuZExpbmUsIGZhbHNlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuZGVwZW5kZW50LmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgICAgICAgICAgICAgIHZhciBpc0hhdmVUYWJsZSA9IGZhbHNlDQogICAgICAgICAgICAgICAgICAgIGl0ZW0uZXhlY3V0aW9uLmZvckVhY2goZGF0YSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBpc0hhdmVUYWJsZSA9IGZhbHNlDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVkaXRBUlhNTC5kZXBlbmRlbnQuZm9yRWFjaChlZGl0ID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl0LmV4ZWN1dGlvbi5mb3JFYWNoKGVkaXRBID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXRBLmlkID09IGRhdGEuaWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzSGF2ZVRhYmxlID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzSGF2ZVRhYmxlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuY29udGV4dE1vZGUgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZWRjb250ZXh0LScrZGF0YS5pZCsnLScraXRlbS5pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9lZGNvbnRleHQtJytkYXRhLmlkKyctJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnRhcmdldE1vZGUgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZWR0YXJnZXQtJytkYXRhLmlkKyctJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW5kTGluZSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2VkdGFyZ2V0LScrZGF0YS5pZCsnLScraXRlbS5pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgaXRlbS5mdW5jdGlvbkl0ZW0uZm9yRWFjaChkYXRhID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlzSGF2ZVRhYmxlID0gZmFsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdEFSWE1MLmRlcGVuZGVudC5mb3JFYWNoKGVkaXQgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXQuZnVuY3Rpb25JdGVtLmZvckVhY2goZWRpdEUgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWRpdEUuaWQgPT0gZGF0YS5pZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNIYXZlVGFibGUgPSB0cnVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNIYXZlVGFibGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5jb250ZXh0TW9kZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ2NvbnRleHQtJytkYXRhLmlkKyctJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW5kTGluZSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2ZnY29udGV4dC0nK2RhdGEuaWQrJy0nK2l0ZW0uaWQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEudGFyZ2V0TW9kZSAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ3RhcmdldC0nK2RhdGEuaWQrJy0nK2l0ZW0uaWQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZmd0YXJnZXQtJytkYXRhLmlkKyctJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICBpc0hhdmVUYWJsZSA9IGZhbHNlDQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdEFSWE1MLmRlcGVuZGVudC5mb3JFYWNoKGVkaXQgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVkaXQuaWQgPT0gaXRlbS5pZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzSGF2ZVRhYmxlID0gdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICBpZiAoIWlzSGF2ZVRhYmxlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5yZXNvdXJjZVJlZiAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NyZXNvcmNlLScraXRlbS5pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW5kTGluZSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3Jlc29yY2UtJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLnN0YXJ0dXBDb25maWdSZWYgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzc3RhcnR1cC0nK2l0ZW0uaWQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NzdGFydHVwLScraXRlbS5pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50LmRlcGVuZGVudC5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5kZXBlbmRlbnQuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uZXhlY3V0aW9uLmZvckVhY2goZGF0YSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuY29udGV4dE1vZGUgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZWRjb250ZXh0LScrZGF0YS5pZCsnLScraXRlbS5pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9lZGNvbnRleHQtJytkYXRhLmlkKyctJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnRhcmdldE1vZGUgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZWR0YXJnZXQtJytkYXRhLmlkKyctJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW5kTGluZSAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2VkdGFyZ2V0LScrZGF0YS5pZCsnLScraXRlbS5pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgICAgICBpdGVtLmZ1bmN0aW9uSXRlbS5mb3JFYWNoKGRhdGEgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmNvbnRleHRNb2RlICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2ZnY29udGV4dC0nK2RhdGEuaWQrJy0nK2l0ZW0uaWQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxldGVMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvZmdjb250ZXh0LScrZGF0YS5pZCsnLScraXRlbS5pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS50YXJnZXRNb2RlICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kTGluZSA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2hhbmdlRW5kTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL2ZndGFyZ2V0LScrZGF0YS5pZCsnLScraXRlbS5pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9mZ3RhcmdldC0nK2RhdGEuaWQrJy0nK2l0ZW0uaWQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0ucmVzb3VyY2VSZWYgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZExpbmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENoYW5nZUVuZExpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzcmVzb3JjZS0nK2l0ZW0uaWQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuZExpbmUgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlTGluZSh0aGlzLmVsZW1lbnQudXVpZCsnL3Byb2Nlc3NyZXNvcmNlLScraXRlbS5pZCkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5zdGFydHVwQ29uZmlnUmVmICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRMaW5lID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDaGFuZ2VFbmRMaW5lKHRoaXMuZWxlbWVudC51dWlkKycvcHJvY2Vzc3N0YXJ0dXAtJytpdGVtLmlkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbmRMaW5lICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUxpbmUodGhpcy5lbGVtZW50LnV1aWQrJy9wcm9jZXNzc3RhcnR1cC0nK2l0ZW0uaWQpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5kZXBlbmRlbnQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuZWRpdEFSWE1MLmRlcGVuZGVudCkpDQoNCiAgICAgICAgICAgIGZvcihsZXQgaT0wOyBpPHRoaXMuZWRpdEFSWE1MLmxvZ01vZGUubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICBpZiAoISh0aGlzLmVkaXRBUlhNTC5sb2dNb2RlW2ldID09ICdDT05TT0xFJyB8fCB0aGlzLmVkaXRBUlhNTC5sb2dNb2RlW2ldID09ICdGSUxFJyB8fA0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVkaXRBUlhNTC5sb2dNb2RlW2ldID09ICdORVRXT1JLJykpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdEFSWE1MLmxvZ01vZGUuc3BsaWNlKGkgLDEpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5lbGVtZW50LmxvZ01vZGUgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuZWRpdEFSWE1MLmxvZ01vZGUpKQ0KICAgICAgICAgICAgdGhpcy5jYW5jZWxBUlhNTCgpDQogICAgICAgIH0sDQogICAgICAgIGNhbmNlbEFSWE1MKCkgew0KICAgICAgICAgICAgdGhpcy5lZGl0QVJYTUwgPSB7bmFtZTonJywgbG9nTGV2ZWw6IG51bGwsIGxvZ1BhdGg6ICcnLCBsb2dQcm9EZXNjOiAnJywgbG9nUHJvSUQ6ICcnLCByZXN0YXJ0OiAnJywgcHJlTWFwcGluZzogbnVsbCwgbG9nTW9kZTogW10sDQogICAgICAgICAgICAgICAgICAgIHByb2Rlc2lnbjogbnVsbCwgZGV0ZXJtaW46IG51bGwsIGV4ZWN1dDogbnVsbCwgbWFjaGlubmFtZTogJycsIG1hY2hpbmV0eXBlOiBudWxsLCBkZXBlbmRlbnQ6IFtdfQ0KICAgICAgICAgICAgdGhpcy5lZGl0VGV4dERlcGVuZGVudCA9IHtleGVjdXRpb246IFtdLCBmdW5jdGlvbkl0ZW06IFtdLCByZXNvdXJjZVJlZjogbnVsbCwgc3RhcnR1cENvbmZpZ1JlZjogbnVsbCwgaWQ6ICcnfQ0KICAgICAgICAgICAgdGhpcy5lZGl0VGV4dEV4ZWN1dGlvbiA9IHtjb250ZXh0TW9kZTogbnVsbCwgdGFyZ2V0TW9kZTogbnVsbCwgaWQ6ICcnfQ0KICAgICAgICAgICAgdGhpcy5lZGl0VGV4dEZ1bmN0aW9uID0ge2NvbnRleHRNb2RlOiBudWxsLCB0YXJnZXRNb2RlOiBudWxsLCBpZDogJyd9DQogICAgICAgICAgICB0aGlzLmRpYWxvZ1RleHQgPSBmYWxzZQ0KICAgICAgICB9LA0KICAgICAgICBuZXdUZXh0RGVwZW5kZW50KCkgew0KICAgICAgICAgICAgdGhpcy5lZGl0VGV4dERlcGVuZGVudCA9IHtleGVjdXRpb246IFtdLCBmdW5jdGlvbkl0ZW06IFtdLCByZXNvdXJjZVJlZjogbnVsbCwgc3RhcnR1cENvbmZpZ1JlZjogbnVsbCwgaWQ6ICcnfQ0KICAgICAgICAgICAgbGV0IHJlcyA9IHRydWUsIG4gPSAwDQogICAgICAgICAgICB3aGlsZSAocmVzKSB7DQogICAgICAgICAgICAgICAgIG4rKzsNCiAgICAgICAgICAgICAgICByZXMgPSB0aGlzLmVkaXRBUlhNTC5kZXBlbmRlbnQuc29tZShpdGVtID0+IGl0ZW0uaWQgPT09IG4pDQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLmVkaXRUZXh0RGVwZW5kZW50LmlkID0gbg0KDQogICAgICAgICAgICBjb25zdCBhZGRPYmogPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmVkaXRUZXh0RGVwZW5kZW50KQ0KICAgICAgICAgICAgdGhpcy5lZGl0QVJYTUwuZGVwZW5kZW50LnB1c2goYWRkT2JqKTsNCiAgICAgICAgfSwNCiAgICAgICAgZGVsZXRUZXh0RGVwZW5kZW50KGlkeCkgew0KICAgICAgICAgICAgdGhpcy5lZGl0QVJYTUwuZGVwZW5kZW50LnNwbGljZShpZHgsMSkNCiAgICAgICAgfSwNCiAgICAgICAgbmV3VGV4dEV4ZWN1dGlvbihpZHhEKSB7DQogICAgICAgICAgICB0aGlzLmVkaXRUZXh0RXhlY3V0aW9uID0ge2NvbnRleHRNb2RlOiBudWxsLCB0YXJnZXRNb2RlOiBudWxsLCBpZDogJyd9DQogICAgICAgICAgICBsZXQgcmVzID0gdHJ1ZSwgbiA9IDANCiAgICAgICAgICAgIHdoaWxlIChyZXMpIHsNCiAgICAgICAgICAgICAgICBuKysNCiAgICAgICAgICAgICAgICByZXMgPSB0aGlzLmVkaXRBUlhNTC5kZXBlbmRlbnRbaWR4RF0uZXhlY3V0aW9uLnNvbWUoaXRlbSA9PiBpdGVtLmlkID09PSBuKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy5lZGl0VGV4dEV4ZWN1dGlvbi5pZCA9IG4NCg0KICAgICAgICAgICAgY29uc3QgYWRkT2JqID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5lZGl0VGV4dEV4ZWN1dGlvbikNCiAgICAgICAgICAgIHRoaXMuZWRpdEFSWE1MLmRlcGVuZGVudFtpZHhEXS5leGVjdXRpb24ucHVzaChhZGRPYmopOw0KICAgICAgICB9LA0KICAgICAgICBkZWxldFRleHRFeGVjdXRpb24oaWR4LCBpZHhEKSB7DQogICAgICAgICAgICB0aGlzLmVkaXRBUlhNTC5kZXBlbmRlbnRbaWR4RF0uZXhlY3V0aW9uLnNwbGljZShpZHgsMSkNCiAgICAgICAgfSwNCiAgICAgICAgbmV3VGV4dEZ1bmN0aW9uKGlkeEQpIHsNCiAgICAgICAgICAgIHRoaXMuZWRpdFRleHRGdW5jdGlvbiA9IHtjb250ZXh0TW9kZTogbnVsbCwgdGFyZ2V0TW9kZTogbnVsbCwgaWQ6ICcnfQ0KICAgICAgICAgICAgbGV0IHJlcyA9IHRydWUsIG4gPSAwDQogICAgICAgICAgICB3aGlsZSAocmVzKSB7DQogICAgICAgICAgICAgICAgbisrOw0KICAgICAgICAgICAgICAgIHJlcyA9IHRoaXMuZWRpdEFSWE1MLmRlcGVuZGVudFtpZHhEXS5mdW5jdGlvbkl0ZW0uc29tZShpdGVtID0+IGl0ZW0uaWQgPT09IG4pDQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLmVkaXRUZXh0RnVuY3Rpb24uaWQgPSBuDQoNCiAgICAgICAgICAgIGNvbnN0IGFkZE9iaiA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZWRpdFRleHRGdW5jdGlvbikNCiAgICAgICAgICAgIHRoaXMuZWRpdEFSWE1MLmRlcGVuZGVudFtpZHhEXS5mdW5jdGlvbkl0ZW0ucHVzaChhZGRPYmopOw0KICAgICAgICB9LA0KICAgICAgICBkZWxldFRleHRGdW5jdGlvbihpZHgsIGlkeEQpIHsNCiAgICAgICAgICAgIHRoaXMuZWRpdEFSWE1MLmRlcGVuZGVudFtpZHhEXS5mdW5jdGlvbkl0ZW0uc3BsaWNlKGlkeCwxKQ0KICAgICAgICB9LA0KICAgICAgICBuZXdUZXh0TG9nTW9kZSgpIHsNCiAgICAgICAgICAgIGlmICh0aGlzLmVkaXRBUlhNTC5sb2dNb2RlLmxlbmd0aCA8IDMpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmVkaXRBUlhNTC5sb2dNb2RlLnB1c2goJycpDQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGRlbGV0VGV4dExvZ01vZGUoaWR4KSB7DQogICAgICAgICAgICB0aGlzLmVkaXRBUlhNTC5sb2dNb2RlLnNwbGljZShpZHgsMSkNCiAgICAgICAgfQ0KDQogICAgfSwNCn0NCg=="},{"version":3,"sources":["Process.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+kBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"Process.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div :id=\"element.uuid\">\r\n        <v-container>\r\n            <v-tooltip bottom color=\"success\" :disabled=\"isTooltip\" z-index=\"10\">\r\n                <template v-slot:activator=\"{ on, attrs }\">\r\n                    <v-card outlined :color=\"minimaptoolbar ? null : colorToolbar\" v-bind=\"attrs\" v-on=\"on\">\r\n                        <v-toolbar v-if=\"!isDatailView\" :color=colorToolbar dark hide-on-scroll height=\"30px\" class=\"drag-handle\">\r\n                            <v-hover v-if=\"minimaptoolbar\" v-slot=\"{ hover }\">\r\n                                <v-btn icon @click=\"showProcess\">\r\n                                    <v-icon>{{ iselementOpenClose ? (hover? 'mdi-chevron-double-left' :'mdi-chevron-double-right') : (hover? 'mdi-chevron-double-right' :'mdi-chevron-double-left')}}</v-icon>\r\n                                </v-btn>\r\n                            </v-hover>\r\n                            <v-btn v-if=\"minimaptoolbar\" icon @click.stop=\"dialogPath=true\">\r\n                                <v-icon> mdi-routes</v-icon>\r\n                            </v-btn>\r\n                            <dialogPathSetting v-model=\"dialogPath\" :path=\"element.path\" @submit=\"submitDialog\"/>\r\n                            <v-toolbar-title>Process</v-toolbar-title>\r\n                            <v-spacer></v-spacer>\r\n                            <v-btn v-if=\"minimaptoolbar\" icon @click=\"viewARXML\">\r\n                                <v-icon> mdi-format-text</v-icon>\r\n                            </v-btn>\r\n                        </v-toolbar>\r\n                        <v-toolbar v-else hide-on-scroll dense flat>\r\n                            <v-toolbar-title>Process</v-toolbar-title>\r\n                        </v-toolbar>\r\n                        <v-card-text v-show=\"iselementOpenClose\">\r\n                            <v-text-field v-model=\"element.name\" :label=\"'name  <'+element.path +'>'\" :rules=\"rules.name\" placeholder=\"String\" style=\"height: 45px;\" class=\"lable-placeholer-color\"\r\n                                        @input='inputProcessName' outlined dense  @click=\"clickOtherFields()\"></v-text-field>\r\n                            <v-row style=\"height: 45px\">\r\n                                <v-col cols=\"10\">\r\n                                    <v-text-field v-model=\"element.prodesign\" readonly @click=\"setProcessDesignSelect()\" :style=\"refDesign ? 'height: 43px;border:solid red 2px' : ''\" \r\n                                                 clearable @click:clear='clearProcessDesign()' label=\"Design Reference\" outlined dense class=\"lable-placeholer-color\"></v-text-field>\r\n                                </v-col>\r\n                                <v-col cols=\"2\">\r\n                                    <v-menu>\r\n                                        <template v-slot:activator=\"{ on, attrs }\">\r\n                                            <v-btn color=\"deep-purple accent-4\" :id=\"element.uuid+'/processprodesign'\" dark icon v-bind=\"attrs\" v-on=\"on\" @click=\"setProcessDesignList()\">\r\n                                                <v-icon>mdi-menu-down-outline</v-icon>\r\n                                            </v-btn>\r\n                                        </template>\r\n                                        <v-list>\r\n                                            <v-list-item v-for=\"(item, i) in selProcessDesign\" :key=\"i\" link @click=\"setProcessDesign(item)\">\r\n                                                <v-list-item-title>{{ item.name }}</v-list-item-title>\r\n                                            </v-list-item>\r\n                                            <v-btn outlined color=\"indigo\" dense text small block @click=\"newProcessDesign\" >\r\n                                                <v-icon >mdi-plus</v-icon>New Item\r\n                                            </v-btn>\r\n                                        </v-list>\r\n                                    </v-menu>\r\n                                </v-col>\r\n                            </v-row>\r\n                            <v-row style=\"height: 45px\">\r\n                                <v-col cols=\"10\">\r\n                                    <v-text-field v-model=\"element.determin\" readonly @click=\"setDeterminSelect()\" :style=\"refDeterministric ? 'height: 43px;border:solid red 2px' : ''\" \r\n                                                 clearable @click:clear='clearDetermin()' label=\"Deterministric Client Reference\" outlined dense class=\"lable-placeholer-color\"></v-text-field>\r\n                                </v-col>\r\n                                <v-col cols=\"2\">\r\n                                    <v-menu>\r\n                                        <template v-slot:activator=\"{ on, attrs }\">\r\n                                            <v-btn color=\"deep-purple accent-4\" :id=\"element.uuid+'/processdetermin'\" dark icon v-bind=\"attrs\" v-on=\"on\" @click=\"setDeterminList()\">\r\n                                                <v-icon>mdi-menu-down-outline</v-icon>\r\n                                            </v-btn>\r\n                                        </template>\r\n                                        <v-list>\r\n                                            <v-list-item v-for=\"(item, i) in selDeterministic\" :key=\"i\" link @click=\"setDeterministicClient(item)\">\r\n                                                <v-list-item-title>{{ item.name }}</v-list-item-title>\r\n                                            </v-list-item>\r\n                                            <v-btn outlined color=\"indigo\" dense text small block @click=\"newDeterministicClient\" >\r\n                                                <v-icon >mdi-plus</v-icon>New Item\r\n                                            </v-btn>\r\n                                        </v-list>\r\n                                    </v-menu>\r\n                                </v-col>\r\n                            </v-row>\r\n                            <v-row style=\"height: 70px\">\r\n                                <v-col cols=\"10\">\r\n                                    <v-text-field v-model=\"element.execut\" readonly @click=\"setExecutableSelect()\" :style=\"refExecutable ? 'height: 43px;border:solid red 2px' : ''\" \r\n                                                 clearable @click:clear='clearExecutable()' label=\"Executable Reference\" outlined dense class=\"lable-placeholer-color\"></v-text-field>\r\n                                </v-col>\r\n                                <v-col cols=\"2\">\r\n                                    <v-menu>\r\n                                        <template v-slot:activator=\"{ on, attrs }\">\r\n                                            <v-btn color=\"deep-purple accent-4\" :id=\"element.uuid+'/processexecut'\" dark icon v-bind=\"attrs\" v-on=\"on\" @click=\"setExecutableList()\">\r\n                                                <v-icon>mdi-menu-down-outline</v-icon>\r\n                                            </v-btn>\r\n                                        </template>\r\n                                        <v-list>\r\n                                            <v-list-item v-for=\"(item, i) in selExecutable\" :key=\"i\" link @click=\"setExecutable(item)\">\r\n                                                <v-list-item-title>{{ item.name }}</v-list-item-title>\r\n                                            </v-list-item>\r\n                                            <v-btn outlined color=\"indigo\" dense text small block @click=\"newExecutable\" >\r\n                                                <v-icon >mdi-plus</v-icon>New Item\r\n                                            </v-btn>\r\n                                        </v-list>\r\n                                    </v-menu>\r\n                                </v-col>\r\n                            </v-row>\r\n                            <v-select v-model=\"element.logLevel\" :items=\"logLevel\" label=\"Log Trace Default log Level\" @click=\"[clickOtherFields(),setactiveUUID()]\" @click:clear=\"clickOtherFields()\" clearable outlined dense return-object style=\"height: 45px;\" class=\"lable-placeholer-color\"></v-select>\r\n                            <v-text-field v-model=\"element.logPath\" label=\"Log Trace File Path\" @click=\"clickOtherFields()\" placeholder=\"String\" style=\"height: 45px;\" class=\"lable-placeholer-color\" outlined dense></v-text-field>\r\n                            <v-select v-model=\"element.logMode\" :items=\"logMode\" label=\"Log Trace log Mode\" chips @click=\"[clickOtherFields(),setactiveUUID()]\" @click:clear=\"clickOtherFields()\" style=\"height: 70px;\" outlined multiple class=\"lable-placeholer-color\"></v-select>\r\n                            <v-text-field v-model=\"element.logProDesc\" label=\"Log Trace Process Desc\" @click=\"clickOtherFields()\" placeholder=\"String\" style=\"height: 45px;\" class=\"lable-placeholer-color\" outlined dense></v-text-field>\r\n                            <v-text-field v-model=\"element.logProID\" label=\"Log Trace Process ID\" @click=\"clickOtherFields()\" placeholder=\"String\" style=\"height: 45px;\" class=\"lable-placeholer-color\" outlined dense></v-text-field>\r\n                            <v-text-field v-model=\"element.restart\" label=\"Number Of Restart Attempts\" @click=\"clickOtherFields()\" placeholder=\"Int\" style=\"height: 25px;\" class=\"lable-placeholer-color\" outlined dense></v-text-field>\r\n                            <v-checkbox v-model=\"element.preMapping\" label=\"Pre Mapping\" value=\"element.preMapping\" :indeterminate=\"element.preMapping==null? true:false\" true-value=\"true\" false-value=\"false\" style=\"height: 35px;\"></v-checkbox>\r\n                            <v-card outlined class=\"mx-auto\">\r\n                                <div class=\"subtitle-2\" style=\"height:20px\">\r\n                                    <v-hover v-slot=\"{ hover }\">\r\n                                        <v-btn text @click=\"showStateMachine\" x-small color=\"indigo\">\r\n                                            <v-icon>{{ isStateMachineOpenClose? (hover? 'mdi-chevron-double-left' :'mdi-chevron-double-right') : (hover? 'mdi-chevron-double-right' :'mdi-chevron-double-left')}}</v-icon>\r\n                                        </v-btn>\r\n                                    </v-hover>\r\n                                    Process State Machine\r\n                                </div>\r\n                                <v-card-text v-show=\"isStateMachineOpenClose\">\r\n                                    <v-text-field v-model=\"element.machinname\" label=\"name\" :rules=\"rules.name\" @click=\"clickOtherFields()\" placeholder=\"String\" style=\"height: 45px;\" class=\"lable-placeholer-color\" outlined dense></v-text-field>\r\n                                    <v-row style=\"height: 70px\">\r\n                                        <v-col cols=\"10\">\r\n                                            <v-text-field v-model=\"element.machinetype\" readonly @click=\"setModeDeclarationSelect()\" :style=\"refType ? 'height: 43px;border:solid red 2px' : ''\" \r\n                                                         clearable @click:clear='clearModeDeclaration()' label=\"Type TReference\" outlined dense class=\"lable-placeholer-color\"></v-text-field>\r\n                                        </v-col>\r\n                                        <v-col cols=\"2\">\r\n                                            <v-menu>\r\n                                                <template v-slot:activator=\"{ on, attrs }\">\r\n                                                    <v-btn color=\"deep-purple accent-4\" :id=\"element.uuid+'/processmodedeclar'\" dark icon v-bind=\"attrs\" v-on=\"on\" @click=\"setModeDeclarationList()\">\r\n                                                        <v-icon>mdi-menu-down-outline</v-icon>\r\n                                                    </v-btn>\r\n                                                </template>\r\n                                                <v-list>\r\n                                                    <v-list-item v-for=\"(item, i) in selModeDeclaration\" :key=\"i\" link @click=\"setModeDeclaration(item)\">\r\n                                                        <v-list-item-title>{{ item.name }}</v-list-item-title>\r\n                                                    </v-list-item>\r\n                                                    <v-btn outlined color=\"indigo\" dense text small block @click=\"newModeDeclarationGroup\" >\r\n                                                        <v-icon >mdi-plus</v-icon>New Item\r\n                                                    </v-btn>\r\n                                                </v-list>\r\n                                            </v-menu>\r\n                                        </v-col>\r\n                                    </v-row>\r\n                                </v-card-text>\r\n                            </v-card>\r\n                            <v-card outlined class=\"mx-auto\">\r\n                                <div class=\"subtitle-2\" style=\"height:20px\" :id=\"element.uuid+'/processStarupC'\">\r\n                                    <v-hover v-slot=\"{ hover }\">\r\n                                        <v-btn text @click=\"showDependentStartup\" x-small color=\"indigo\">\r\n                                            <v-icon>{{ isDependentStartupOpenClose? (hover? 'mdi-chevron-double-left' :'mdi-chevron-double-right') : (hover? 'mdi-chevron-double-right' :'mdi-chevron-double-left')}}</v-icon>\r\n                                        </v-btn>\r\n                                    </v-hover>\r\n                                    State Dependent Startup Config\r\n                                    <v-btn v-if=\"isDependentStartupOpenClose\" @click=\"addDependentStartup\" text x-small color=\"indigo\">\r\n                                        <v-icon>mdi-plus</v-icon>\r\n                                    </v-btn>\r\n                                </div>\r\n                                <v-tabs v-model='dependentStartupTab' v-show=\"isDependentStartupOpenClose\" show-arrows @change=\"changeDependentStartupTab()\">\r\n                                    <v-tab v-for=\"(tab, idx) in element.dependent\" :key=\"idx\" @click=\"clickDependentStartuptab()\"> \r\n                                        {{idx}}\r\n                                        <v-btn text x-small @click=\"deleteDependentStartup(idx)\"><v-icon x-small>mdi-close</v-icon></v-btn></v-tab>\r\n                                </v-tabs>\r\n                                <v-tabs-items v-model=\"dependentStartupTab\" v-show=\"isDependentStartupOpenClose\">\r\n                                    <v-tab-item v-for=\"(tab, idx) in element.dependent\" :key=\"idx\">\r\n                                        <v-card flat>\r\n                                            <v-card-text>\r\n                                                <v-card outlined class=\"mx-auto\">\r\n                                                    <div class=\"subtitle-2\" style=\"height:20px\" :id=\"element.uuid+'/edtable'+tab.id\">\r\n                                                        <v-hover v-slot=\"{ hover }\">\r\n                                                            <v-btn text @click=\"showExecutionD\" x-small color=\"indigo\">\r\n                                                                <v-icon>{{ isExecutionDOpenClose? (hover? 'mdi-chevron-double-left' :'mdi-chevron-double-right') : (hover? 'mdi-chevron-double-right' :'mdi-chevron-double-left')}}</v-icon>\r\n                                                            </v-btn>\r\n                                                        </v-hover>\r\n                                                        Execution Dependencys\r\n                                                        <v-btn  v-if=\"isExecutionDOpenClose\" @click=\"isCheckExecutionD\" text x-small color=\"indigo\">\r\n                                                            <v-icon>mdi-check</v-icon>\r\n                                                        </v-btn>\r\n                                                        <v-btn  v-if=\"isdeleteExecutionD && isExecutionDOpenClose\" @click=\"deleteExecutionD\" text x-small color=\"indigo\">\r\n                                                            <v-icon>mdi-minus</v-icon>\r\n                                                        </v-btn>\r\n                                                    </div>\r\n                                                    <v-card-text v-show=\"isExecutionDOpenClose\">\r\n                                                        <v-data-table v-model=\"selectDelectExecutionDItem\" :headers=\"headerFunctionG\" :items=\"tab.execution\" :items-per-page='$setNumTableList'\r\n                                                                :show-select=\"isdeleteExecutionD\" item-key=\"id\" height=\"140px\" dense hide-default-footer >\r\n                                                            <template v-slot:item.data-table-select=\"{ isSelected, select }\">\r\n                                                                <v-simple-checkbox color=\"green\" :value=\"isSelected\" :ripple=\"false\" @input=\"select($event)\"></v-simple-checkbox>\r\n                                                            </template>\r\n                                                            <template v-if=\"!isdeleteExecutionD\" v-slot:body=\"{ items, headers }\">\r\n                                                                <tbody>\r\n                                                                    <tr v-for=\"(item,num) in items\" :key=\"num\" >\r\n                                                                        <td v-for=\"(header,key) in headers\" :key=\"key\">\r\n                                                                            <v-icon v-if=\"header.value == 'refView'\" class=\"refView-tableItem\" :color=\"refExecution === item.id ? 'red' : null \" @click=\"rowExecutionClick(num)\">mdi-pencil</v-icon>\r\n                                                                            <v-edit-dialog v-if=\"header.value != 'refView'\" persistent @open=\"openExecutionD(num)\" @cancel=\"cancelExecutionD\" @save=\"editExecutionD(num)\" large >\r\n                                                                                {{item[header.value]}}\r\n                                                                                <template v-slot:input>\r\n                                                                                    <br> <!--v-autocomplete 여기에서 item의 uuid가 같을경우 item-text='name' item-value=\"uuid\"로 해주면 uuid값이 같기 때문에 item의 list가 다 나오지 않는다 name으로 바꿔야지만 list가 잘나옴 -->\r\n                                                                                    <v-autocomplete v-model='editExecutionDItem.contextMode' label='Context Mode Declaration Group Prototype Ref' :items='selContextMode' item-text='name' item-value=\"name\" class=\"lable-placeholer-color\"\r\n                                                                                            return-object :readonly=\"!isEditingCM\" @click=\"setCMSelect()\" @blur=\"isEditingCM=true\" \r\n                                                                                            clearable @click:clear='clearCMRef'>\r\n                                                                                    </v-autocomplete>\r\n                                                                                    <v-autocomplete v-model='editExecutionDItem.targetMode' label='Target Mode Declaration Ref' :items='selTargetMode' item-text='name' item-value=\"name\" class=\"lable-placeholer-color\"\r\n                                                                                            return-object :readonly=\"!isEditingTM\"  @click=\"setTMSelect()\" @blur=\"isEditingTM=true\" \r\n                                                                                            clearable @click:clear='clearTMRef'>\r\n                                                                                    </v-autocomplete>\r\n                                                                                </template>\r\n                                                                            </v-edit-dialog>\r\n                                                                        </td>\r\n                                                                    </tr>\r\n                                                                    <tr>\r\n                                                                        <th colspan=\"3\">\r\n                                                                            <v-edit-dialog  large persistent @open=\"newOpenDependent()\" @cancel=\"cancelExecutionD\" @save=\"addExecutionD()\"> \r\n                                                                                <v-btn outlined color=\"indigo\" dense text small block width=\"270px\" >\r\n                                                                                    <v-icon >mdi-plus</v-icon>New Item\r\n                                                                                </v-btn>\r\n                                                                                <template v-slot:input>\r\n                                                                                    <br>\r\n                                                                                    <v-autocomplete v-model='editExecutionDItem.contextMode' label='Context Mode Declaration Group Prototype Ref' :items='selContextMode' item-text='name' item-value=\"name\" class=\"lable-placeholer-color\"\r\n                                                                                            return-object :readonly=\"!isEditingCM\" @click=\"setCMSelect()\" @blur=\"isEditingCM=true\" \r\n                                                                                            clearable @click:clear='clearCMRef'>\r\n                                                                                    </v-autocomplete>\r\n                                                                                    <v-autocomplete v-model='editExecutionDItem.targetMode' label='Target Mode Declaration Ref' :items='selTargetMode' item-text='name' item-value=\"name\" class=\"lable-placeholer-color\"\r\n                                                                                            return-object :readonly=\"!isEditingTM\"  @click=\"setTMSelect()\" @blur=\"isEditingTM=true\" \r\n                                                                                            clearable @click:clear='clearTMRef'>\r\n                                                                                    </v-autocomplete>\r\n                                                                                </template>\r\n                                                                            </v-edit-dialog>\r\n                                                                        </th>\r\n                                                                    </tr>\r\n                                                                </tbody>\r\n                                                            </template>\r\n                                                        </v-data-table>\r\n                                                    </v-card-text>\r\n                                                </v-card>\r\n                                                <v-card outlined class=\"mx-auto\">\r\n                                                    <div class=\"subtitle-2\" style=\"height:20px\" :id=\"element.uuid+'/fgtable'+tab.id\">\r\n                                                        <v-hover v-slot=\"{ hover }\">\r\n                                                            <v-btn text @click=\"showFunctionG\" x-small color=\"indigo\">\r\n                                                                <v-icon>{{ isFunctionGOpenClose? (hover? 'mdi-chevron-double-left' :'mdi-chevron-double-right') : (hover? 'mdi-chevron-double-right' :'mdi-chevron-double-left')}}</v-icon>\r\n                                                            </v-btn>\r\n                                                        </v-hover>\r\n                                                        Function Group State\r\n                                                        <v-btn  v-if=\"isFunctionGOpenClose\" @click=\"isCheckFunctionG\" text x-small color=\"indigo\">\r\n                                                            <v-icon>mdi-check</v-icon>\r\n                                                        </v-btn>\r\n                                                        <v-btn  v-if=\"isdeleteFunctionG && isFunctionGOpenClose\" @click=\"deleteFunctionG\" text x-small color=\"indigo\">\r\n                                                            <v-icon>mdi-minus</v-icon>\r\n                                                        </v-btn>\r\n                                                    </div>\r\n                                                    <v-card-text v-show=\"isFunctionGOpenClose\">\r\n                                                        <v-data-table v-model=\"selectDelectFunctionGItem\" :headers=\"headerFunctionG\" :items=\"tab.functionItem\" :items-per-page='$setNumTableList'\r\n                                                                :show-select=\"isdeleteFunctionG\" item-key=\"id\" height=\"140px\" dense hide-default-footer >\r\n                                                            <template v-slot:item.data-table-select=\"{ isSelected, select }\">\r\n                                                                <v-simple-checkbox color=\"green\" :value=\"isSelected\" :ripple=\"false\" @input=\"select($event)\"></v-simple-checkbox>\r\n                                                            </template>\r\n                                                            <template v-if=\"!isdeleteFunctionG\" v-slot:body=\"{ items, headers }\">\r\n                                                                <tbody>\r\n                                                                    <tr v-for=\"(item,num) in items\" :key=\"num\" >\r\n                                                                        <td v-for=\"(header,key) in headers\" :key=\"key\">\r\n                                                                            <v-icon v-if=\"header.value == 'refView'\" class=\"refView-tableItem\" :color=\"refFunction === item.id ? 'red' : null \" @click=\"rowFunctionClick(num)\">mdi-pencil</v-icon>\r\n                                                                            <v-edit-dialog v-if=\"header.value != 'refView'\" persistent @open=\"openFunctionG(num)\" @cancel=\"cancelFunctionG\" @save=\"editFunctionG(num)\" large >\r\n                                                                                {{item[header.value]}}\r\n                                                                                <template v-slot:input>\r\n                                                                                    <br> <!--v-autocomplete 여기에서 item의 uuid가 같을경우 item-text='name' item-value=\"uuid\"로 해주면 uuid값이 같기 때문에 item의 list가 다 나오지 않는다 name으로 바꿔야지만 list가 잘나옴 -->\r\n                                                                                    <v-autocomplete v-model='editFunctionGItem.contextMode' label='Context Mode Declaration Group Prototype Ref' :items='selContextMode' item-text='name' item-value=\"name\" class=\"lable-placeholer-color\"\r\n                                                                                            return-object :readonly=\"!isEditingContextMode\" @click=\"setContextModeSelect()\" @blur=\"isEditingContextMode=true\" \r\n                                                                                            clearable @click:clear='clearContextModeRef'>\r\n                                                                                    </v-autocomplete>\r\n                                                                                    <v-autocomplete v-model='editFunctionGItem.targetMode' label='Target Mode Declaration Ref' :items='selTargetMode' item-text='name' item-value=\"name\" class=\"lable-placeholer-color\"\r\n                                                                                            return-object :readonly=\"!isEditingTargetMode\"  @click=\"setTargetModeSelect()\" @blur=\"isEditingTargetMode=true\" \r\n                                                                                            clearable @click:clear='clearTargetModeRef'>\r\n                                                                                    </v-autocomplete>\r\n                                                                                </template>\r\n                                                                            </v-edit-dialog>\r\n                                                                        </td>\r\n                                                                    </tr>\r\n                                                                    <tr>\r\n                                                                        <th colspan=\"3\">\r\n                                                                            <v-edit-dialog  large persistent @open=\"newOpenDependent()\" @cancel=\"cancelFunctionG\" @save=\"addFunctionG()\"> \r\n                                                                                <v-btn outlined color=\"indigo\" dense text small block width=\"270px\" >\r\n                                                                                    <v-icon >mdi-plus</v-icon>New Item\r\n                                                                                </v-btn>\r\n                                                                                <template v-slot:input>\r\n                                                                                    <br>\r\n                                                                                    <v-autocomplete v-model='editFunctionGItem.contextMode' label='Context Mode Declaration Group Prototype Ref' :items='selContextMode' item-text='name' item-value=\"name\" class=\"lable-placeholer-color\"\r\n                                                                                            return-object :readonly=\"!isEditingContextMode\" @click=\"setContextModeSelect()\" @blur=\"isEditingContextMode=true\" \r\n                                                                                            clearable @click:clear='clearContextModeRef'>\r\n                                                                                    </v-autocomplete>\r\n                                                                                    <v-autocomplete v-model='editFunctionGItem.targetMode' label='Target Mode Declaration Ref' :items='selTargetMode' item-text='name' item-value=\"name\" class=\"lable-placeholer-color\"\r\n                                                                                            return-object :readonly=\"!isEditingTargetMode\"  @click=\"setTargetModeSelect()\" @blur=\"isEditingTargetMode=true\" \r\n                                                                                            clearable @click:clear='clearTargetModeRef'>\r\n                                                                                    </v-autocomplete>\r\n                                                                                </template>\r\n                                                                            </v-edit-dialog>\r\n                                                                        </th>\r\n                                                                    </tr>\r\n                                                                </tbody>\r\n                                                            </template>\r\n                                                        </v-data-table>\r\n                                                    </v-card-text>\r\n                                                </v-card>\r\n                                                <v-row style=\"height: 45px\">\r\n                                                    <v-col cols=\"10\">\r\n                                                        <v-text-field v-model=\"tab.resourceRef\" readonly @click=\"setResourceGSelect(tab)\" :style=\"refResource ? 'height: 43px;border:solid red 2px' : ''\" \r\n                                                                     clearable @click:clear='clearResourceG(tab)' label=\"Resource Group Reference\" outlined dense class=\"lable-placeholer-color\"></v-text-field>\r\n                                                    </v-col>\r\n                                                    <v-col cols=\"2\">\r\n                                                        <v-menu>\r\n                                                            <template v-slot:activator=\"{ on, attrs }\">\r\n                                                                <v-btn color=\"deep-purple accent-4\" :id=\"element.uuid+'/processresorce'+tab.id\" icon v-bind=\"attrs\" v-on=\"on\" @click=\"setResourceGList()\">\r\n                                                                    <v-icon>mdi-menu-down-outline</v-icon>\r\n                                                                </v-btn>\r\n                                                            </template>\r\n                                                            <v-list >\r\n                                                                <v-list-item v-for=\"(item, i) in selResourceG\" :key=\"i\" link @click=\"setResourceG(item, tab)\">\r\n                                                                    <v-list-item-title>{{ item.name }}</v-list-item-title>\r\n                                                                </v-list-item>\r\n                                                                <v-list-item v-if=\"selResourceG.length == 0\">\r\n                                                                    <v-list-item-title>No Data Available</v-list-item-title>\r\n                                                                </v-list-item>\r\n                                                            </v-list>\r\n                                                        </v-menu>\r\n                                                    </v-col>\r\n                                                </v-row>\r\n                                                <v-row style=\"height: 70px\">\r\n                                                    <v-col cols=\"10\">\r\n                                                        <v-text-field v-model=\"tab.startupConfigRef\" readonly @click=\"setStartupCSelect(tab)\" :style=\"refStartupC ? 'height: 43px;border:solid red 2px' : ''\" \r\n                                                                     clearable @click:clear='clearStartupC(tab)' label=\"Startup Config Reference\" outlined dense class=\"lable-placeholer-color\"></v-text-field>\r\n                                                    </v-col>\r\n                                                    <v-col cols=\"2\">\r\n                                                        <v-menu>\r\n                                                            <template v-slot:activator=\"{ on, attrs }\">\r\n                                                                <v-btn color=\"deep-purple accent-4\" :id=\"element.uuid+'/processstartup'+tab.id\" dark icon v-bind=\"attrs\" v-on=\"on\" @click=\"setStartupCList()\">\r\n                                                                    <v-icon>mdi-menu-down-outline</v-icon>\r\n                                                                </v-btn>\r\n                                                            </template>\r\n                                                            <v-list>\r\n                                                                <v-list-item v-for=\"(item, i) in selStartupC\" :key=\"i\" link @click=\"setStartupC(item, tab)\">\r\n                                                                    <v-list-item-title>{{ item.name }}</v-list-item-title>\r\n                                                                </v-list-item>\r\n                                                                <v-btn outlined color=\"indigo\" dense text small block @click=\"newStartupC\" >\r\n                                                                    <v-icon >mdi-plus</v-icon>New Item\r\n                                                                </v-btn>\r\n                                                            </v-list>\r\n                                                        </v-menu>\r\n                                                    </v-col>\r\n                                                </v-row>\r\n                                            </v-card-text>\r\n                                        </v-card>\r\n                                    </v-tab-item>\r\n                                </v-tabs-items>\r\n                            </v-card>\r\n                        </v-card-text>\r\n                        <v-card-text v-show=\"!iselementOpenClose|| !minimaptoolbar\">\r\n                            <v-text-field v-model=\"element.name\" :label=\"'name  <'+element.path +'>'\" :rules=\"rules.name\" placeholder=\"String\" style=\"height: 45px;\" class=\"lable-placeholer-color\"\r\n                                        readonly outlined dense></v-text-field>\r\n                        </v-card-text>\r\n                    </v-card>\r\n                </template>\r\n                <span>{{ element.name }}</span>\r\n            </v-tooltip>\r\n            <v-dialog v-model=\"dialogText\" persistent width=\"800\">\r\n                <v-card >\r\n                    <v-card-title class=\"text-h6 green accent-1\"> Edit Text </v-card-title>\r\n                    <v-card-text>\r\n                        <br>\r\n                        <v-row style=\"height: 30px;\">\r\n                            <label style=\"padding:10px;\">&#60;SHORT-NAME&#62;</label>\r\n                            <v-text-field v-model=\"editARXML.name\" placeholder=\"String\" style=\"height: 15px;\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                            <label style=\"padding:10px;\">&#60;&#47;SHORT-NAME&#62;</label>\r\n                        </v-row>\r\n                        <v-row style=\"height: 30px;\">\r\n                            <label style=\"padding:10px;\">&#60;DESIGN-REF&#62;</label>\r\n                            <v-text-field v-model=\"editARXML.prodesign\" placeholder=\"Path\"  class=\"lable-placeholer-color\" dense></v-text-field>\r\n                            <label style=\"padding:10px;\">&#60;&#47;DESIGN-REF&#62;</label>\r\n                        </v-row>\r\n                        <v-row style=\"height: 30px;\">\r\n                            <label style=\"padding:10px;\">&#60;EXECUTABLE-REF&#62;</label>\r\n                            <v-text-field v-model=\"editARXML.execut\" placeholder=\"Path\" style=\"height: 15px;\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                            <label style=\"padding:10px;\">&#60;&#47;EXECUTABLE-REF&#62;</label>\r\n                        </v-row>\r\n                        <v-row style=\"height: 30px;\">\r\n                            <label style=\"padding:10px;\">&#60;DETERMINISTIC-CLIENT-REF&#62;</label>\r\n                            <v-text-field v-model=\"editARXML.determin\" placeholder=\"Path\" style=\"height: 15px;\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                            <label style=\"padding:10px;\">&#60;&#47;DETERMINISTIC-CLIENT-REF&#62;</label>\r\n                        </v-row>\r\n                        <v-row style=\"height: 30px;\">\r\n                            <label style=\"padding:10px;\">&#60;LOG-TRACE-DEFAULT-LOG-LEVEL&#62;</label>\r\n                            <v-text-field v-model=\"editARXML.logLevel\" placeholder=\"FATAL or ERROR or WARN or INFO or DEBUG or VERBOSE\" style=\"height: 15px;\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                            <label style=\"padding:10px;\">&#60;&#47;LOG-TRACE-DEFAULT-LOG-LEVEL&#62;</label>\r\n                        </v-row>\r\n                        <v-row style=\"height: 25px;\">\r\n                            <label style=\"padding:10px;\">&#60;LOG-TRACE-FILE-PATH&#62;</label>\r\n                            <v-text-field v-model=\"editARXML.logPath\" placeholder=\"String\" style=\"height: 15px;\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                            <label style=\"padding:10px;\">&#60;&#47;LOG-TRACE-FILE-PATH&#62;</label>\r\n                        </v-row>\r\n                        <v-row style=\"height: 50px;\">\r\n                            <label style=\"padding:10px;\">&#60;LOG-TRACE-LOG-MODES&#62;</label>\r\n                            <v-btn style=\"margin: 3px 0px 0px -10px\" @click=\"newTextLogMode()\" icon color=\"teal darken\" x-samll dark>\r\n                                <v-icon dense dark>mdi-plus</v-icon>\r\n                            </v-btn>\r\n                        </v-row>\r\n                        <div class=\"text-editDialog\" style=\"height: 100px;\">\r\n                            <v-row v-for=\"(item, i) in editARXML.logMode\" :key=\"i\" style=\"height: 25px;\">\r\n                                <div>\r\n                                    <br>\r\n                                    <v-row style=\"height: 25px;margin:0px;\">\r\n                                        <v-btn style=\"margin: 15px -20px 0px 20px\" @click=\"deletTextLogMode(i)\" text x-small color=\"indigo\">\r\n                                            <v-icon>mdi-minus</v-icon>\r\n                                        </v-btn>\r\n                                        <label style=\"padding:10px;margin:2px 0px 2px 10px;\">&#60;LOG-TRACE-LOG-MODE&#62;</label>\r\n                                        <v-text-field v-model=\"editARXML.logMode[i]\" style=\"width:280px\" placeholder=\"CONSOLE or FILE or NETWORK\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                                        <label style=\"padding:10px;\">&#60;&#47;LOG-TRACE-LOG-MODE&#62;</label>\r\n                                    </v-row>\r\n                                </div>\r\n                            </v-row>\r\n                        </div> \r\n                        <v-row style=\"height: 30px;\">\r\n                            <label style=\"padding:10px;\">&#60;&#47;LOG-TRACE-LOG-MODES&#62;</label>\r\n                        </v-row>              \r\n                        <v-row style=\"height: 30px;\">\r\n                            <label style=\"padding:10px;\">&#60;LOG-TRACE-PROCESS-DESC&#62;</label>\r\n                            <v-text-field v-model=\"editARXML.logProDesc\" placeholder=\"String\" style=\"height: 15px;\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                            <label style=\"padding:10px;\">&#60;&#47;LOG-TRACE-PROCESS-DESC&#62;</label>\r\n                        </v-row>\r\n                        <v-row style=\"height: 30px;\">\r\n                            <label style=\"padding:10px;\">&#60;LOG-TRACE-PROCESS-ID&#62;</label>\r\n                            <v-text-field v-model=\"editARXML.logProID\" placeholder=\"String\" style=\"height: 15px;\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                            <label style=\"padding:10px;\">&#60;&#47;LOG-TRACE-PROCESS-ID&#62;</label>\r\n                        </v-row>\r\n                        <v-row style=\"height: 30px;\">\r\n                            <label style=\"padding:10px;\">&#60;NUMBER-OF-RESTART-ATTEMPTS&#62;</label>\r\n                            <v-text-field v-model=\"editARXML.restart\" placeholder=\"Int\" style=\"height: 15px;\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                            <label style=\"padding:10px;\">&#60;&#47;NUMBER-OF-RESTART-ATTEMPTS&#62;</label>\r\n                        </v-row>\r\n                        <v-row style=\"height: 30px;\">\r\n                            <label style=\"padding:10px;\">&#60;PRE-MAPPING&#62;</label>\r\n                            <v-text-field v-model=\"editARXML.preMapping\" placeholder=\"true or false\" style=\"height: 15px;\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                            <label style=\"padding:10px;\">&#60;&#47;PRE-MAPPING&#62;</label>\r\n                        </v-row>\r\n                        <v-row style=\"height: 25px;\">\r\n                            <label style=\"padding:10px;\">&#60;PROCESS-STATE-MACHINE&#62;</label>\r\n                        </v-row>\r\n                        <v-row style=\"height: 30px;\">\r\n                            <label style=\"padding:10px;margin-left:10px\">&#60;SHORT-NAME&#62;</label>\r\n                            <v-text-field v-model=\"editARXML.machinname\" placeholder=\"String\" style=\"height: 15px;\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                            <label style=\"padding:10px;\">&#60;&#47;SHORT-NAME&#62;</label>\r\n                        </v-row>\r\n                        <v-row style=\"height: 25px;\">\r\n                            <label style=\"padding:10px;margin-left:10px\">&#60;TYPE-TREF&#62;</label>\r\n                            <v-text-field v-model=\"editARXML.machinetype\" placeholder=\"Path\" style=\"height: 15px;\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                            <label style=\"padding:10px;\">&#60;&#47;TYPE-TREF&#62;</label>\r\n                        </v-row>\r\n                        <v-row style=\"height: 15px;\">\r\n                            <label style=\"padding:10px;\">&#60;&#47;PROCESS-STATE-MACHINE&#62;</label>\r\n                        </v-row>\r\n                        <v-row style=\"height: 50px;\">\r\n                            <label style=\"padding:10px;\">&#60;STATE-DEPENDENT-STARTUP-CONFIGS&#62;</label>\r\n                            <v-btn style=\"margin: 3px 0px 0px -10px\" @click=\"newTextDependent()\" icon color=\"teal darken\" x-samll dark>\r\n                                <v-icon dense dark>mdi-plus</v-icon>\r\n                            </v-btn>\r\n                        </v-row>\r\n                        <div class=\"text-editDialog\" style=\"height: 550px;\">\r\n                            <v-row v-for=\"(item, i) in editARXML.dependent\" :key=\"i\" style=\"height: 520px;\">\r\n                                <div>\r\n                                    <v-row style=\"height: 10px;margin:0px;\">\r\n                                        <v-btn style=\"margin: 15px -20px 0px 20px\" @click=\"deletTextDependent(i)\" text x-small color=\"indigo\">\r\n                                            <v-icon>mdi-minus</v-icon>\r\n                                        </v-btn>\r\n                                        <label style=\"padding:10px;margin:2px 0px 2px 10px;\">&#60;STATE-DEPENDENT-STARTUP-CONFIG&#62;</label>\r\n                                    </v-row>\r\n                                    <v-row style=\"height: 50px;\">\r\n                                        <label style=\"padding:10px;margin-left:90px;\">&#60;EXECUTION-DEPENDENCYS&#62;</label>\r\n                                        <v-btn style=\"margin: 3px 0px 0px -10px\" @click=\"newTextExecution(i)\" icon color=\"teal darken\" x-samll dark>\r\n                                            <v-icon dense dark>mdi-plus</v-icon>\r\n                                        </v-btn>\r\n                                    </v-row>\r\n                                    <div class=\"text-Inner-editDialog\" style=\"height: 180px;\">\r\n                                        <v-row v-for=\"(exe, e) in item.execution\" :key=\"e\" style=\"height: 140px;\">\r\n                                            <div>\r\n                                                <v-row style=\"height: 25px;margin:0px;\">\r\n                                                    <v-btn style=\"margin: 15px -80px 0px 80px\" @click=\"deletTextExecution(e,i)\" text x-small color=\"indigo\">\r\n                                                            <v-icon>mdi-minus</v-icon>\r\n                                                    </v-btn>\r\n                                                    <label style=\"padding:10px;margin:2px 0px 2px 70px;\">&#60;EXECUTION-DEPENDENCY&#62;</label>\r\n                                                </v-row>\r\n                                                <v-row style=\"height: 25px;margin:0px;\">\r\n                                                    <label style=\"padding:10px;margin:2px 0px 2px 130px;\">&#60;PROCESS-STATE-IREF&#62;</label>\r\n                                                </v-row>\r\n                                                <v-row style=\"height: 25px;margin:0px;\">\r\n                                                    <v-col cols=\"6\">\r\n                                                    <label style=\"padding:10px;margin:2px 0px 2px 140px;\">&#60;CONTEXT-MODE-DECLARATION-GROUP-REF&#62;</label>\r\n                                                    </v-col><v-col cols=\"4\">\r\n                                                    <v-text-field v-model=\"exe.contextMode\" placeholder=\"Path\" style=\"margin: -5px 0px 0px 75px\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                                                    </v-col><v-col cols=\"2\">\r\n                                                    <label style=\"padding:10px;\">&#60;&#47;CONTEXT-MODE-DECLARATION-GROUP-PROTOTYPE-REF&#62;</label>\r\n                                                    </v-col>\r\n                                                </v-row>\r\n                                                <v-row style=\"height: 25px;margin:0px;\">\r\n                                                    <v-col cols=\"5\">\r\n                                                    <label style=\"padding:10px;margin:2px 0px 2px 140px;\">&#60;TARGET-MODE-DECLARATION-REF&#62;</label>\r\n                                                    </v-col><v-col cols=\"4\">\r\n                                                    <v-text-field v-model=\"exe.targetMode\" placeholder=\"Path\" style=\"margin: -5px 0px 0px 80px\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                                                    </v-col><v-col cols=\"3\">\r\n                                                    <label style=\"padding:10px;\">&#60;&#47;TARGET-MODE-DECLARATION-REF&#62;</label>\r\n                                                    </v-col>\r\n                                                </v-row>\r\n                                                <v-row style=\"height: 25px;margin:0px;\">\r\n                                                    <label style=\"padding:10px;margin:2px 0px 2px 130px;\">&#60;&#47;PROCESS-STATE-IREF&#62;</label>\r\n                                                </v-row>\r\n                                                <v-row style=\"height: 30px;margin:0px;\">\r\n                                                    <label style=\"padding:10px;margin-left:115px;\">&#60;&#47;EXECUTION-DEPENDENCY&#62;</label>\r\n                                                </v-row>\r\n                                            </div>\r\n                                        </v-row>\r\n                                    </div> \r\n                                    <v-row style=\"height: 15px;\">\r\n                                        <label style=\"padding:10px;margin:2px 0px 2px 90px;\">&#60;&#47;EXECUTION-DEPENDENCYS&#62;</label>\r\n                                    </v-row>\r\n                                    <v-row style=\"height: 50px;\">\r\n                                        <label style=\"padding:10px;margin-left:90px;\">&#60;FUNCTION-GROUP-STATE-IREFS&#62;</label>\r\n                                        <v-btn style=\"margin: 3px 0px 0px -10px\" @click=\"newTextFunction(i)\" icon color=\"teal darken\" x-samll dark>\r\n                                            <v-icon dense dark>mdi-plus</v-icon>\r\n                                        </v-btn>\r\n                                    </v-row>\r\n                                    <div class=\"text-Inner-editDialog\" style=\"height: 150px;\">\r\n                                        <v-row v-for=\"(fun, f) in item.functionItem\" :key=\"f\" style=\"height: 90px;\">\r\n                                            <div>\r\n                                                <v-row style=\"height: 25px;margin:0px;\">\r\n                                                    <v-btn style=\"margin: 15px -80px 0px 80px\" @click=\"deletTextFunction(f,i)\" text x-small color=\"indigo\">\r\n                                                        <v-icon>mdi-minus</v-icon>\r\n                                                    </v-btn>\r\n                                                    <label style=\"padding:10px;margin:2px 0px 2px 70px;\">&#60;FUNCTION-GROUP-STATE-IREF&#62;</label>\r\n                                                </v-row>\r\n                                                <v-row style=\"height: 25px;margin:0px;\">\r\n                                                    <v-col cols=\"6\">\r\n                                                    <label style=\"padding:10px;margin:2px 0px 2px 120px;\">&#60;CONTEXT-MODE-DECLARATION-GROUP-REF&#62;</label>\r\n                                                    </v-col><v-col cols=\"4\">\r\n                                                    <v-text-field v-model=\"fun.contextMode\" placeholder=\"Path\" style=\"margin: -5px 0px 0px 70px\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                                                    </v-col><v-col cols=\"2\">\r\n                                                    <label style=\"padding:10px;\">&#60;&#47;CONTEXT-MODE-DECLARATION-GROUP-PROTOTYPE-REF&#62;</label>\r\n                                                    </v-col>\r\n                                                </v-row>\r\n                                                <v-row style=\"height: 25px;margin:0px;\">\r\n                                                    <v-col cols=\"5\">\r\n                                                    <label style=\"padding:10px;margin:2px 0px 2px 120px;\">&#60;TARGET-MODE-DECLARATION-REF&#62;</label>\r\n                                                    </v-col><v-col cols=\"4\">\r\n                                                    <v-text-field v-model=\"fun.targetMode\" placeholder=\"Path\" style=\"margin: -5px 0px 0px 75px\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                                                    </v-col><v-col cols=\"3\">\r\n                                                    <label style=\"padding:10px;\">&#60;&#47;TARGET-MODE-DECLARATION-REF&#62;</label>\r\n                                                    </v-col>\r\n                                                </v-row>\r\n                                                <v-row style=\"height: 30px;margin:0px;\">\r\n                                                    <label style=\"padding:10px;margin-left:110px;\">&#60;&#47;FUNCTION-GROUP-STATE-IREF&#62;</label>\r\n                                                </v-row>\r\n                                            </div>\r\n                                        </v-row>\r\n                                    </div> \r\n                                    <v-row style=\"height: 35px;\">\r\n                                        <label style=\"padding:10px;margin:2px 0px 2px 90px;\">&#60;&#47;FUNCTION-GROUP-STATE-IREFS&#62;</label>\r\n                                    </v-row>\r\n                                    <v-row style=\"height: 30px;margin:0px;\">\r\n                                        <label style=\"padding:10px;margin:2px 0px 2px 80px;\">&#60;RESOURCE-GROUP-REF&#62;</label>\r\n                                        <v-text-field v-model=\"item.resourceRef\" placeholder=\"Path\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                                        <label style=\"padding:10px;\">&#60;&#47;RESOURCE-GROUP-REF&#62;</label>\r\n                                    </v-row>\r\n                                    <v-row style=\"height: 30px;margin:0px;\">\r\n                                        <label style=\"padding:10px;margin:2px 0px 2px 80px;\">&#60;STARTUP-CONFIG-REF&#62;</label>\r\n                                        <v-text-field v-model=\"item.startupConfigRef\" placeholder=\"Path\" class=\"lable-placeholer-color\" dense></v-text-field>\r\n                                        <label style=\"padding:10px;\">&#60;&#47;STARTUP-CONFIG-REF&#62;</label>\r\n                                    </v-row>                               \r\n                                    <v-row style=\"height: 30px;margin:0px;\">\r\n                                        <label style=\"padding:10px;margin-left:55px;\">&#60;&#47;STATE-DEPENDENT-STARTUP-CONFIG&#62;</label>\r\n                                    </v-row>\r\n                                </div>\r\n                            </v-row>\r\n                        </div>\r\n                        <v-row style=\"height: 20px;\">\r\n                            <label style=\"padding:10px;\">&#60;&#47;STATE-DEPENDENT-STARTUP-CONFIGS&#62;</label>\r\n                        </v-row>\r\n                    </v-card-text>\r\n                    <v-card-actions>\r\n                        <v-spacer></v-spacer>\r\n                        <v-btn class=\"d-inline-flex ml-3 mr-1\" color=\"green darken-1\" text  @click=\"saveARXML()\" >\r\n                            Save\r\n                        </v-btn>\r\n                        <v-btn class=\"d-inline-flex ml-3 mr-1\" color=\"green darken-1\" text @click=\"cancelARXML()\">\r\n                            Cancel\r\n                        </v-btn>\r\n                    </v-card-actions>\r\n                </v-card>\r\n            </v-dialog>\r\n        </v-container>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport constant from \"../store/constants.js\"\r\nimport { EventBus } from \"../main.js\"\r\nimport dialogPathSetting from '../components/dialogPathSetting.vue'\r\n\r\nexport default {\r\n    props: ['element', 'isDatailView', 'minimaptoolbar', 'location'],\r\n    components:{dialogPathSetting},\r\n    computed: {\r\n        activeUUID() {\r\n            return this.$store.state.activeUUID\r\n        },\r\n        setting() {\r\n            return this.$store.state.setting\r\n        },\r\n    },\r\n    watch: {\r\n        activeUUID(val) {\r\n            this.setToolbarColor(val)\r\n        },\r\n        /*detailViewUUID(val) {\r\n            this.setToolbarColorDetailView(val)\r\n        },*/\r\n        setting(value) {\r\n            this.zoomvalue = value.zoomMain\r\n            if (this.zoomvalue < this.$setZoominTooltip) {\r\n                this.isTooltip = false\r\n            } else {\r\n                this.isTooltip = this.minimaptoolbar\r\n                if (this.zoomvalue  > this.$setZoominLineTitle && this.zoomvalue < this.$setZoominLineSetupStart) {\r\n                    EventBus.$emit('drawLineTitleBar', this.element.uuid, false)\r\n                } else if (this.zoomvalue > this.$setZoominLineSetupStart && this.zoomvalue < this.$setZoominLineSetupEnd) {\r\n                    this.$nextTick(() => {\r\n                        EventBus.$emit('drawLineTitleBar', this.element.uuid, this.iselementOpenClose)\r\n                        if(this.iselementOpenClose) {\r\n                            if(this.element.dependent.length > 0 && this.location == 1) {\r\n                                if (this.isDependentStartupOpenClose) {\r\n                                    EventBus.$emit('changeLine-someipService', '', this.element.uuid, this.dependentStartupTab, this.element.dependent[this.dependentStartupTab].id)\r\n                                } else {\r\n                                    EventBus.$emit('changeLine-someipService', '', this.element.uuid, null)\r\n                                }\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n        },\r\n    },\r\n    created() {\r\n        this.setToolbarColor(this.$store.state.activeUUID)\r\n    },\r\n\r\n    data() {\r\n        return {\r\n            rules: {\r\n                name:  [val => (val || '').length > 0 ],\r\n            },\r\n            dialogPath : false,\r\n            colorToolbar: \"#6A5ACD\",\r\n            zoomvalue: this.$store.state.setting.zoomMain,\r\n            isTooltip: this.minimaptoolbar,\r\n            iselementOpenClose: true,//this.minimaptoolbar, //toolbar만 보여줄것이냐 아니냐 설정 true: 전체 다 보여줌 / false : toolbar만 보여줌\r\n            dialogText: false,\r\n            editARXML: {name:'', logLevel: null, logPath: '', logProDesc: '', logProID: '', restart: '', preMapping: null, logMode: [],\r\n                    prodesign: null, determin: null, execut: null, machinname: '', machinetype: null, dependent: []},\r\n            editTextDependent: {execution: [], functionItem: [], resourceRef: null, startupConfigRef: null, id: ''},\r\n            editTextExecution: {contextMode: null, targetMode: null, id: ''},\r\n            editTextFunction: {contextMode: null, targetMode: null, id: ''},\r\n            isStateMachineOpenClose: true,\r\n            isDependentStartupOpenClose: true,\r\n            isFunctionGOpenClose : true,\r\n            isExecutionDOpenClose : true,\r\n            selProcessDesign: this.$store.getters.getProcessDesign,\r\n            selDeterministic: this.$store.getters.getDeterministicClient,\r\n            selExecutable: this.$store.getters.getExecutable,\r\n            selModeDeclaration: this.$store.getters.getModeDeclarationG,\r\n            selResourceG: this.$store.getters.getResourceGroup,\r\n            selStartupC: this.$store.getters.getStartupConfig,\r\n            dependentStartupTab: 0,\r\n\r\n            logLevel: ['FATAL', 'ERROR', 'WARN', 'INFO', 'DEBUG', 'VERBOSE'],\r\n            logMode: [ 'CONSOLE', 'FILE', 'NETWORK'],\r\n            isdeleteFunctionG: false,\r\n            selectDelectFunctionGItem: [],\r\n            headerFunctionG: [\r\n                { text: '', sortable: false, value: 'refView', width: '5px' },\r\n                { text: 'Context Mode Ref', align: 'start', sortable: false, value: 'contextMode' },\r\n                { text: 'Target Mode Ref', sortable: false, value: 'targetMode' },\r\n            ],\r\n            isEditingContextMode: true,\r\n            isEditingTargetMode: true,\r\n            defaultItem: { contextMode: null, targetMode: null, id: '' },\r\n            editFunctionGItem: { contextMode: null, targetMode: null, id: '' },\r\n            selContextMode: this.$store.getters.getMachineFG,\r\n            selTargetMode: this.$store.getters.getModeDeclaration,\r\n\r\n            isdeleteExecutionD: false,\r\n            selectDelectExecutionDItem: [],\r\n            isEditingCM: true,\r\n            isEditingTM: true,\r\n            editExecutionDItem: { contextMode: null, targetMode: null, id: '' },\r\n\r\n            refDesign: false,\r\n            refDeterministric: false,\r\n            refExecutable: false,\r\n            refType: false,\r\n            refExecution: '',\r\n            refFunction: '',\r\n            refResource: false,\r\n            refStartupC: false,\r\n\r\n        }\r\n    },\r\n    mounted () {\r\n        if (this.minimaptoolbar && this.zoomvalue < this.$setZoominElement) {\r\n            this.isTooltip = false\r\n        }\r\n        EventBus.$on(this.element.uuid, (refNum, idxID, tabID, id, isDeleteItem, item, idxRow) => {\r\n            console.log('## '+id+' / '+isDeleteItem+ ' / ' + item+ ' / '+tabID)\r\n            if (isDeleteItem) {\r\n                if (this.resourceRef && this.element.dependent[this.dependentStartupTab].id == tabID && item == 'resource') {\r\n                    this.clickOtherFields()\r\n                } else if (this.refStartupC && this.element.dependent[this.dependentStartupTab].id == tabID && item == 'startup') {\r\n                    this.clickOtherFields()\r\n                } else if (this.refExecution == id && item == 'Execution' && this.element.dependent[this.dependentStartupTab].id == tabID) {\r\n                    this.refExecution = id + 1\r\n                    this.rowExecutionClick(idxRow)\r\n                } else if (this.refFunction == id && item == 'Function' && this.element.dependent[this.dependentStartupTab].id == tabID) {\r\n                    this.refFunction = id + 1\r\n                    this.rowFunctionClick(idxRow)\r\n                }\r\n            } else {\r\n                this.refDesign = false\r\n                this.refDeterministric = false\r\n                this.refExecutable = false\r\n                this.refType = false\r\n                this.refResource = false\r\n                this.refStartupC = false\r\n                this.refExecution = null\r\n                this.refFunction = null\r\n\r\n                if (refNum == 1) {\r\n                    this.refDesign = true\r\n                } else if (refNum == 2) {\r\n                    this.refDeterministric = true\r\n                } else if (refNum == 3) {\r\n                    this.refExecutable = true\r\n                } else if (refNum == 4) {\r\n                    this.refType = true\r\n                } else if (refNum == 5) {\r\n                    this.dependentStartupTab = tabID\r\n                    this.refExecution = idxID\r\n                } else if (refNum == 6) {\r\n                    this.dependentStartupTab = tabID\r\n                    this.refFunction = idxID\r\n                } else if (refNum == 7) {\r\n                    this.dependentStartupTab = tabID\r\n                    this.refResource = idxID\r\n                } else if (refNum == 8) {\r\n                    this.dependentStartupTab = tabID\r\n                    this.refStartupC = idxID\r\n                }\r\n            }\r\n        })\r\n    },\r\n    methods: {\r\n        submitDialog(element) {\r\n            this.element.path = element\r\n            this.$store.commit('changePathElement', {uuid:this.element.uuid, path: this.element.path, name: this.element.name} )\r\n            this.$store.commit('isintoErrorList', {uuid:this.element.uuid, name:this.element.name, path:this.element.path})\r\n        },\r\n        setToolbarColor(activeid) \r\n        {\r\n            if(this.element.uuid == activeid) {\r\n                this.colorToolbar = \"#FF1493\" \r\n            } else {\r\n                this.colorToolbar = \"#6A5ACD\"\r\n            }\r\n        },\r\n        setToolbarColorDetailView(isdetail) {\r\n            if(this.element.uuid == isdetail) {\r\n                this.colorToolbar = \"#B0E0E6\" \r\n            } else if (this.element.uuid == this.$store.state.activeUUID) {\r\n                this.colorToolbar  = \"#FF1493\"\r\n            } else {\r\n                this.colorToolbar = \"#6A5ACD\"\r\n            }\r\n        },\r\n        showProcess() {\r\n            this.clickOtherFields()\r\n            this.iselementOpenClose = this.iselementOpenClose ? false : true\r\n            this.$nextTick(() => {\r\n                EventBus.$emit('drawLine')\r\n            })\r\n        },\r\n        showStateMachine() {\r\n            this.clickOtherFields()\r\n            this.isStateMachineOpenClose = this.isStateMachineOpenClose ? false : true\r\n            // 선을 다시 그려줘야 하기 때문에\r\n            //EventBus.$emit('drawLine')\r\n        },\r\n        showDependentStartup() {\r\n            this.clickOtherFields()\r\n            this.isDependentStartupOpenClose = this.isDependentStartupOpenClose ? false : true\r\n           /* if(this.element.dependent.length > 0 && this.location == 1) {\r\n                this.$nextTick(() => {\r\n                    if(this.isDependentStartupOpenClose) {\r\n                        EventBus.$emit('changeLine-someipService', '', this.element.uuid, this.dependentStartupTab, this.element.dependent[this.dependentStartupTab].id)\r\n                    } else {\r\n                        EventBus.$emit('changeLine-someipService', '', this.element.uuid, null)\r\n                    }\r\n                    EventBus.$emit('drawLine')\r\n                })\r\n            }*/\r\n        },\r\n        showFunctionG() {\r\n            this.clickOtherFields()\r\n            this.isFunctionGOpenClose = this.isFunctionGOpenClose ? false : true\r\n            // 선을 다시 그려줘야 하기 때문에\r\n            //EventBus.$emit('drawLine')\r\n        },\r\n        showExecutionD() {\r\n            this.clickOtherFields()\r\n            this.isExecutionDOpenClose = this.isExecutionDOpenClose ? false : true\r\n            // 선을 다시 그려줘야 하기 때문에\r\n            //EventBus.$emit('drawLine')\r\n        },\r\n        inputProcessName() {\r\n            this.$store.commit('editProcess', {compo:\"Name\", uuid:this.element.uuid, name:this.element.name} )\r\n            this.$store.commit('changePathElement', {uuid:this.element.uuid, path: this.element.path, name: this.element.name} )\r\n            if (this.element.name != '') {\r\n                this.$store.commit('isintoErrorList', {uuid:this.element.uuid, name:this.element.name, path:this.element.path})\r\n            }\r\n        },\r\n        clickOtherFields() {\r\n            if (this.refDesign || this.refDeterministric ||this.refExecutable ||this.refType ||\r\n                this.refResource ||this.refStartupC || this.refExecution != null || this.refFunction != null) {\r\n                this.deleteOpenElement()\r\n                this.refDesign = false\r\n                this.refDeterministric = false\r\n                this.refExecutable = false\r\n                this.refType = false\r\n                this.refResource = false\r\n                this.refStartupC = false\r\n                this.refExecution = null\r\n                this.refFunction = null\r\n            }\r\n        },\r\n        rowExecutionClick(idx) {\r\n            console.log('rowClick ' + idx+' / '+ this.refExecution)\r\n            if (this.refExecution != this.element.dependent[this.dependentStartupTab].execution[idx].id) { // 같은거 계속 누르면 안됨\r\n                //기존것 delete하고 \r\n                this.clickOtherFields()\r\n                // 새로들어온 idx line draw\r\n                var endLineContext = null, endLineTarget = null\r\n                console.log(this.element.dependent[this.dependentStartupTab].execution[idx].contextMode)\r\n                if (this.element.dependent[this.dependentStartupTab].execution[idx].targetMode != null) {\r\n                    endLineTarget = this.$store.getters.getChangeEndLine(this.element.uuid+'/edtarget-'+this.element.dependent[this.dependentStartupTab].execution[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                    if (endLineTarget == undefined) {\r\n                        endLineTarget = this.$store.getters.getModeDeclarationPath(this.element.dependent[this.dependentStartupTab].execution[idx].targetMode, 1)\r\n                    }\r\n                    if (endLineTarget != null) {\r\n                        // 기존에 있던거 좌표 바꿔줘야함.\r\n                        this.$store.commit('editModeDeclarationGroup', {compo:\"drag\", uuid: endLineTarget, top: this.element.top + 200, left: this.element.left + this.$setPositionLeft} )\r\n                        this.$store.commit('setzIndexVisible', {parent:constant.ModeDeclarationGroup_str, uuid: endLineTarget, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                        this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/edtable'+this.element.dependent[this.dependentStartupTab].id, end:endLineTarget, \r\n                                        iscircle:false, refNum:5, idxID: this.element.dependent[this.dependentStartupTab].execution[idx].id, tabID: this.dependentStartupTab})\r\n                        this.$nextTick(() => { \r\n                            EventBus.$emit('Element-open', false, endLineTarget)\r\n                            EventBus.$emit('new-line', this.element.uuid+'/edtable'+this.element.dependent[this.dependentStartupTab].id, endLineTarget)\r\n                        })\r\n                    }\r\n                }\r\n                if (this.element.dependent[this.dependentStartupTab].execution[idx].contextMode != null) {\r\n                    endLineContext = this.$store.getters.getChangeEndLine(this.element.uuid+'/edcontext-'+this.element.dependent[this.dependentStartupTab].execution[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                    if (endLineContext == undefined) {\r\n                        endLineContext = this.$store.getters.getMachinePath(this.element.dependent[this.dependentStartupTab].execution[idx].contextMode, 2)\r\n                    }\r\n                    if (endLineContext != null) {\r\n                        // 기존에 있던거 좌표 바꿔줘야함.\r\n                        var top = 200\r\n                        if (endLineTarget != null) {\r\n                            top = 600\r\n                        }\r\n                        this.$store.commit('editMachine', {compo:\"drag\", uuid: endLineContext, top: this.element.top + top, left: this.element.left + this.$setPositionLeft} )\r\n                        this.$store.commit('setzIndexVisible', {parent:constant.Machine_str, uuid: endLineContext, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                        this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/edtable'+this.element.dependent[this.dependentStartupTab].id, end:endLineContext,\r\n                                         iscircle:false, refNum:5, idxID: this.element.dependent[this.dependentStartupTab].execution[idx].id, tabID: this.dependentStartupTab})\r\n                        this.$nextTick(() => { \r\n                            EventBus.$emit('Element-open', false, endLineContext)\r\n                            EventBus.$emit('new-line', this.element.uuid+'/edtable'+this.element.dependent[this.dependentStartupTab].id, endLineContext)\r\n                        })\r\n                    }\r\n                }\r\n\r\n                this.$nextTick(() => { \r\n                    if (endLineContext != null && endLineTarget == null) {\r\n                        EventBus.$emit('Element-open', true, endLineContext)\r\n                    } else if (endLineContext == null && endLineTarget != null) {\r\n                        EventBus.$emit('Element-open', true, endLineTarget)\r\n                    } \r\n                })\r\n                this.refExecution = this.element.dependent[this.dependentStartupTab].execution[idx].id\r\n            }\r\n        },\r\n        rowFunctionClick(idx) {\r\n            console.log('rowClick ' + idx)\r\n            if (this.refFunction != this.element.dependent[this.dependentStartupTab].functionItem[idx].id) { // 같은거 계속 누르면 안됨\r\n                //기존것 delete하고 \r\n                this.clickOtherFields()\r\n                // 새로들어온 idx line draw\r\n                var endLineContext = null, endLineTarget = null\r\n                if (this.element.dependent[this.dependentStartupTab].functionItem[idx].targetMode != null) {\r\n                    endLineTarget = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgtarget-'+this.element.dependent[this.dependentStartupTab].functionItem[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                    if (endLineTarget == undefined) {\r\n                        endLineTarget = this.$store.getters.getModeDeclarationPath(this.element.dependent[this.dependentStartupTab].functionItem[idx].targetMode, 1)\r\n                    }\r\n                    if (endLineTarget != null) {\r\n                        // 기존에 있던거 좌표 바꿔줘야함.\r\n                        this.$store.commit('editModeDeclarationGroup', {compo:\"drag\", uuid: endLineTarget, top: this.element.top + 200, left: this.element.left + this.$setPositionLeft} )\r\n                        this.$store.commit('setzIndexVisible', {parent:constant.ModeDeclarationGroup_str, uuid: endLineTarget, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                        this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id, end:endLineTarget, \r\n                                    iscircle:false, refNum:6, idxID: this.element.dependent[this.dependentStartupTab].functionItem[idx].id, tabID: this.dependentStartupTab})\r\n                        this.$nextTick(() => { \r\n                            EventBus.$emit('Element-open', false, endLineTarget)\r\n                           EventBus.$emit('new-line', this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id, endLineTarget)\r\n                        })\r\n                    }\r\n                }\r\n                if (this.element.dependent[this.dependentStartupTab].functionItem[idx].contextMode != null) {\r\n                    endLineContext = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgcontext-'+this.element.dependent[this.dependentStartupTab].functionItem[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                    if (endLineContext == undefined) {\r\n                        endLineContext = this.$store.getters.getMachinePath(this.element.dependent[this.dependentStartupTab].functionItem[idx].contextMode, 2)\r\n                    }\r\n                    if (endLineContext != null) {\r\n                        // 기존에 있던거 좌표 바꿔줘야함.\r\n                        var top = 200\r\n                        if (endLineTarget != null) {\r\n                            top = 600\r\n                        }\r\n                        this.$store.commit('editMachine', {compo:\"drag\", uuid: endLineContext, top: this.element.top + top, left: this.element.left + this.$setPositionLeft} )\r\n                        this.$store.commit('setzIndexVisible', {parent:constant.Machine_str, uuid: endLineContext, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                        this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id, end:endLineContext,\r\n                                     iscircle:false, refNum:6, idxID: this.element.dependent[this.dependentStartupTab].functionItem[idx].id, tabID: this.dependentStartupTab})\r\n                        this.$nextTick(() => { \r\n                            EventBus.$emit('Element-open', false, endLineContext)\r\n                           EventBus.$emit('new-line', this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id, endLineContext)\r\n                        })\r\n                    }\r\n                }\r\n\r\n                this.$nextTick(() => { \r\n                    if (endLineContext != null && endLineTarget == null) {\r\n                        EventBus.$emit('Element-open', true, endLineContext)\r\n                    } else if (endLineContext == null && endLineTarget != null) {\r\n                        EventBus.$emit('Element-open', true, endLineTarget)\r\n                    } \r\n                })\r\n                this.refFunction = this.element.dependent[this.dependentStartupTab].functionItem[idx].id\r\n            }\r\n        },\r\n\r\n        clearProcessDesign() {\r\n            this.element.prodesign = null\r\n            var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processprodesign')\r\n            if (endLine != undefined) {\r\n                this.deleteLine(this.element.uuid+'/processprodesign')\r\n            }\r\n            this.clickOtherFields()\r\n        },\r\n        setProcessDesignSelect() {\r\n            this.clickOtherFields()\r\n            if (this.element.prodesign != null) {this.refDesign = true}\r\n            if (this.$store.getters.getDeleteOpenElement(this.element.uuid)+1 == this.$store.state.openElement.length) {\r\n                var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processprodesign')\r\n                if (endLine == undefined) {\r\n                    endLine = this.$store.getters.getProcessDesignPath(this.element.prodesign)\r\n                }\r\n                if (endLine != null) {\r\n                    this.$store.commit('editProcessDesign', {compo:\"drag\", uuid: endLine, top: this.element.top, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.ProcessDesign_str, uuid: endLine, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => { \r\n                        EventBus.$emit('new-line', this.element.uuid+'/processprodesign', endLine)\r\n                        document.getElementById(endLine+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processprodesign', end:endLine, iscircle:false, refNum:1})\r\n                    //this.$store.commit('setDetailView', {uuid: endLine, element: constant.ProcessDesign_str} )\r\n                    // document.getElementById(endLine+this.location).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    // EventBus.$emit('active-element', endLine)\r\n                }\r\n            }\r\n        },\r\n        setProcessDesignList() {\r\n            this.selProcessDesign = this.$store.getters.getProcessDesign\r\n            this.setactiveUUID()\r\n        },\r\n        setProcessDesign(item) {\r\n            this.clickOtherFields()\r\n            if(this.element.prodesign != item.name) {\r\n                var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processprodesign')\r\n                if (endLine != undefined && endLine != item.uuid) {\r\n                    //기존꺼 삭제해야한다 vuex에서도 삭제하고 mainview에서도 삭제하고 \r\n                    this.deleteLine(this.element.uuid+'/processprodesign')\r\n                }\r\n                //새로 추가해준다\r\n                if (endLine != item.uuid) {\r\n                    this.refDesign = true\r\n                    this.$store.commit('editProcessDesign', {compo:\"drag\", uuid: item.uuid, top: this.element.top, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.ProcessDesign_str, uuid: item.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => { \r\n                        this.newLine(this.element.uuid+'/processprodesign', this.element.uuid+'/processprodesign', item.uuid, true)\r\n                        document.getElementById(item.uuid+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processprodesign', end:item.uuid, iscircle:false, refNum:1})\r\n                }\r\n                this.element.prodesign = item.name\r\n            } else {\r\n                if (this.$store.getters.getDeleteOpenElement(this.element.uuid)+1 == this.$store.state.openElement.length) {\r\n                    this.refDesign = true\r\n                    this.$store.commit('editProcessDesign', {compo:\"drag\", uuid: item.uuid, top: this.element.top, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.ProcessDesign_str, uuid: item.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => { \r\n                        this.newLine(this.element.uuid+'/processprodesign', this.element.uuid+'/processprodesign', item.uuid, true)\r\n                        document.getElementById(item.uuid+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processprodesign', end:item.uuid, iscircle:false, refNum:1})\r\n                }\r\n            }\r\n            this.setactiveUUID()\r\n        },\r\n        newProcessDesign() {\r\n            this.$store.commit('addElementProcessDesign', { //executableref 는 null해줘야한다. clearable하면 값이 null변하기 때문에 \r\n                name: this.$store.getters.getNameProcessDesign, path: '', input: false,\r\n                top: this.element.top, left: this.element.left + this.$setPositionLeft, zindex: 10, icon:\"mdi-clipboard-outline\", validation: false,\r\n                executableref: null, determin: [],\r\n            })\r\n            EventBus.$emit('add-element', constant.ProcessDesign_str)\r\n            EventBus.$emit('add-element', constant.AdaptiveApplication_str)\r\n            this.$store.commit('editProcess', {compo:\"z\", uuid:this.element.uuid, zindex:2} )\r\n        },\r\n\r\n        clearDetermin() {\r\n            this.element.determin = null\r\n            var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processdetermin')\r\n            if (endLine != undefined) {\r\n                this.deleteLine(this.element.uuid+'/processdetermin')\r\n            }\r\n            this.clickOtherFields()\r\n        },\r\n        setDeterminSelect() {\r\n            this.clickOtherFields()\r\n            if (this.element.determin != null) {this.refDeterministric = true}\r\n            if (this.$store.getters.getDeleteOpenElement(this.element.uuid)+1 == this.$store.state.openElement.length) {\r\n                var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processdetermin')\r\n                if (endLine == undefined) {\r\n                    endLine = this.$store.getters.getDeterministicClientPath(this.element.determin)\r\n                }\r\n                if (endLine != null) {\r\n                    this.$store.commit('editDeterministicClien', {compo:\"drag\", uuid: endLine, top: this.element.top + 60, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.DeterministicClient_str, uuid: endLine, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => { \r\n                        EventBus.$emit('new-line', this.element.uuid+'/processdetermin', endLine)\r\n                        document.getElementById(endLine+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processdetermin', end:endLine, iscircle:false, refNum:2})\r\n                    //this.$store.commit('setDetailView', {uuid: endLine, element: constant.DeterministicClient_str} )\r\n                    /*document.getElementById(endLine+this.location).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    EventBus.$emit('active-element', endLine)*/\r\n                }\r\n            }\r\n        },\r\n        setDeterminList() {\r\n            this.selDeterministic = this.$store.getters.getDeterministicClient\r\n            this.setactiveUUID()\r\n        },\r\n        setDeterministicClient(item) {\r\n            this.clickOtherFields()\r\n            if(this.element.determin != item.name) {\r\n                var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processdetermin')\r\n                if (endLine != undefined && endLine != item.uuid) {\r\n                    //기존꺼 삭제해야한다 vuex에서도 삭제하고 mainview에서도 삭제하고 \r\n                    this.deleteLine(this.element.uuid+'/processdetermin')\r\n                }\r\n                //새로 추가해준다\r\n                if (endLine != item.uuid) {\r\n                    this.refDeterministric = true\r\n                    this.$store.commit('editDeterministicClien', {compo:\"drag\", uuid: item.uuid, top: this.element.top + 60, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.DeterministicClient_str, uuid: item.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => { \r\n                        this.newLine(this.element.uuid+'/processdetermin', this.element.uuid+'/processdetermin', item.uuid, true)\r\n                        document.getElementById(item.uuid+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processdetermin', end:item.uuid, iscircle:false, refNum:2})\r\n                }\r\n                this.element.determin = item.name\r\n            } else {\r\n                if (this.$store.getters.getDeleteOpenElement(this.element.uuid)+1 == this.$store.state.openElement.length) {\r\n                    this.refDeterministric = true\r\n                    this.$store.commit('editDeterministicClien', {compo:\"drag\", uuid: item.uuid, top: this.element.top + 60, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.DeterministicClient_str, uuid: item.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => { \r\n                        this.newLine(this.element.uuid+'/processdetermin', this.element.uuid+'/processdetermin', item.uuid, true)\r\n                        document.getElementById(item.uuid+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processdetermin', end:item.uuid, iscircle:false, refNum:2})\r\n                }\r\n            }\r\n            this.setactiveUUID()\r\n        },\r\n        newDeterministicClient() {\r\n            this.$store.commit('addElementDeterministicClien', {\r\n                name: this.$store.getters.getNameDeterministicClient, path: '', input: false,\r\n                top: this.element.top + 60, left: this.element.left + this.$setPositionLeft, zindex: 10, icon:\"mdi-clipboard-outline\", validation: false,\r\n                cycletiem: '', numofworkers: '',\r\n            })\r\n            EventBus.$emit('add-element', constant.DeterministicClient_str)\r\n            EventBus.$emit('add-element', constant.AdaptiveApplication_str)\r\n            this.$store.commit('editProcess', {compo:\"z\", uuid:this.element.uuid, zindex:2} )\r\n        },\r\n\r\n        clearExecutable() {\r\n            this.element.execut = null\r\n            var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processexecut')\r\n            if (endLine != undefined) {\r\n                this.deleteLine(this.element.uuid+'/processexecut')\r\n            }\r\n            this.clickOtherFields()\r\n        },\r\n        setExecutableSelect() {\r\n            this.clickOtherFields()\r\n            if (this.element.execut != null) {this.refExecutable = true}\r\n            if (this.$store.getters.getDeleteOpenElement(this.element.uuid)+1 == this.$store.state.openElement.length) {\r\n                var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processexecut')\r\n                if (endLine == undefined) {\r\n                    endLine = this.$store.getters.getExecutablePath(this.element.execut)\r\n                }\r\n                if (endLine != null) {\r\n                    this.$store.commit('editExecutable', {compo:\"drag\", uuid: endLine, top: this.element.top, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.Executable_str, uuid: endLine, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => { \r\n                        EventBus.$emit('new-line', this.element.uuid+'/processexecut', endLine)\r\n                        document.getElementById(endLine+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processexecut', end:endLine, iscircle:false, refNum:3})\r\n                    //this.$store.commit('setDetailView', {uuid: endLine, element: constant.Executable_str} )\r\n                    // document.getElementById(endLine+this.location).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    // EventBus.$emit('active-element', endLine)\r\n                }\r\n            }\r\n        },\r\n        setExecutableList() {\r\n            this.selExecutable = this.$store.getters.getExecutable\r\n            this.setactiveUUID()\r\n        },\r\n        setExecutable(item) {\r\n            this.clickOtherFields()\r\n            if(this.element.execut != item.name) {\r\n                var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processexecut')\r\n                if (endLine != undefined && endLine != item.uuid) {\r\n                    //기존꺼 삭제해야한다 vuex에서도 삭제하고 mainview에서도 삭제하고 \r\n                    this.deleteLine(this.element.uuid+'/processexecut')\r\n                }\r\n                //새로 추가해준다\r\n                if (endLine != item.uuid) {\r\n                    this.refExecutable = true\r\n                    this.$store.commit('editExecutable', {compo:\"drag\", uuid: item.uuid, top: this.element.top, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.Executable_str, uuid: item.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => { \r\n                        this.newLine(this.element.uuid+'/processexecut', this.element.uuid+'/processexecut', item.uuid, true)\r\n                        document.getElementById(item.uuid+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processexecut', end:item.uuid, iscircle:false, refNum:3})\r\n                }\r\n                this.element.execut = item.name\r\n            } else {\r\n                if (this.$store.getters.getDeleteOpenElement(this.element.uuid)+1 == this.$store.state.openElement.length) {\r\n                    this.refExecutable = true\r\n                    this.$store.commit('editExecutable', {compo:\"drag\", uuid: item.uuid, top: this.element.top, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.Executable_str, uuid: item.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => { \r\n                        this.newLine(this.element.uuid+'/processexecut', this.element.uuid+'/processexecut', item.uuid, true)\r\n                        document.getElementById(item.uuid+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processexecut', end:item.uuid, iscircle:false, refNum:3})\r\n                }\r\n            }\r\n            this.setactiveUUID()\r\n        },\r\n        newExecutable() {\r\n            this.$store.commit('addElementExecutable', { //applicationtyperef 는 null해줘야한다. clearable하면 값이 null변하기 때문에 \r\n                name: this.$store.getters.getNameExecutable, path: '', input: false,\r\n                top: this.element.top, left: this.element.left + this.$setPositionLeft, zindex: 10, icon:\"mdi-clipboard-outline\", validation: false,\r\n                version: '', category:'', buildType:null, loggingBehabior:null, reportingBehabior:null, swname:'', applicationtyperef: null,\r\n            })\r\n            EventBus.$emit('add-element', constant.Executable_str)\r\n            EventBus.$emit('add-element', constant.AdaptiveApplication_str)\r\n            this.$store.commit('editProcess', {compo:\"z\", uuid:this.element.uuid, zindex:2} )\r\n        },\r\n\r\n        clearModeDeclaration() {\r\n            this.element.machinetype = null\r\n            var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processmodedeclar')\r\n            if (endLine != undefined) {\r\n                this.deleteLine(this.element.uuid+'/processmodedeclar')\r\n            }\r\n            this.clickOtherFields()\r\n        },\r\n        setModeDeclarationSelect() {\r\n            this.clickOtherFields()\r\n            if (this.element.machinetype != null) {this.refType = true}\r\n            if (this.$store.getters.getDeleteOpenElement(this.element.uuid)+1 == this.$store.state.openElement.length) {\r\n                var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processmodedeclar')\r\n                if (endLine == undefined) {\r\n                    endLine = this.$store.getters.getModeDeclarationPath(this.element.machinetype, 0)\r\n                }\r\n                if (endLine != null) {\r\n                    this.$store.commit('editModeDeclarationGroup', {compo:\"drag\", uuid: endLine, top: this.element.top + 480, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.ModeDeclarationGroup_str, uuid: endLine, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => { \r\n                        EventBus.$emit('Element-open', true, endLine)\r\n                        EventBus.$emit('new-line', this.element.uuid+'/processmodedeclar', endLine)\r\n                        document.getElementById(endLine+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processmodedeclar', end:endLine, iscircle:false, refNum:4})\r\n                    //this.$store.commit('setDetailView', {uuid: endLine, element: constant.ModeDeclarationGroup_str} )\r\n                    /*document.getElementById(endLine+this.location).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    EventBus.$emit('active-element', endLine)*/\r\n                }\r\n            }\r\n        },\r\n        setModeDeclarationList() {\r\n            this.selModeDeclaration = this.$store.getters.getModeDeclarationG\r\n            this.setactiveUUID()\r\n        },\r\n        setModeDeclaration(item) {\r\n            this.clickOtherFields()\r\n            if(this.element.machinetype != item.name) {\r\n                var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processmodedeclar')\r\n                if (endLine != undefined && endLine != item.uuid) {\r\n                    //기존꺼 삭제해야한다 vuex에서도 삭제하고 mainview에서도 삭제하고 \r\n                    this.deleteLine(this.element.uuid+'/processmodedeclar')\r\n                }\r\n                //새로 추가해준다\r\n                if (endLine != item.uuid) {\r\n                    this.refType = true\r\n                    this.$store.commit('editModeDeclarationGroup', {compo:\"drag\", uuid: item.uuid, top: this.element.top + 480, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.ModeDeclarationGroup_str, uuid: item.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => {\r\n                        EventBus.$emit('Element-open', true, item.uuid)\r\n                        this.newLine(this.element.uuid+'/processmodedeclar', this.element.uuid+'/processmodedeclar', item.uuid, true) \r\n                        document.getElementById(item.uuid+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processmodedeclar', end:item.uuid, iscircle:false, refNum:4})\r\n                }\r\n                this.element.machinetype = item.name\r\n            } else {\r\n                if (this.$store.getters.getDeleteOpenElement(this.element.uuid)+1 == this.$store.state.openElement.length) {\r\n                    this.refType = true\r\n                    this.$store.commit('editModeDeclarationGroup', {compo:\"drag\", uuid: item.uuid, top: this.element.top + 480, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.ModeDeclarationGroup_str, uuid: item.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => { \r\n                        EventBus.$emit('Element-open', true, item.uuid)\r\n                        this.newLine(this.element.uuid+'/processmodedeclar', this.element.uuid+'/processmodedeclar', item.uuid, true)\r\n                        document.getElementById(item.uuid+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processmodedeclar', end:item.uuid, iscircle:false, refNum:4})\r\n                }\r\n            }\r\n            this.setactiveUUID()\r\n        },\r\n        newModeDeclarationGroup() {\r\n            this.$store.commit('addElementModeDeclarationGroup', {\r\n                name: this.$store.getters.getNameModeDeclarationGroup, path: '', input: false,\r\n                top: this.element.top + 480, left: this.element.left + this.$setPositionLeft, zindex: 10, \r\n                modedeclaration:[{name: 'Off', value: ''},{name: 'Startup', Value: ''}], initmode:'Off', icon:\"mdi-clipboard-outline\", validation: false\r\n            })\r\n            EventBus.$emit('add-element', constant.ModeDeclarationGroup_str)\r\n            EventBus.$emit('add-element', constant.Machines_str)\r\n            this.$store.commit('editProcess', {compo:\"z\", uuid:this.element.uuid, zindex:2} )\r\n        },\r\n\r\n        addDependentStartup() {\r\n            this.clickOtherFields()\r\n            const editItem = { execution: [], functionItem: [], resourceRef: null, startupConfigRef: null, id: ''}\r\n            let res = true, n = 0\r\n            while (res) {\r\n                n++;\r\n                res = this.element.dependent.some(item => item.id == n)\r\n            }\r\n            editItem.id = n\r\n            const addObj = new Object(editItem)\r\n            this.element.dependent.push(addObj)\r\n            this.dependentStartupTab = this.element.dependent.length-1\r\n            if (this.location == 1) {\r\n                EventBus.$emit('changeLine-someipService', '', this.element.uuid, null)\r\n            }\r\n        },\r\n        clickDependentStartuptab() {\r\n            //console.log('clickDependentStartuptab')\r\n            this.isdeleteFunctionG = false\r\n            this.isdeleteExecutionD = false\r\n            this.selectDelectFunctionGItem = []\r\n            this.selectDelectExecutionDItem = []\r\n        },\r\n        changeDependentStartupTab() {\r\n            if (this.refExecution != null || this.refFunction != null || this.refResource || this.refStartupC) {\r\n                this.deleteOpenElement()\r\n                this.refExecution = null\r\n                this.refFunction = null\r\n                this.refResource = false\r\n                this.refStartupC = false\r\n            }\r\n            //console.log('changeDependentStartupTab' +this.dependentStartupTab)\r\n            /*if(this.element.dependent.length > 0 && this.location == 1 && this.dependentStartupTab != undefined) {\r\n                setTimeout(() => {EventBus.$emit('changeLine-someipService', '', this.element.uuid, this.dependentStartupTab, this.element.dependent[this.dependentStartupTab].id)}, 300);\r\n            }*/\r\n        },\r\n        deleteDependentStartup(idx) {\r\n            this.clickOtherFields()\r\n            console.log('deleteDependentStartup' + idx)\r\n            this.element.dependent[idx].functionItem.forEach(item => {\r\n                var endLineCon = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgcontext-'+item.id+'-'+this.element.dependent[idx].id)\r\n                if(endLineCon != undefined) {\r\n                    this.deleteLine(this.element.uuid+'/fgcontext-'+item.id+'-'+this.element.dependent[idx].id)\r\n                }\r\n                var endLinetarg = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgtarget-'+item.id+'-'+this.element.dependent[idx].id)\r\n                if(endLinetarg != undefined) {\r\n                    this.deleteLine(this.element.uuid+'/fgtarget-'+item.id+'-'+this.element.dependent[idx].id)\r\n                }\r\n            })\r\n            this.element.dependent[idx].execution.forEach(item => {\r\n                var endLineC = this.$store.getters.getChangeEndLine(this.element.uuid+'/edcontext-'+item.id+'-'+this.element.dependent[idx].id)\r\n                if(endLineC != undefined) {\r\n                    this.deleteLine(this.element.uuid+'/edcontext-'+item.id+'-'+this.element.dependent[idx].id)\r\n                }\r\n                var endLinet = this.$store.getters.getChangeEndLine(this.element.uuid+'/edtarget-'+item.id+'-'+this.element.dependent[idx].id)\r\n                if(endLinet != undefined) {\r\n                    this.deleteLine(this.element.uuid+'/edtarget-'+item.id+'-'+this.element.dependent[idx].id)\r\n                }\r\n            })\r\n            var endLine\r\n            endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processresorce-'+this.element.dependent[idx].id)\r\n            if (endLine != undefined) {\r\n                this.deleteLine(this.element.uuid+'/processresorce-'+this.element.dependent[idx].id)\r\n            }\r\n            endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processstartup-'+this.element.dependent[idx].id)\r\n            if (endLine != undefined) {\r\n                this.deleteLine(this.element.uuid+'/processstartup-'+this.element.dependent[idx].id)\r\n            }\r\n            \r\n            this.element.dependent.splice(idx, 1)\r\n        },\r\n        isCheckFunctionG() {\r\n            this.clickOtherFields()\r\n            if (this.isdeleteFunctionG == true) {\r\n                this.isdeleteFunctionG = false\r\n                this.selectDelectFunctionGItem = []\r\n            } else {\r\n                this.isdeleteFunctionG = true\r\n            }\r\n        },\r\n        deleteFunctionG() {\r\n            this.clickOtherFields()\r\n            if (this.isdeleteFunctionG == true) {\r\n                this.selectDelectFunctionGItem.forEach(item => {\r\n                    for(let i=0; i<this.element.dependent[this.dependentStartupTab].functionItem.length; i++){\r\n                        if (item.id == this.element.dependent[this.dependentStartupTab].functionItem[i].id) {\r\n                            var endLineCon = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgcontext-'+item.id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                            if(endLineCon != undefined) {\r\n                                this.deleteLine(this.element.uuid+'/fgcontext-'+item.id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                            }\r\n                            var endLinetarg = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgtarget-'+item.id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                            if(endLinetarg != undefined) {\r\n                                this.deleteLine(this.element.uuid+'/fgtarget-'+item.id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                            }\r\n                        }\r\n                    }\r\n                })\r\n\r\n                this.element.dependent[this.dependentStartupTab].functionItem = this.element.dependent[this.dependentStartupTab].functionItem.filter(item => {\r\n                         return this.selectDelectFunctionGItem.indexOf(item) < 0 })\r\n\r\n                this.isdeleteFunctionG = false\r\n                this.selectDelectFunctionGItem = []\r\n            }\r\n        },\r\n        openFunctionG(idx) {\r\n            this.selContextMode = this.$store.getters.getMachineFG\r\n            this.selTargetMode = this.$store.getters.getModeDeclaration\r\n\r\n            if (this.element.dependent[this.dependentStartupTab].functionItem[idx].contextMode != null ) {\r\n                var endLineC = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgcontext-'+this.element.dependent[this.dependentStartupTab].functionItem[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                if (endLineC == undefined) {\r\n                    endLineC = this.$store.getters.getMachinePath(this.element.dependent[this.dependentStartupTab].functionItem[idx].contextMode, 2)\r\n                }\r\n                this.editFunctionGItem.contextMode = { name :this.element.dependent[this.dependentStartupTab].functionItem[idx].contextMode, uuid: endLineC }\r\n            }\r\n            if (this.element.dependent[this.dependentStartupTab].functionItem[idx].targetMode != null) {\r\n                var endLineT = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgtarget-'+this.element.dependent[this.dependentStartupTab].functionItem[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                if (endLineT == undefined) {\r\n                    endLineT = this.$store.getters.getModeDeclarationPath(this.element.dependent[this.dependentStartupTab].functionItem[idx].targetMode, 1)\r\n                }\r\n                this.editFunctionGItem.targetMode = { name :this.element.dependent[this.dependentStartupTab].functionItem[idx].targetMode, uuid: endLineT }\r\n            }\r\n        },\r\n        editFunctionG(idx) {\r\n            var endcontextMLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgcontext-'+this.element.dependent[this.dependentStartupTab].functionItem[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n            if (endcontextMLine != undefined && this.editFunctionGItem.contextMode == null) {\r\n                this.deleteLine(this.element.uuid+'/fgcontext-'+this.element.dependent[this.dependentStartupTab].functionItem[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                this.element.dependent[this.dependentStartupTab].functionItem[idx].contextMode = null\r\n            } else if (endcontextMLine != undefined && endcontextMLine != this.editFunctionGItem.contextMode.uuid) {\r\n                //기존꺼 삭제해야한다 vuex에서도 삭제하고 mainview에서도 삭제하고 \r\n                this.deleteLine(this.element.uuid+'/fgcontext-'+this.element.dependent[this.dependentStartupTab].functionItem[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                this.newLine(this.element.uuid+'/fgcontext-'+this.element.dependent[this.dependentStartupTab].functionItem[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id, \r\n                                this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id, this.editFunctionGItem.contextMode.uuid, false)\r\n                this.element.dependent[this.dependentStartupTab].functionItem[idx].contextMode = this.editFunctionGItem.contextMode.name\r\n            } else if(endcontextMLine == undefined && this.editFunctionGItem.contextMode != null && this.editFunctionGItem.contextMode.uuid != null) {\r\n                this.newLine(this.element.uuid+'/fgcontext-'+this.element.dependent[this.dependentStartupTab].functionItem[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id,\r\n                                 this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id, this.editFunctionGItem.contextMode.uuid, false)\r\n                this.element.dependent[this.dependentStartupTab].functionItem[idx].contextMode = this.editFunctionGItem.contextMode.name\r\n            } else if (this.editFunctionGItem.contextMode != null && endcontextMLine == this.editFunctionGItem.contextMode.uuid && this.element.dependent[this.dependentStartupTab].functionItem[idx].contextMode != this.editFunctionGItem.contextMode.name) {\r\n                this.element.dependent[this.dependentStartupTab].functionItem[idx].contextMode = this.editFunctionGItem.contextMode.name\r\n            }\r\n\r\n            var endtargetMLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgtarget-'+this.element.dependent[this.dependentStartupTab].functionItem[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n            if (endtargetMLine != undefined && this.editFunctionGItem.targetMode == null) {\r\n                this.deleteLine(this.element.uuid+'/fgtarget-'+this.element.dependent[this.dependentStartupTab].functionItem[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                this.element.dependent[this.dependentStartupTab].functionItem[idx].targetMode = null\r\n            } else if (endtargetMLine != undefined && endtargetMLine != this.editFunctionGItem.targetMode.uuid) {\r\n                //기존꺼 삭제해야한다 vuex에서도 삭제하고 mainview에서도 삭제하고 \r\n                this.deleteLine(this.element.uuid+'/fgtarget-'+this.element.dependent[this.dependentStartupTab].functionItem[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                this.newLine(this.element.uuid+'/fgtarget-'+this.element.dependent[this.dependentStartupTab].functionItem[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id, \r\n                                this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id, this.editFunctionGItem.targetMode.uuid, false)\r\n                this.element.dependent[this.dependentStartupTab].functionItem[idx].targetMode = this.editFunctionGItem.targetMode.name\r\n            } else if (endtargetMLine == undefined && this.editFunctionGItem.targetMode != undefined && this.editFunctionGItem.targetMode.uuid != undefined) {\r\n                this.newLine(this.element.uuid+'/fgtarget-'+this.element.dependent[this.dependentStartupTab].functionItem[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id,\r\n                                 this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id, this.editFunctionGItem.targetMode.uuid, false)\r\n                this.element.dependent[this.dependentStartupTab].functionItem[idx].targetMode = this.editFunctionGItem.targetMode.name\r\n            } else if (this.editFunctionGItem.targetMode != undefined && endtargetMLine == this.editFunctionGItem.targetMode.uuid && this.element.dependent[this.dependentStartupTab].functionItem[idx].targetMode != this.editFunctionGItem.targetMode.name) {\r\n                this.element.dependent[this.dependentStartupTab].functionItem[idx].targetMode = this.editFunctionGItem.targetMode.name\r\n            }\r\n\r\n            var endLineContext = null, endLineTarget = null\r\n            if (this.refFunction == this.element.dependent[this.dependentStartupTab].functionItem[idx].id) {\r\n                this.deleteOpenElement()\r\n                if (this.editFunctionGItem.targetMode != null && this.editFunctionGItem.targetMode.uuid != null) {\r\n                    endLineTarget = this.editFunctionGItem.targetMode.uuid\r\n                    this.$store.commit('editModeDeclarationGroup', {compo:\"drag\", uuid: this.editFunctionGItem.targetMode.uuid, top: this.element.top + 200, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.ModeDeclarationGroup_str, uuid: this.editFunctionGItem.targetMode.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id, end:endLineTarget, \r\n                                    iscircle:false, refNum:6, idxID: this.refFunction, tabID: this.dependentStartupTab})\r\n                    this.$nextTick(() => { \r\n                        EventBus.$emit('Element-open', false, this.editFunctionGItem.targetMode.uuid)\r\n                        EventBus.$emit('new-line', this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id, endLineTarget)\r\n                    })\r\n\r\n                }\r\n                if (this.editFunctionGItem.contextMode != null && this.editFunctionGItem.contextMode.uuid != null) {\r\n                    endLineContext = this.editFunctionGItem.contextMode.uuid\r\n                    var top = 200\r\n                    if (endLineTarget != null) {\r\n                        top = 600\r\n                    }\r\n                    this.$store.commit('editMachine', {compo:\"drag\", uuid: this.editFunctionGItem.contextMode.uuid, top: this.element.top + top, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.Machine_str, uuid: this.editFunctionGItem.contextMode.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id, \r\n                                    end:endLineContext, iscircle:false, refNum:6, idxID: this.refFunction, tabID: this.dependentStartupTab})\r\n                    this.$nextTick(() => { \r\n                        EventBus.$emit('Element-open', false, this.editFunctionGItem.contextMode.uuid)\r\n                        EventBus.$emit('new-line', this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id, endLineContext)\r\n                    })\r\n\r\n                }\r\n\r\n                this.$nextTick(() => { \r\n                    if (endLineContext != null && endLineTarget == null) {\r\n                        EventBus.$emit('Element-open', true, endLineContext)\r\n                    } else if (endLineContext == null && endLineTarget != null) {\r\n                        EventBus.$emit('Element-open', true, endLineTarget)\r\n                    } \r\n                })\r\n            }\r\n            \r\n            this.cancelFunctionG()\r\n        },\r\n        cancelFunctionG() {\r\n            this.editFunctionGItem = Object.assign({}, this.defaultItem)\r\n            this.setactiveUUID()\r\n        },\r\n        addFunctionG() {\r\n            this.clickOtherFields()\r\n            let res = true, n = 0\r\n            while (res) {\r\n                n++\r\n                res = this.element.dependent[this.dependentStartupTab].functionItem.some(item => item.id === n)\r\n            }\r\n            this.editFunctionGItem.id = n\r\n            var endLineContext = null, endLineTarget = null\r\n            if( this.editFunctionGItem.targetMode != null) {\r\n                endLineTarget = this.editFunctionGItem.targetMode.uuid\r\n                this.$store.commit('editModeDeclarationGroup', {compo:\"drag\", uuid: this.editFunctionGItem.targetMode.uuid, top: this.element.top + 200, left: this.element.left + this.$setPositionLeft} )\r\n                this.$store.commit('setzIndexVisible', {parent:constant.ModeDeclarationGroup_str, uuid: this.editFunctionGItem.targetMode.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                this.editFunctionGItem.targetMode = this.editFunctionGItem.targetMode.name\r\n                this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id, end:endLineTarget, \r\n                                    iscircle:false, refNum:6, idxID: this.editFunctionGItem.id, tabID: this.dependentStartupTab})\r\n                this.$nextTick(() => { \r\n                    EventBus.$emit('Element-open', false, this.editFunctionGItem.targetMode.uuid)\r\n                    this.newLine(this.element.uuid+'/fgtarget-'+n+'-'+this.element.dependent[this.dependentStartupTab].id, this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id,\r\n                                 endLineTarget, true)\r\n                })\r\n            }\r\n            if( this.editFunctionGItem.contextMode != null) {\r\n                endLineContext = this.editFunctionGItem.contextMode.uuid\r\n                var top = 200\r\n                if (endLineTarget != null) {\r\n                    top = 600\r\n                }\r\n                this.$store.commit('editMachine', {compo:\"drag\", uuid: this.editFunctionGItem.contextMode.uuid, top: this.element.top + top, left: this.element.left + this.$setPositionLeft} )\r\n                this.$store.commit('setzIndexVisible', {parent:constant.Machine_str, uuid: this.editFunctionGItem.contextMode.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                this.editFunctionGItem.contextMode = this.editFunctionGItem.contextMode.name\r\n                this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id, end:endLineContext, \r\n                                    iscircle:false, refNum:6, idxID: this.editFunctionGItem.id, tabID: this.dependentStartupTab})\r\n                this.$nextTick(() => { \r\n                    EventBus.$emit('Element-open', false, this.editFunctionGItem.contextMode.uuid)\r\n                    this.newLine(this.element.uuid+'/fgcontext-'+n+'-'+this.element.dependent[this.dependentStartupTab].id, this.element.uuid+'/fgtable'+this.element.dependent[this.dependentStartupTab].id, \r\n                                endLineContext, true)\r\n                })\r\n            }\r\n\r\n            this.$nextTick(() => { \r\n                if (endLineContext != null && endLineTarget == null) {\r\n                    EventBus.$emit('Element-open', true, endLineContext)\r\n                } else if (endLineContext == null && endLineTarget != null) {\r\n                    EventBus.$emit('Element-open', true, endLineTarget)\r\n                } \r\n            })\r\n            \r\n            const addObj = Object.assign({}, this.editFunctionGItem)\r\n            this.element.dependent[this.dependentStartupTab].functionItem.push(addObj)\r\n            this.refFunction = n\r\n            this.cancelFunctionG()\r\n        },\r\n        setContextModeSelect() {\r\n            if (this.isEditingContextMode == true) { \r\n                if (this.editFunctionGItem.contextMode != null && this.editFunctionGItem.contextMode.uuid != null) {\r\n                    this.$store.commit('setDetailView', {uuid: this.editFunctionGItem.contextMode.uuid, element: constant.Machine_str} )\r\n                    // document.getElementById(this.editFunctionGItem.contextMode.uuid+this.location).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    // EventBus.$emit('active-element', this.editFunctionGItem.contextMode.uuid)\r\n                }\r\n                this.setContextMList()\r\n                this.isEditingContextMode = false\r\n            } else {\r\n                this.isEditingContextMode = true\r\n            }\r\n        },\r\n        setContextMList() {\r\n            this.selContextMode =  this.$store.getters.getMachineFG\r\n            this.setactiveUUID()\r\n        },\r\n        clearContextModeRef() {\r\n            this.isEditingContextMode = true\r\n            this.editFunctionGItem.contextMode = null\r\n        },\r\n        setTargetModeSelect() {\r\n            if (this.isEditingTargetMode == true) { \r\n                if (this.editFunctionGItem.targetMode != null && this.editFunctionGItem.targetMode.uuid != null) {\r\n                    this.$store.commit('setDetailView', {uuid: this.editFunctionGItem.targetMode.uuid, element: constant.ModeDeclarationGroup_str} )\r\n                    // document.getElementById(this.editFunctionGItem.targetMode.uuid+this.location).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    // EventBus.$emit('active-element', this.editFunctionGItem.targetMode.uuid)\r\n                }\r\n                this.setTargetMList()\r\n                this.isEditingTargetMode = false\r\n            } else {\r\n                this.isEditingTargetMode = true\r\n            }\r\n        },\r\n        setTargetMList() {\r\n            this.selTargetMode =  this.$store.getters.getModeDeclaration\r\n            console.log('setTargetMList'+this.selTargetMode.length)\r\n            this.setactiveUUID()\r\n        },\r\n        clearTargetModeRef() {\r\n            this.isEditingTargetMode = true\r\n            this.editFunctionGItem.targetMode = null\r\n        },\r\n\r\n\r\n        clearResourceG(item) {\r\n            item.resourceRef = null\r\n            var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processresorce-'+this.element.dependent[this.dependentStartupTab].id)\r\n            if (endLine != undefined) {\r\n                this.deleteLine(this.element.uuid+'/processresorce-'+this.element.dependent[this.dependentStartupTab].id)\r\n            }\r\n            this.clickOtherFields()\r\n        },\r\n        setResourceGSelect(item) {\r\n            this.clickOtherFields()\r\n            if (item.resourceRef != null) {this.refResource = true}\r\n            if (this.$store.getters.getDeleteOpenElement(this.element.uuid)+1 == this.$store.state.openElement.length) {\r\n                var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processresorce-'+this.element.dependent[this.dependentStartupTab].id)\r\n                if (endLine == undefined) {\r\n                    endLine = this.$store.getters.getMachinePath(item.resourceRef, 1)\r\n                }\r\n                if (endLine != null) {\r\n                    this.$store.commit('editMachine', {compo:\"drag\", uuid: endLine, top: this.element.top + 200, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.Machine_str, uuid: endLine, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => {\r\n                        EventBus.$emit('Element-open', true, endLine)\r\n                        EventBus.$emit('new-line', this.element.uuid+'/processresorce-'+this.element.dependent[this.dependentStartupTab].id, endLine)\r\n                        document.getElementById(endLine+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processresorce-'+this.element.dependent[this.dependentStartupTab].id, \r\n                                        end:endLine, iscircle:false, refNum: 7, idxID: 0, tabID: this.dependentStartupTab})\r\n                    //this.$store.commit('setDetailView', {uuid: endLine, element: constant.Machine_str} )\r\n                    // document.getElementById(endLine+this.location).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    // EventBus.$emit('active-element', endLine)\r\n                }\r\n            }\r\n        },\r\n        setResourceGList() {\r\n            this.selResourceG = this.$store.getters.getResourceGroup\r\n            this.setactiveUUID()\r\n        },\r\n        setResourceG(item, tab) {\r\n            this.clickOtherFields()\r\n            if(tab.resourceRef != item.name) {\r\n                var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processresorce-'+this.element.dependent[this.dependentStartupTab].id)\r\n                if (endLine != undefined && endLine != item.uuid) {\r\n                    //기존꺼 삭제해야한다 vuex에서도 삭제하고 mainview에서도 삭제하고 \r\n                    this.deleteLine(this.element.uuid+'/processresorce-'+this.element.dependent[this.dependentStartupTab].id)\r\n                }\r\n                //새로 추가해준다\r\n                if (endLine != item.uuid) {\r\n                    this.refResource = true\r\n                    this.$store.commit('editMachine', {compo:\"drag\", uuid: item.uuid, top: this.element.top + 200, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.Machine_str, uuid: item.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => {\r\n                        EventBus.$emit('Element-open', true, item.uuid)\r\n                        this.newLine(this.element.uuid+'/processresorce-'+this.element.dependent[this.dependentStartupTab].id, this.element.uuid+'/processresorce'+this.element.dependent[this.dependentStartupTab].id, item.uuid, true)\r\n                        document.getElementById(item.uuid+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processresorce'+this.element.dependent[this.dependentStartupTab].id, \r\n                                        end:item.uuid, iscircle:false, refNum:7, idxID: 0, tabID: this.dependentStartupTab})\r\n                }\r\n                tab.resourceRef = item.name\r\n            } else {\r\n                if (this.$store.getters.getDeleteOpenElement(this.element.uuid)+1 == this.$store.state.openElement.length) {\r\n                    this.refResource = true\r\n                    this.$store.commit('editMachine', {compo:\"drag\", uuid: item.uuid, top: this.element.top + 200, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.Machine_str, uuid: item.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => {\r\n                        EventBus.$emit('Element-open', true, item.uuid)\r\n                        this.newLine(this.element.uuid+'/processresorce-'+this.element.dependent[this.dependentStartupTab].id, this.element.uuid+'/processresorce'+this.element.dependent[this.dependentStartupTab].id, item.uuid, true)\r\n                        document.getElementById(item.uuid+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processresorce'+this.element.dependent[this.dependentStartupTab].id, \r\n                                        end:item.uuid, iscircle:false, refNum:7, idxID: 0, tabID: this.dependentStartupTab})\r\n                }\r\n            }\r\n            this.setactiveUUID()\r\n        },\r\n\r\n        clearStartupC(item) {\r\n            item.startupConfigRef = null\r\n            var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processstartup-'+this.element.dependent[this.dependentStartupTab].id)\r\n            if (endLine != undefined) {\r\n                this.deleteLine(this.element.uuid+'/processstartup-'+this.element.dependent[this.dependentStartupTab].id)\r\n            }\r\n            this.clickOtherFields()\r\n        },\r\n        setStartupCSelect(item) {\r\n            this.clickOtherFields()\r\n            if (item.startupConfigRef != null) {this.refStartupC = true}\r\n            if (this.$store.getters.getDeleteOpenElement(this.element.uuid)+1 == this.$store.state.openElement.length) {\r\n                var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processstartup-'+this.element.dependent[this.dependentStartupTab].id)\r\n                if (endLine == undefined) {\r\n                    endLine = this.$store.getters.getStartupConfigPath(item.startupConfigRef)\r\n                }\r\n                if (endLine != null) {\r\n                    this.$store.commit('editStartupConfig', {compo:\"drag\", uuid: endLine, top: this.element.top + 200, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.StartupConfig_str, uuid: endLine, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => {\r\n                        EventBus.$emit('new-line', this.element.uuid+'/processstartup'+this.element.dependent[this.dependentStartupTab].id, endLine)\r\n                        document.getElementById(endLine+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processstartup-'+this.element.dependent[this.dependentStartupTab].id, end:endLine, \r\n                                        iscircle:false, refNum:8, idxID: 0, tabID: this.dependentStartupTab})\r\n                    //this.$store.commit('setDetailView', {uuid: endLine, element: constant.StartupConfig_str} )\r\n                    // document.getElementById(endLine+this.location).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    // EventBus.$emit('active-element', endLine)\r\n                }\r\n            }\r\n        },\r\n        setStartupCList() {\r\n            this.selStartupC = this.$store.getters.getStartupConfig\r\n            this.setactiveUUID()\r\n        },\r\n        setStartupC(item, tab) {\r\n            this.clickOtherFields()\r\n            if(tab.startupConfigRef != item.name) {\r\n                var endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processstartup-'+this.element.dependent[this.dependentStartupTab].id)\r\n                if (endLine != undefined && endLine != item.uuid) {\r\n                    //기존꺼 삭제해야한다 vuex에서도 삭제하고 mainview에서도 삭제하고 \r\n                    this.deleteLine(this.element.uuid+'/processstartup-'+this.element.dependent[this.dependentStartupTab].id)\r\n                }\r\n                //새로 추가해준다\r\n                if (endLine != item.uuid) {\r\n                    this.refStartupC = true\r\n                    this.$store.commit('editStartupConfig', {compo:\"drag\", uuid: item.uuid, top: this.element.top + 200, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.StartupConfig_str, uuid: item.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => {\r\n                        this.newLine(this.element.uuid+'/processstartup-'+this.element.dependent[this.dependentStartupTab].id, this.element.uuid+'/processstartup'+this.element.dependent[this.dependentStartupTab].id, \r\n                                    item.uuid, true)\r\n                        document.getElementById(item.uuid+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processstartup'+this.element.dependent[this.dependentStartupTab].id, \r\n                                        end:item.uuid, iscircle:false, refNum:8, idxID: 0, tabID: this.dependentStartupTab})\r\n                }\r\n                tab.startupConfigRef = item.name\r\n            } else {\r\n                if (this.$store.getters.getDeleteOpenElement(this.element.uuid)+1 == this.$store.state.openElement.length) {\r\n                    this.refStartupC = true\r\n                    this.$store.commit('editStartupConfig', {compo:\"drag\", uuid: item.uuid, top: this.element.top + 200, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.StartupConfig_str, uuid: item.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$nextTick(() => {\r\n                        this.newLine(this.element.uuid+'/processstartup-'+this.element.dependent[this.dependentStartupTab].id, this.element.uuid+'/processstartup'+this.element.dependent[this.dependentStartupTab].id, \r\n                                  item.uuid, true)\r\n                        document.getElementById(item.uuid+1).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    })\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/processstartup-'+this.element.dependent[this.dependentStartupTab].id, \r\n                                        end:item.uuid, iscircle:false, refNum:8, idxID: 0, tabID: this.dependentStartupTab})\r\n                }\r\n            }\r\n            this.setactiveUUID()\r\n        },\r\n        newStartupC() {\r\n            this.$store.commit('addElementStartupConfig', {\r\n                name: this.$store.getters.getNameStartupConfig, path: '', input: false,\r\n                top: this.element.top + 1145, left: this.element.left + this.$setPositionLeft, zindex: 10, icon:\"mdi-clipboard-outline\", validation: false,\r\n                config: []\r\n            })\r\n            EventBus.$emit('add-element', constant.StartupConfig_str)\r\n            EventBus.$emit('add-element', constant.AdaptiveApplication_str)\r\n            this.$store.commit('editProcess', {compo:\"z\", uuid:this.element.uuid, zindex:2} )\r\n        },\r\n\r\n        isCheckExecutionD() {\r\n            this.clickOtherFields()\r\n            if (this.isdeleteExecutionD == true) {\r\n                this.isdeleteExecutionD = false\r\n                this.selectDelectExecutionDItem = []\r\n            } else {\r\n                this.isdeleteExecutionD = true\r\n            }\r\n        },\r\n        deleteExecutionD() {\r\n            this.clickOtherFields()\r\n            if (this.isdeleteExecutionD == true) {\r\n                this.selectDelectExecutionDItem.forEach(item => {\r\n                    for(let i=0; i<this.element.dependent[this.dependentStartupTab].execution.length; i++){\r\n                        if (item.id == this.element.dependent[this.dependentStartupTab].execution[i].id) {\r\n                            var endLineCon = this.$store.getters.getChangeEndLine(this.element.uuid+'/edcontext-'+item.id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                            if(endLineCon != undefined) {\r\n                                this.deleteLine(this.element.uuid+'/edcontext-'+item.id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                            }\r\n                            var endLinetarg = this.$store.getters.getChangeEndLine(this.element.uuid+'/edtarget-'+item.id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                            if(endLinetarg != undefined) {\r\n                                this.deleteLine(this.element.uuid+'/edtarget-'+item.id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                            }\r\n                        }\r\n                    }\r\n                })\r\n\r\n                this.element.dependent[this.dependentStartupTab].execution = this.element.dependent[this.dependentStartupTab].execution.filter(item => {\r\n                         return this.selectDelectExecutionDItem.indexOf(item) < 0 })\r\n\r\n                this.isdeleteExecutionD = false\r\n                this.selectDelectExecutionDItem = []\r\n            }\r\n        },\r\n        openExecutionD(idx) {\r\n            this.selContextMode = this.$store.getters.getMachineFG\r\n            this.selTargetMode = this.$store.getters.getModeDeclaration\r\n\r\n            if (this.element.dependent[this.dependentStartupTab].execution[idx].contextMode != null ) {\r\n                var endLineC = this.$store.getters.getChangeEndLine(this.element.uuid+'/edcontext-'+this.element.dependent[this.dependentStartupTab].execution[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                if (endLineC == undefined) {\r\n                    endLineC = this.$store.getters.getMachinePath(this.element.dependent[this.dependentStartupTab].execution[idx].contextMode, 2)\r\n                }\r\n                this.editExecutionDItem.contextMode = { name :this.element.dependent[this.dependentStartupTab].execution[idx].contextMode, uuid: endLineC }\r\n            } \r\n\r\n            if (this.element.dependent[this.dependentStartupTab].execution[idx].targetMode != null) {\r\n                var endLineT = this.$store.getters.getChangeEndLine(this.element.uuid+'/edtarget-'+this.element.dependent[this.dependentStartupTab].execution[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                if (endLineT == undefined) {\r\n                    endLineT = this.$store.getters.getModeDeclarationPath(this.element.dependent[this.dependentStartupTab].execution[idx].targetMode, 1)\r\n                }\r\n                this.editExecutionDItem.targetMode = { name :this.element.dependent[this.dependentStartupTab].execution[idx].targetMode, uuid: endLineT }\r\n            } \r\n        },\r\n        editExecutionD(idx) {\r\n            var endcontextMLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/edcontext-'+this.element.dependent[this.dependentStartupTab].execution[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n            if (endcontextMLine != undefined && this.editExecutionDItem.contextMode == null) {\r\n                this.deleteLine(this.element.uuid+'/edcontext-'+this.element.dependent[this.dependentStartupTab].execution[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                this.element.dependent[this.dependentStartupTab].execution[idx].contextMode = null\r\n            } else if (endcontextMLine != undefined && endcontextMLine != this.editExecutionDItem.contextMode.uuid) {\r\n                //기존꺼 삭제해야한다 vuex에서도 삭제하고 mainview에서도 삭제하고 \r\n                this.deleteLine(this.element.uuid+'/edcontext-'+this.element.dependent[this.dependentStartupTab].execution[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                this.newLine(this.element.uuid+'/edcontext-'+this.element.dependent[this.dependentStartupTab].execution[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id, \r\n                                this.element.uuid+'/edtable'+this.element.dependent[this.dependentStartupTab].id, this.editExecutionDItem.contextMode.uuid, false)\r\n                this.element.dependent[this.dependentStartupTab].execution[idx].contextMode = this.editExecutionDItem.contextMode.name\r\n            } else if(endcontextMLine == undefined && this.editExecutionDItem.contextMode != null && this.editExecutionDItem.contextMode.uuid != null) {\r\n                this.newLine(this.element.uuid+'/edcontext-'+this.element.dependent[this.dependentStartupTab].execution[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id,\r\n                                 this.element.uuid+'/edtable'+this.element.dependent[this.dependentStartupTab].id, this.editExecutionDItem.contextMode.uuid, false)\r\n                this.element.dependent[this.dependentStartupTab].execution[idx].contextMode = this.editExecutionDItem.contextMode.name\r\n            } else if (this.editExecutionDItem.contextMode!= null && endcontextMLine == this.editExecutionDItem.contextMode.uuid && this.element.dependent[this.dependentStartupTab].execution[idx].contextMode != this.editExecutionDItem.contextMode.name) {\r\n                this.element.dependent[this.dependentStartupTab].execution[idx].contextMode = this.editExecutionDItem.contextMode.name\r\n            }\r\n\r\n            var endtargetMLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/edtarget-'+this.element.dependent[this.dependentStartupTab].execution[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n            if (endtargetMLine != undefined && this.editExecutionDItem.targetMode == null) {\r\n                this.deleteLine(this.element.uuid+'/edtarget-'+this.element.dependent[this.dependentStartupTab].execution[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                this.element.dependent[this.dependentStartupTab].execution[idx].targetMode = null\r\n            } else if (endtargetMLine != undefined && endtargetMLine != this.editExecutionDItem.targetMode.uuid) {\r\n                //기존꺼 삭제해야한다 vuex에서도 삭제하고 mainview에서도 삭제하고 \r\n                this.deleteLine(this.element.uuid+'/edtarget-'+this.element.dependent[this.dependentStartupTab].execution[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id)\r\n                this.newLine(this.element.uuid+'/edtarget-'+this.element.dependent[this.dependentStartupTab].execution[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id,\r\n                                this.element.uuid+'/edtable'+this.element.dependent[this.dependentStartupTab].id, this.editExecutionDItem.targetMode.uuid, false)\r\n                this.element.dependent[this.dependentStartupTab].execution[idx].targetMode = this.editExecutionDItem.targetMode.name\r\n            } else if (endtargetMLine == undefined && this.editExecutionDItem.targetMode != undefined && this.editExecutionDItem.targetMode.uuid != null) {\r\n                this.newLine(this.element.uuid+'/edtarget-'+this.element.dependent[this.dependentStartupTab].execution[idx].id+'-'+this.element.dependent[this.dependentStartupTab].id,\r\n                                 this.element.uuid+'/edtable'+this.element.dependent[this.dependentStartupTab].id, this.editExecutionDItem.targetMode.uuid, false)\r\n                this.element.dependent[this.dependentStartupTab].execution[idx].targetMode = this.editExecutionDItem.targetMode.name\r\n            } else if (this.editExecutionDItem.targetMode != null && endtargetMLine == this.editExecutionDItem.targetMode.uuid && this.element.dependent[this.dependentStartupTab].execution[idx].targetMode != this.editExecutionDItem.targetMode.name) {\r\n                this.element.dependent[this.dependentStartupTab].execution[idx].targetMode = this.editExecutionDItem.targetMode.name\r\n            }\r\n            \r\n            var endLineContext = null, endLineTarget = null\r\n            if (this.refExecution == this.element.dependent[this.dependentStartupTab].execution[idx].id) {\r\n                this.deleteOpenElement()\r\n                if ( this.editExecutionDItem.targetMode != undefined && this.editExecutionDItem.targetMode.uuid != null) {\r\n                    endLineTarget = this.editExecutionDItem.targetMode.uuid\r\n                    this.$store.commit('editModeDeclarationGroup', {compo:\"drag\", uuid: this.editExecutionDItem.targetMode.uuid, top: this.element.top + 200, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.ModeDeclarationGroup_str, uuid: this.editExecutionDItem.targetMode.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/dtable'+this.element.dependent[this.dependentStartupTab].id, \r\n                                        end:endLineTarget, iscircle:false, refNum:5, idxID: this.refExecution, tabID: this.dependentStartupTab})\r\n                    this.$nextTick(() => {\r\n                        EventBus.$emit('Element-open', false, this.editExecutionDItem.targetMode.uuid)\r\n                        EventBus.$emit('new-line', this.element.uuid+'/edtable'+this.element.dependent[this.dependentStartupTab].id, endLineTarget)\r\n                    })\r\n                }\r\n                if (this.editExecutionDItem.contextMode != null && this.editExecutionDItem.contextMode.uuid != null) {\r\n                    endLineContext = this.editExecutionDItem.contextMode.uuid\r\n                    var top = 200\r\n                    if (endLineTarget != null) {\r\n                        top = 600\r\n                    }\r\n                    this.$store.commit('editMachine', {compo:\"drag\", uuid: this.editExecutionDItem.contextMode.uuid, top: this.element.top + top, left: this.element.left + this.$setPositionLeft} )\r\n                    this.$store.commit('setzIndexVisible', {parent:constant.Machine_str, uuid: this.editExecutionDItem.contextMode.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                    this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/edtable'+this.element.dependent[this.dependentStartupTab].id, \r\n                                        end:endLineContext, iscircle:false, refNum:5, idxID: this.refExecution, tabID: this.dependentStartupTab})\r\n                    this.$nextTick(() => {\r\n                        EventBus.$emit('Element-open', false, this.editExecutionDItem.contextMode.uuid)\r\n                        EventBus.$emit('new-line', this.element.uuid+'/edtable'+this.element.dependent[this.dependentStartupTab].id, endLineContext)\r\n                    })\r\n                }\r\n\r\n                this.$nextTick(() => {\r\n                    if (endLineContext != null && endLineTarget == null) {\r\n                        EventBus.$emit('Element-open', true, endLineContext)\r\n                    } else if (endLineContext == null && endLineTarget != null) {\r\n                        EventBus.$emit('Element-open', true, endLineTarget)\r\n                    } \r\n                })\r\n            }\r\n\r\n            this.cancelExecutionD()\r\n        },\r\n        cancelExecutionD() {\r\n            this.editExecutionDItem = Object.assign({}, this.defaultItem)\r\n            this.setactiveUUID()\r\n        },\r\n        newOpenDependent() {\r\n            this.selContextMode = this.$store.getters.getMachineFG\r\n            this.selTargetMode = this.$store.getters.getModeDeclaration\r\n            this.clickOtherFields()\r\n        },\r\n        addExecutionD() {\r\n            this.clickOtherFields()\r\n            let res = true, n = 0\r\n            while (res) {\r\n                n++\r\n                res = this.element.dependent[this.dependentStartupTab].execution.some(item => item.id === n)\r\n            }\r\n            this.editExecutionDItem.id = n\r\n\r\n            var endLineContext = null, endLineTarget = null \r\n            if( this.editExecutionDItem.targetMode != null) {\r\n                endLineTarget = this.editExecutionDItem.targetMode.uuid\r\n                this.$store.commit('editModeDeclarationGroup', {compo:\"drag\", uuid: this.editExecutionDItem.targetMode.uuid, top: this.element.top + 200, left: this.element.left + this.$setPositionLeft} )\r\n                this.$store.commit('setzIndexVisible', {parent:constant.ModeDeclarationGroup_str, uuid: this.editExecutionDItem.targetMode.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                this.editExecutionDItem.targetMode = this.editExecutionDItem.targetMode.name\r\n                this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/edtable'+this.element.dependent[this.dependentStartupTab].id, end:endLineTarget, \r\n                                    iscircle:false, refNum:5, idxID: this.editExecutionDItem.id, tabID: this.dependentStartupTab})\r\n                this.$nextTick(() => {\r\n                    EventBus.$emit('Element-open', false, endLineTarget)\r\n                    this.newLine(this.element.uuid+'/edtarget-'+n+'-'+this.element.dependent[this.dependentStartupTab].id, this.element.uuid+'/edtable'+this.element.dependent[this.dependentStartupTab].id,\r\n                                 endLineTarget, true)\r\n                })\r\n            }\r\n            if( this.editExecutionDItem.contextMode != null) {\r\n                var top = 200\r\n                if (endLineTarget != null) {\r\n                    top = 600\r\n                }\r\n                endLineContext = this.editExecutionDItem.contextMode.uuid\r\n                this.$store.commit('editMachine', {compo:\"drag\", uuid: this.editExecutionDItem.contextMode.uuid, top: this.element.top + top, left: this.element.left + this.$setPositionLeft} )\r\n                this.$store.commit('setzIndexVisible', {parent:constant.Machine_str, uuid: this.editExecutionDItem.contextMode.uuid, isVisible: true, compo: 'visible', startUUID: this.element.uuid} )\r\n                this.editExecutionDItem.contextMode = this.editExecutionDItem.contextMode.name\r\n                this.$store.commit('setViewLineInfo', {start:this.element.uuid+'/edtable'+this.element.dependent[this.dependentStartupTab].id, end:endLineContext, \r\n                                    iscircle:false, refNum:5, idxID: this.editExecutionDItem.id, tabID: this.dependentStartupTab})\r\n                this.$nextTick(() => {\r\n                    EventBus.$emit('Element-open', false, endLineContext)\r\n                    this.newLine(this.element.uuid+'/edcontext-'+n+'-'+this.element.dependent[this.dependentStartupTab].id, this.element.uuid+'/edtable'+this.element.dependent[this.dependentStartupTab].id,\r\n                                 endLineContext, true)\r\n                })\r\n            }\r\n\r\n            this.$nextTick(() => {\r\n                if (endLineContext != null && endLineTarget == null) {\r\n                    EventBus.$emit('Element-open', true, endLineContext)\r\n                } else if (endLineContext == null && endLineTarget != null) {\r\n                    EventBus.$emit('Element-open', true, endLineTarget)\r\n                } \r\n            })\r\n            const addObj = Object.assign({}, this.editExecutionDItem)\r\n            this.element.dependent[this.dependentStartupTab].execution.push(addObj)\r\n            this.refExecution = n\r\n            this.cancelExecutionD()\r\n        },\r\n        setCMSelect() {\r\n            if (this.isEditingCM == true) { \r\n                if (this.editExecutionDItem.contextMode != null && this.editExecutionDItem.contextMode.uuid != null) {\r\n                    this.$store.commit('setDetailView', {uuid: this.editExecutionDItem.contextMode.uuid, element: constant.Machine_str} )\r\n                    // document.getElementById(this.editExecutionDItem.contextMode.uuid+this.location).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    // EventBus.$emit('active-element', this.editExecutionDItem.contextMode.uuid)\r\n                }\r\n                this.setContextMList()\r\n                this.isEditingCM = false\r\n            } else {\r\n                this.isEditingCM = true\r\n            }\r\n        },\r\n        clearCMRef() {\r\n            this.isEditingCM = true\r\n            this.editExecutionDItem.contextMode = null\r\n        },\r\n        setTMSelect() {\r\n            if (this.isEditingTM == true) { \r\n                if (this.editExecutionDItem.targetMode != null && this.editExecutionDItem.targetMode.uuid != null) {\r\n                    this.$store.commit('setDetailView', {uuid: this.editExecutionDItem.targetMode.uuid, element: constant.ModeDeclarationGroup_str} )\r\n                    // document.getElementById(this.editExecutionDItem.targetMode.uuid+this.location).scrollIntoView({ behavior: 'smooth', block: 'start' })\r\n                    // EventBus.$emit('active-element', this.editExecutionDItem.targetMode.uuid)\r\n                }\r\n                this.setTargetMList()\r\n                this.isEditingTM = false\r\n            } else {\r\n                this.isEditingTM = true\r\n            }\r\n        },\r\n        clearTMRef() {\r\n            this.isEditingTM = true\r\n            this.editExecutionDItem.targetMode = null\r\n        },\r\n\r\n        setactiveUUID() {\r\n            this.$store.commit('setuuid', {uuid: this.element.uuid} )\r\n            this.$store.commit('editProcess', {compo:\"z\", uuid:this.element.uuid, zindex:10} )\r\n        },\r\n        deleteLine(fineLine) {\r\n            var linenum = this.$store.getters.getconnectLineNum(fineLine)\r\n            if (linenum != -1) {\r\n                this.$store.commit('deletConnectionline', {startnum: linenum} )\r\n                this.deleteOpenElement()\r\n            }\r\n        },\r\n        deleteOpenElement() {\r\n            //EventBus.$emit('delete-line', this.$store.getters.getDeleteOpenElement(this.element.uuid))\r\n            this.$store.commit('deleteOpenElemnt', {uuid: this.element.uuid, isDeleteAll: false, startUUID: this.element.uuid} )\r\n        },\r\n        newLine(startLine, drawLine, endLine, isView) {\r\n            this.$store.commit('setConnectionline', {start: startLine, end: endLine} )\r\n            if (isView) {\r\n                EventBus.$emit('new-line', drawLine, endLine)\r\n            }\r\n        },\r\n\r\n        viewARXML() {\r\n            this.editARXML.name = this.element.name\r\n            this.editARXML.logLevel = this.element.logLevel\r\n            this.editARXML.logPath = this.element.logPath\r\n            this.editARXML.logProDesc = this.element.logProDesc\r\n            this.editARXML.logProID = this.element.logProID\r\n            this.editARXML.restart = this.element.restart\r\n            this.editARXML.preMapping = this.element.preMapping\r\n            this.editARXML.prodesign = this.element.prodesign\r\n            this.editARXML.determin = this.element.determin\r\n            this.editARXML.execut = this.element.execut\r\n            this.editARXML.machinname = this.element.machinname\r\n            this.editARXML.machinetype = this.element.machinetype\r\n            this.editARXML.logMode = JSON.parse(JSON.stringify(this.element.logMode))\r\n            this.editARXML.dependent = JSON.parse(JSON.stringify(this.element.dependent))\r\n            this.dialogText= true\r\n        },\r\n        saveARXML() {\r\n            if (this.element.name != this.editARXML.name) {\r\n                this.$store.commit('editProcess', {compo:\"Name\", uuid:this.element.uuid, name:this.editARXML.name} )\r\n                this.$store.commit('changePathElement', {uuid:this.element.uuid, path: this.element.path, name: this.editARXML.name} )\r\n                if (this.editARXML.name != '') {\r\n                    this.$store.commit('isintoErrorList', {uuid:this.element.uuid, name:this.editARXML.name, path:this.element.path})\r\n                }\r\n            }\r\n            this.element.name = this.editARXML.name\r\n            this.element.logPath = this.editARXML.logPath\r\n            this.element.logProDesc = this.editARXML.logProDesc\r\n            this.element.logProID = this.editARXML.logProID\r\n            this.element.restart = this.editARXML.restart\r\n            this.element.preMapping = this.editARXML.preMapping\r\n            this.element.machinname = this.editARXML.machinname\r\n\r\n            this.editARXML.logLevel = this.editARXML.logLevel.toUpperCase()\r\n            if(this.editARXML.logLevel == 'FATAL' || this.editARXML.logLevel == 'ERROR' || this.editARXML.logLevel == 'WARN' \r\n               || this.editARXML.logLevel == 'INFO' || this.editARXML.logLevel == 'DEBUG' || this.editARXML.logLevel == 'VERBOSE') {\r\n                this.element.logLevel = this.editARXML.logLevel\r\n            }\r\n\r\n            var endLine = null, changEndLine = null\r\n\r\n            if (this.editARXML.prodesign != this.element.prodesign) {\r\n                endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processprodesign')\r\n                if (endLine != undefined) {\r\n                    this.deleteLine(this.element.uuid+'/processprodesign')\r\n                }\r\n                changEndLine = this.$store.getters.getProcessDesignPath(this.editARXML.prodesign)\r\n                if (changEndLine != null) {\r\n                    this.newLine(this.element.uuid+'/processprodesign', this.element.uuid+'/processprodesign', changEndLine, false)\r\n                }\r\n            }\r\n            this.element.prodesign = this.editARXML.prodesign\r\n\r\n            if (this.editARXML.determin != this.element.determin) {\r\n                endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processdetermin')\r\n                if (endLine != undefined) {\r\n                    this.deleteLine(this.element.uuid+'/processdetermin')\r\n                }\r\n                changEndLine = this.$store.getters.getDeterministicClientPath(this.editARXML.determin)\r\n                if (changEndLine != null) {\r\n                    this.newLine(this.element.uuid+'/processdetermin', this.element.uuid+'/processdetermin', changEndLine, false)\r\n                }\r\n            }\r\n            this.element.determin = this.editARXML.determin\r\n\r\n            if (this.editARXML.execut != this.element.execut) {\r\n                endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processexecut')\r\n                if (endLine != undefined) {\r\n                    this.deleteLine(this.element.uuid+'/processexecut')\r\n                }\r\n                changEndLine = this.$store.getters.getExecutablePath(this.editARXML.execut)\r\n                if (changEndLine != null) {\r\n                    this.newLine(this.element.uuid+'/processexecut', this.element.uuid+'/processexecut', changEndLine, false)\r\n                }\r\n            }\r\n            this.element.execut = this.editARXML.execut\r\n\r\n            if (this.editARXML.machinetype != this.element.machinetype) {\r\n                endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processmodedeclar')\r\n                if (endLine != undefined) {\r\n                    this.deleteLine(this.element.uuid+'/processmodedeclar')\r\n                }\r\n                changEndLine = this.$store.getters.getModeDeclarationPath(this.editARXML.machinetype, 0)\r\n                if (changEndLine != null) {\r\n                    this.newLine(this.element.uuid+'/processmodedeclar', this.element.uuid+'/processmodedeclar', changEndLine, false)\r\n                }\r\n            }\r\n            this.element.machinetype = this.editARXML.machinetype\r\n\r\n            if (this.editARXML.dependent.length > 0) {\r\n                this.editARXML.dependent.forEach(item => {\r\n                    item.execution.forEach(data => {\r\n                        var isHaveTableC = false, isHaveTableT = false\r\n                        this.element.dependent.forEach(dep => {\r\n                            dep.execution.forEach(exe => {\r\n                                if (exe.id == data.id) {\r\n                                    if (exe.contextMode == data.contextMode) {\r\n                                        isHaveTableC = true\r\n                                    }\r\n                                    if (exe.targetMode == data.targetMode) {\r\n                                        isHaveTableT = true\r\n                                    }\r\n                                }\r\n                            })\r\n                        })\r\n                        if (!isHaveTableC) {\r\n                            endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/edcontext-'+data.id+'-'+item.id)\r\n                            if (endLine != undefined) {\r\n                                this.deleteLine(this.element.uuid+'/edcontext-'+data.id+'-'+item.id)\r\n                            }\r\n                            changEndLine = this.$store.getters.getMachinePath(data.contextMode, 2)\r\n                            if (changEndLine != null) {\r\n                                this.newLine(this.element.uuid+'/edcontext-'+data.id+'-'+item.id, this.element.uuid+'/processStarupC', changEndLine, false)\r\n                            }\r\n                        }\r\n                        if (!isHaveTableT) {\r\n                            endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/edtarget-'+data.id+'-'+item.id)\r\n                            if (endLine != undefined) {\r\n                                this.deleteLine(this.element.uuid+'/edtarget-'+data.id+'-'+item.id)\r\n                            }\r\n                            changEndLine = this.$store.getters.getModeDeclarationPath(data.targetMode, 1)\r\n                            if (changEndLine != null) {\r\n                                this.newLine(this.element.uuid+'/edtarget-'+data.id+'-'+item.id, this.element.uuid+'/processStarupC', changEndLine, false)\r\n                            }\r\n                        }\r\n                    })\r\n                    item.functionItem.forEach(data => {\r\n                        var isHaveTableC = false, isHaveTableT = false\r\n                        this.element.dependent.forEach(dep => {\r\n                            dep.functionItem.forEach(fun => {\r\n                                if (fun.id == data.id ) {\r\n                                    if (fun.contextMode == data.contextMode) {\r\n                                        isHaveTableC = true\r\n                                    }\r\n                                    if (fun.targetMode == data.targetMode) {\r\n                                        isHaveTableT = true\r\n                                    }\r\n                                }\r\n                            })\r\n                        })\r\n                        if (!isHaveTableC) {\r\n                            endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgcontext-'+data.id+'-'+item.id)\r\n                            if (endLine != undefined) {\r\n                                this.deleteLine(this.element.uuid+'/fgcontext-'+data.id+'-'+item.id)\r\n                            }\r\n                            changEndLine = this.$store.getters.getMachinePath(data.contextMode, 2)\r\n                            if (changEndLine != null) {\r\n                                this.newLine(this.element.uuid+'/fgcontext-'+data.id+'-'+item.id, this.element.uuid+'/processStarupC', changEndLine, false)\r\n                            }\r\n                        }\r\n                        if (!isHaveTableT) {\r\n                            endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgtarget-'+data.id+'-'+item.id)\r\n                            if (endLine != undefined) {\r\n                                this.deleteLine(this.element.uuid+'/fgtarget-'+data.id+'-'+item.id)\r\n                            }\r\n                            changEndLine = this.$store.getters.getModeDeclarationPath(data.targetMode, 1)\r\n                            if (changEndLine != null) {\r\n                                this.newLine(this.element.uuid+'/fgtarget-'+data.id+'-'+item.id, this.element.uuid+'/processStarupC', changEndLine, false)\r\n                            }\r\n                        }\r\n                    })\r\n                    var isHaveTableR = false, isHaveTableS = false\r\n                    this.element.dependent.forEach(ele => {\r\n                        if (ele.id == item.id) {\r\n                            if (ele.resourceRef == item.resourceRef) {\r\n                                isHaveTableR = true\r\n                            }\r\n                            if (ele.startupConfigRef == item.startupConfigRef) {\r\n                                isHaveTableS = true\r\n                            }\r\n                        }\r\n                    })\r\n                    if (!isHaveTableR) {\r\n                        endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processresorce-'+item.id)\r\n                        if (endLine != undefined) {\r\n                            this.deleteLine(this.element.uuid+'/processresorce-'+item.id)\r\n                        }\r\n                        changEndLine = this.$store.getters.getMachinePath(item.resourceRef, 1)\r\n                        if (changEndLine != null) {\r\n                            this.newLine(this.element.uuid+'/processresorce-'+item.id, this.element.uuid+'/processStarupC', changEndLine, false)\r\n                        }\r\n                    }\r\n                    if (!isHaveTableS) {\r\n                        endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processstartup-'+item.id)\r\n                        if (endLine != undefined) {\r\n                            this.deleteLine(this.element.uuid+'/processstartup-'+item.id)\r\n                        }\r\n                        changEndLine = this.$store.getters.getStartupConfigPath(item.startupConfigRef)\r\n                        if (changEndLine != null) {\r\n                            this.newLine(this.element.uuid+'/processstartup-'+item.id, this.element.uuid+'/processStarupC', changEndLine, false)\r\n                        }\r\n                    }\r\n                })\r\n                this.element.dependent.forEach(item => {\r\n                    var isHaveTable = false\r\n                    item.execution.forEach(data => {\r\n                        isHaveTable = false\r\n                        this.editARXML.dependent.forEach(edit => {\r\n                            edit.execution.forEach(editA => {\r\n                                if (editA.id == data.id) {\r\n                                    isHaveTable = true\r\n                                }\r\n                            })\r\n                        })\r\n                        if (!isHaveTable) {\r\n                            if (data.contextMode != null) {\r\n                                endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/edcontext-'+data.id+'-'+item.id)\r\n                                if (endLine != undefined) {\r\n                                    this.deleteLine(this.element.uuid+'/edcontext-'+data.id+'-'+item.id)\r\n                                }\r\n                            }\r\n                            if (data.targetMode != null) {\r\n                                endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/edtarget-'+data.id+'-'+item.id)\r\n                                if (endLine != undefined) {\r\n                                    this.deleteLine(this.element.uuid+'/edtarget-'+data.id+'-'+item.id)\r\n                                }\r\n                            }\r\n                        }\r\n                    })\r\n                    item.functionItem.forEach(data => {\r\n                        isHaveTable = false\r\n                        this.editARXML.dependent.forEach(edit => {\r\n                            edit.functionItem.forEach(editE => {\r\n                                if (editE.id == data.id) {\r\n                                    isHaveTable = true\r\n                                }\r\n                            })\r\n                        })\r\n                        if (!isHaveTable) {\r\n                            if (data.contextMode != null) {\r\n                                endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgcontext-'+data.id+'-'+item.id)\r\n                                if (endLine != undefined) {\r\n                                    this.deleteLine(this.element.uuid+'/fgcontext-'+data.id+'-'+item.id)\r\n                                }\r\n                            }\r\n                            if (data.targetMode != null) {\r\n                                endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgtarget-'+data.id+'-'+item.id)\r\n                                if (endLine != undefined) {\r\n                                    this.deleteLine(this.element.uuid+'/fgtarget-'+data.id+'-'+item.id)\r\n                                }\r\n                            }\r\n                        }\r\n                    })\r\n                    isHaveTable = false\r\n                    this.editARXML.dependent.forEach(edit => {\r\n                        if (edit.id == item.id) {\r\n                            isHaveTable = true\r\n                        }\r\n                    })\r\n                    if (!isHaveTable) {\r\n                        if (item.resourceRef != null) {\r\n                            endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processresorce-'+item.id)\r\n                            if (endLine != undefined) {\r\n                                this.deleteLine(this.element.uuid+'/processresorce-'+item.id)\r\n                            }\r\n                        }\r\n                        if (item.startupConfigRef != null) {\r\n                            endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processstartup-'+item.id)\r\n                            if (endLine != undefined) {\r\n                                this.deleteLine(this.element.uuid+'/processstartup-'+item.id)\r\n                            }\r\n                        }\r\n                    }\r\n                })\r\n            } else {\r\n                if (this.element.dependent.length > 0) {\r\n                    this.element.dependent.forEach(item => {\r\n                        item.execution.forEach(data => {\r\n                            if (data.contextMode != null) {\r\n                                endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/edcontext-'+data.id+'-'+item.id)\r\n                                if (endLine != undefined) {\r\n                                    this.deleteLine(this.element.uuid+'/edcontext-'+data.id+'-'+item.id)\r\n                                }\r\n                            }\r\n                            if (data.targetMode != null) {\r\n                                endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/edtarget-'+data.id+'-'+item.id)\r\n                                if (endLine != undefined) {\r\n                                    this.deleteLine(this.element.uuid+'/edtarget-'+data.id+'-'+item.id)\r\n                                }\r\n                            }\r\n                        })\r\n                        item.functionItem.forEach(data => {\r\n                            if (data.contextMode != null) {\r\n                                endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgcontext-'+data.id+'-'+item.id)\r\n                                if (endLine != undefined) {\r\n                                    this.deleteLine(this.element.uuid+'/fgcontext-'+data.id+'-'+item.id)\r\n                                }\r\n                            }\r\n                            if (data.targetMode != null) {\r\n                                endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/fgtarget-'+data.id+'-'+item.id)\r\n                                if (endLine != undefined) {\r\n                                    this.deleteLine(this.element.uuid+'/fgtarget-'+data.id+'-'+item.id)\r\n                                }\r\n                            }\r\n                        })\r\n                        if (item.resourceRef != null) {\r\n                            endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processresorce-'+item.id)\r\n                            if (endLine != undefined) {\r\n                                this.deleteLine(this.element.uuid+'/processresorce-'+item.id)\r\n                            }\r\n                        }\r\n                        if (item.startupConfigRef != null) {\r\n                            endLine = this.$store.getters.getChangeEndLine(this.element.uuid+'/processstartup-'+item.id)\r\n                            if (endLine != undefined) {\r\n                                this.deleteLine(this.element.uuid+'/processstartup-'+item.id)\r\n                            }\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n            this.element.dependent = JSON.parse(JSON.stringify(this.editARXML.dependent))\r\n\r\n            for(let i=0; i<this.editARXML.logMode.length; i++) {\r\n                if (!(this.editARXML.logMode[i] == 'CONSOLE' || this.editARXML.logMode[i] == 'FILE' ||\r\n                    this.editARXML.logMode[i] == 'NETWORK')) {\r\n                        this.editARXML.logMode.splice(i ,1)\r\n                }\r\n            }\r\n            this.element.logMode = JSON.parse(JSON.stringify(this.editARXML.logMode))\r\n            this.cancelARXML()\r\n        },\r\n        cancelARXML() {\r\n            this.editARXML = {name:'', logLevel: null, logPath: '', logProDesc: '', logProID: '', restart: '', preMapping: null, logMode: [],\r\n                    prodesign: null, determin: null, execut: null, machinname: '', machinetype: null, dependent: []}\r\n            this.editTextDependent = {execution: [], functionItem: [], resourceRef: null, startupConfigRef: null, id: ''}\r\n            this.editTextExecution = {contextMode: null, targetMode: null, id: ''}\r\n            this.editTextFunction = {contextMode: null, targetMode: null, id: ''}\r\n            this.dialogText = false\r\n        },\r\n        newTextDependent() {\r\n            this.editTextDependent = {execution: [], functionItem: [], resourceRef: null, startupConfigRef: null, id: ''}\r\n            let res = true, n = 0\r\n            while (res) {\r\n                 n++;\r\n                res = this.editARXML.dependent.some(item => item.id === n)\r\n            }\r\n            this.editTextDependent.id = n\r\n\r\n            const addObj = Object.assign({}, this.editTextDependent)\r\n            this.editARXML.dependent.push(addObj);\r\n        },\r\n        deletTextDependent(idx) {\r\n            this.editARXML.dependent.splice(idx,1)\r\n        },\r\n        newTextExecution(idxD) {\r\n            this.editTextExecution = {contextMode: null, targetMode: null, id: ''}\r\n            let res = true, n = 0\r\n            while (res) {\r\n                n++\r\n                res = this.editARXML.dependent[idxD].execution.some(item => item.id === n)\r\n            }\r\n            this.editTextExecution.id = n\r\n\r\n            const addObj = Object.assign({}, this.editTextExecution)\r\n            this.editARXML.dependent[idxD].execution.push(addObj);\r\n        },\r\n        deletTextExecution(idx, idxD) {\r\n            this.editARXML.dependent[idxD].execution.splice(idx,1)\r\n        },\r\n        newTextFunction(idxD) {\r\n            this.editTextFunction = {contextMode: null, targetMode: null, id: ''}\r\n            let res = true, n = 0\r\n            while (res) {\r\n                n++;\r\n                res = this.editARXML.dependent[idxD].functionItem.some(item => item.id === n)\r\n            }\r\n            this.editTextFunction.id = n\r\n\r\n            const addObj = Object.assign({}, this.editTextFunction)\r\n            this.editARXML.dependent[idxD].functionItem.push(addObj);\r\n        },\r\n        deletTextFunction(idx, idxD) {\r\n            this.editARXML.dependent[idxD].functionItem.splice(idx,1)\r\n        },\r\n        newTextLogMode() {\r\n            if (this.editARXML.logMode.length < 3) {\r\n                this.editARXML.logMode.push('')\r\n            }\r\n        },\r\n        deletTextLogMode(idx) {\r\n            this.editARXML.logMode.splice(idx,1)\r\n        }\r\n\r\n    },\r\n}\r\n</script>\r\n"]}]}